<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÌïôÏà†ÎåÄÌöå Ïä§ÏºÄÏ§ÑÎü¨</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <!-- SheetJS for Excel parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <script>
        // Firebase ÏÑ§Ï†ï
        const firebaseConfig = {
            apiKey: "AIzaSyBzV50mjOaEnUS86sS8zOhBH0i9OePnDhM",
            authDomain: "conference-scheduler-a5656.firebaseapp.com",
            databaseURL: "https://conference-scheduler-a5656-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "conference-scheduler-a5656",
            storageBucket: "conference-scheduler-a5656.firebasestorage.app",
            messagingSenderId: "592497469624",
            appId: "1:592497469624:web:66012149580a0e144eec4d"
        };
        
        // Firebase Ï¥àÍ∏∞Ìôî
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();
    </script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&family=Playfair+Display:wght@700;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #2E1A47;
            --primary-light: #4A2E6C;
            --accent: #FF6B9D;
            --accent-light: #FFB3D1;
            --bg: #F8F7FC;
            --white: #FFFFFF;
            --text: #1A1A1A;
            --text-light: #666666;
            --border: #E0DDE8;
            --shadow: rgba(46, 26, 71, 0.1);
        }
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #F8F7FC 0%, #EDE9F5 100%);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: var(--white);
            padding: 0.75rem 1.5rem;
            box-shadow: 0 4px 20px var(--shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-weight: 900;
            letter-spacing: -0.5px;
        }
        
        .header-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            align-items: center;
        }
        
        /* Î°úÍ∑∏Ïù∏ ÏÉÅÌÉú ÌëúÏãú */
        .auth-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.4rem 0.8rem;
            background: rgba(255,255,255,0.15);
            border-radius: 20px;
            font-size: 0.8rem;
        }
        
        .auth-status .user-photo {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: 2px solid var(--accent);
        }
        
        .auth-status .user-name {
            max-width: 120px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .login-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .login-btn:hover {
            background: #ff5088;
        }
        
        .logout-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 0.3rem 0.6rem;
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.75rem;
        }
        
        .logout-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        /* ÎèôÍ∏∞Ìôî ÏÉÅÌÉú ÌëúÏãú */
        .sync-status {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.3rem 0.7rem;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .sync-status.synced {
            background: rgba(46, 204, 113, 0.2);
            color: #27ae60;
        }
        
        .sync-status.syncing {
            background: rgba(241, 196, 15, 0.2);
            color: #f39c12;
        }
        
        .sync-status.offline {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
        }
        
        .sync-status .sync-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: currentColor;
        }
        
        .sync-status.syncing .sync-dot {
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        /* Ïò®ÎùºÏù∏ ÏÇ¨Ïö©Ïûê ÌëúÏãú */
        .online-users {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            padding: 0.3rem 0.7rem;
            background: rgba(255,255,255,0.15);
            border-radius: 15px;
            font-size: 0.75rem;
        }
        
        .online-users .user-avatars {
            display: flex;
        }
        
        .online-users .user-avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: 2px solid var(--primary);
            margin-left: -8px;
        }
        
        .online-users .user-avatar:first-child {
            margin-left: 0;
        }
        
        /* Î°úÍ∑∏Ïù∏ ÌïÑÏöî Ïò§Î≤ÑÎ†àÏù¥ */
        .login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(46, 26, 71, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            color: white;
        }
        
        .login-overlay.hidden {
            display: none;
        }
        
        .login-box {
            background: white;
            padding: 3rem;
            border-radius: 20px;
            text-align: center;
            max-width: 400px;
        }
        
        .login-box h2 {
            color: var(--primary);
            margin-bottom: 1rem;
        }
        
        .login-box p {
            color: var(--text-light);
            margin-bottom: 2rem;
        }
        
        .google-login-btn {
            background: white;
            border: 2px solid #4285f4;
            color: #4285f4;
            padding: 0.8rem 2rem;
            border-radius: 30px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin: 0 auto;
            transition: all 0.2s;
        }
        
        .google-login-btn:hover {
            background: #4285f4;
            color: white;
        }
        
        .google-login-btn img {
            width: 24px;
            height: 24px;
        }
        
        /* ÏÇ¨Ïö©Ïûê Í¥ÄÎ¶¨ Î≤ÑÌäº Î∞∞ÏßÄ */
        .user-mgmt-btn {
            position: relative;
        }
        
        .pending-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #e74c3c;
            color: white;
            font-size: 0.65rem;
            min-width: 18px;
            height: 18px;
            border-radius: 9px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            animation: pulse 2s infinite;
        }
        
        /* ÏÇ¨Ïö©Ïûê Í¥ÄÎ¶¨ Î™®Îã¨ */
        .user-section {
            margin-bottom: 1.5rem;
        }
        
        .user-section-title {
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.75rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--border);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .user-section-title .count {
            background: var(--primary-light);
            color: white;
            font-size: 0.7rem;
            padding: 0.15rem 0.5rem;
            border-radius: 10px;
        }
        
        .user-list {
            max-height: 250px;
            overflow-y: auto;
        }
        
        .user-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            background: var(--bg);
            border-radius: 10px;
            margin-bottom: 0.5rem;
            transition: all 0.2s;
        }
        
        .user-item:hover {
            background: #e8e5f0;
        }
        
        .user-item.pending {
            border-left: 4px solid #f39c12;
        }
        
        .user-item.admin {
            border-left: 4px solid #f39c12;
        }
        
        .user-item.editor {
            border-left: 4px solid #27ae60;
        }
        
        .user-item-photo {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }
        
        .user-item-info {
            flex: 1;
            min-width: 0;
        }
        
        .user-item-name {
            font-weight: 600;
            font-size: 0.9rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .user-item-email {
            font-size: 0.75rem;
            color: var(--text-light);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .user-item-date {
            font-size: 0.7rem;
            color: #999;
        }
        
        .user-item-role {
            font-size: 0.7rem;
            font-weight: 600;
            padding: 0.15rem 0.4rem;
            border-radius: 4px;
        }
        
        .user-item-role.admin {
            background: #fef3cd;
            color: #856404;
        }
        
        .user-item-role.editor {
            background: #d4edda;
            color: #155724;
        }
        
        .user-item-actions {
            display: flex;
            gap: 0.4rem;
            align-items: center;
        }
        
        .approve-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 0.4rem 0.7rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .approve-btn:hover {
            background: #219a52;
        }
        
        .reject-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 0.4rem 0.7rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .reject-btn:hover {
            background: #c0392b;
        }
        
        .remove-btn {
            background: transparent;
            border: 1px solid #e74c3c;
            color: #e74c3c;
            padding: 0.3rem 0.5rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.75rem;
        }
        
        .remove-btn:hover {
            background: #e74c3c;
            color: white;
        }
        
        .role-select {
            padding: 0.3rem 0.5rem;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 0.75rem;
            background: white;
            cursor: pointer;
        }
        
        /* Î∞±ÏóÖ ÏïÑÏù¥ÌÖú */
        .backup-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            background: var(--bg);
            border-radius: 8px;
            margin-bottom: 0.5rem;
        }
        
        .backup-item:hover {
            background: #e8e5f0;
        }
        
        .backup-info {
            flex: 1;
        }
        
        .backup-id {
            font-weight: 600;
            font-size: 0.85rem;
        }
        
        .backup-meta {
            font-size: 0.7rem;
            color: var(--text-light);
            margin-top: 0.2rem;
        }
        
        .backup-actions {
            display: flex;
            gap: 0.3rem;
        }
        
        .container {
            display: flex;
            gap: 1.5rem;
            padding: 1rem 1.5rem;
            max-width: 1800px;
            margin: 0 auto;
        }
        
        .sidebar {
            width: 380px;
            flex-shrink: 0;
        }
        
        .card {
            background: var(--white);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 12px var(--shadow);
            border: 1px solid var(--border);
        }
        
        .card-title {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            user-select: none;
        }
        
        .card-title .toggle-icon {
            margin-left: auto;
            transition: transform 0.3s;
            font-size: 1rem;
        }
        
        .card.collapsed .card-title .toggle-icon {
            transform: rotate(-90deg);
        }
        
        .card-content {
            transition: all 0.3s ease;
            overflow: hidden;
        }
        
        .card.collapsed .card-content {
            max-height: 0;
            opacity: 0;
            margin: 0;
            padding: 0;
        }
        
        .lecture-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.4rem;
        }
        
        .form-group label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-light);
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 0.75rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 0.95rem;
            font-family: 'Noto Sans KR', sans-serif;
            transition: all 0.2s;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(255, 107, 157, 0.1);
        }
        
        .form-row {
            display: flex;
            gap: 0.75rem;
        }
        
        .form-row .form-group {
            flex: 1;
            min-width: 0;
        }
        
        .form-row .form-group input,
        .form-row .form-group select {
            width: 100%;
            box-sizing: border-box;
        }
        
        .btn {
            padding: 0.875rem 1.5rem;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Noto Sans KR', sans-serif;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--accent) 0%, #FF8CB4 100%);
            color: var(--white);
            box-shadow: 0 4px 12px rgba(255, 107, 157, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 157, 0.4);
        }
        
        .btn-secondary {
            background: var(--white);
            color: var(--primary);
            border: 2px solid var(--primary);
        }
        
        .btn-secondary:hover {
            background: var(--primary);
            color: var(--white);
        }

        .btn-small {
            padding: 0.35rem 0.6rem;
            font-size: 0.75rem;
        }
        
        /* ÎÇ†Ïßú ÏÑ†ÌÉù Î≤ÑÌäº */
        .date-selector-btns {
            display: flex;
            gap: 0.5rem;
            margin-left: 1rem;
        }
        
        .date-btn {
            padding: 0.5rem 1rem;
            border: 2px solid var(--primary);
            background: var(--white);
            color: var(--primary);
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .date-btn:hover {
            background: var(--primary-light);
            color: var(--white);
        }
        
        .date-btn.active {
            background: var(--primary);
            color: var(--white);
            box-shadow: 0 2px 8px rgba(46, 26, 71, 0.3);
        }
        
        .category-filters {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        
        .category-filters-wrapper {
            transition: all 0.3s ease;
            overflow: hidden;
        }
        
        .category-filters-wrapper.collapsed {
            max-height: 0;
            margin-bottom: 0;
        }
        
        .category-filters-wrapper.collapsed .category-filters {
            margin-bottom: 0;
        }
        
        /* Í∞ïÏùò Í≤ÄÏÉâÏ∞Ω */
        .lecture-search-box {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
            position: relative;
        }
        
        .lecture-search-box input {
            flex: 1;
            padding: 0.5rem 2rem 0.5rem 0.75rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 0.85rem;
            transition: border-color 0.2s;
        }
        
        .lecture-search-box input:focus {
            outline: none;
            border-color: var(--accent);
        }
        
        .lecture-search-box input::placeholder {
            color: #aaa;
        }
        
        .search-clear-btn {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #999;
            cursor: pointer;
            font-size: 1rem;
            padding: 0.25rem;
            line-height: 1;
        }
        
        .search-clear-btn:hover {
            color: var(--accent);
        }
        
        .category-filter-btn {
            padding: 0.25rem 0.5rem;
            border: 2px solid;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            background: var(--white);
            position: relative;
        }
        
        .category-filter-btn.active {
            color: var(--white) !important;
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        
        /* Ïπ¥ÌÖåÍ≥†Î¶¨ Í∞úÏàò Î∞∞ÏßÄ */
        .category-count {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 16px;
            height: 16px;
            padding: 0 4px;
            margin-left: 4px;
            background: var(--primary);
            color: white !important;
            font-size: 0.6rem;
            font-weight: 700;
            border-radius: 8px;
            vertical-align: middle;
        }
        
        .category-filter-btn.active .category-count {
            background: rgba(255,255,255,0.3);
        }
        
        .lecture-list {
            max-height: calc(100vh - 400px);
            min-height: 200px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .card.collapsed + .card .lecture-list {
            max-height: calc(100vh - 180px);
        }
        
        .lecture-item {
            background: linear-gradient(135deg, #FFFFFF 0%, #F8F7FC 100%);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
            cursor: grab;
            transition: all 0.2s;
            position: relative;
        }
        
        .lecture-item.scheduled {
            background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);
            border-color: #4CAF50;
        }
        
        .lecture-item:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transform: translateY(-2px);
        }
        
        .lecture-item.dragging {
            opacity: 0.5;
            cursor: grabbing;
        }
        
        .lecture-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--primary);
            font-size: 0.95rem;
        }
        
        .lecture-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            font-size: 0.8rem;
        }
        
        .tag {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .tag-speaker {
            background: #E3F2FD;
            color: #1565C0;
        }
        
        .schedule-grid {
            flex: 1;
            background: var(--white);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 2px 12px var(--shadow);
            border: 1px solid var(--border);
            overflow-x: auto;
        }
        
        .grid-header {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            align-items: center;
        }
        
        .grid-header h2 {
            font-family: 'Playfair Display', serif;
            color: var(--primary);
            font-size: 1.75rem;
        }
        
        .date-selector {
            margin-left: auto;
            padding: 0.5rem 1rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-family: 'Noto Sans KR', sans-serif;
        }
        
        /* ÏãúÍ∞ÑÌëú Ïª®ÌÖåÏù¥ÎÑà - Í∞ÄÎ°ú/ÏÑ∏Î°ú Ïä§ÌÅ¨Î°§ */
        .schedule-table-wrapper {
            overflow: auto;
            max-height: calc(100vh - 160px);
            border: 2px solid var(--border);
            border-radius: 12px;
            position: relative;
        }
        
        .schedule-table {
            border-collapse: separate;
            border-spacing: 1px;
            background: var(--border);
            min-width: max-content;
        }
        
        /* Ìó§Îçî Ìñâ Í≥†Ï†ï */
        .schedule-table thead {
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .schedule-table thead th {
            background: var(--primary);
            color: var(--white);
            padding: 0.5rem 0.25rem;
            font-weight: 700;
            text-align: center;
            font-size: 0.8rem;
            min-width: 130px;
            position: sticky;
            top: 0;
        }
        
        /* ÏãúÍ∞Ñ Ìó§Îçî (Ï¢åÏÉÅÎã® ÏΩîÎÑà) - Í∞ÄÏû• ÎÜíÏùÄ z-index */
        .schedule-table thead th:first-child {
            position: sticky;
            left: 0;
            z-index: 200;
            min-width: 55px;
        }
        
        /* ÏãúÍ∞ÑÏó¥ Í≥†Ï†ï */
        .schedule-table tbody td:first-child {
            position: sticky;
            left: 0;
            z-index: 50;
            background: var(--bg);
            min-width: 55px;
            font-size: 0.75rem;
            font-weight: 600;
            text-align: right;
            padding: 0.25rem 0.3rem;
            color: var(--text-light);
        }
        
        /* 30Î∂Ñ Îã®ÏúÑ ÏãúÍ∞Ñ Í∞ïÏ°∞ */
        .schedule-table tbody td:first-child.hour-mark {
            color: var(--primary);
            font-weight: 700;
            border-top: 2px solid var(--primary);
        }
        
        /* 15Î∂Ñ Îã®ÏúÑ */
        .schedule-table tbody td:first-child.quarter-mark {
            border-top: 1px solid #e0e0e0;
        }
        
        /* 5Î∂Ñ Îã®ÏúÑ - ÏãúÍ∞Ñ Ïà®ÍπÄ */
        .schedule-table tbody td:first-child.five-min .time-label {
            visibility: hidden;
        }
        
        /* ÏùºÎ∞ò ÏÖÄ */
        .schedule-table tbody td {
            background: var(--white);
            min-height: 20px;
            height: 20px;
            position: relative;
            padding: 0;
            vertical-align: top;
        }
        
        /* 30Î∂Ñ Íµ¨Î∂ÑÏÑ† */
        .schedule-table tbody td.hour-mark {
            border-top: 2px solid var(--primary-light);
        }
        
        /* 15Î∂Ñ Íµ¨Î∂ÑÏÑ† */
        .schedule-table tbody td.quarter-mark {
            border-top: 1px solid #e0e0e0;
        }
        
        /* Î£∏ Ìó§Îçî ÏàòÏ†ï Í∞ÄÎä• */
        .room-header {
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .room-header:hover {
            background: var(--primary-light);
        }
        
        .room-header input {
            background: transparent;
            border: none;
            color: white;
            font-weight: 700;
            text-align: center;
            font-size: 0.85rem;
            width: 100%;
            padding: 0;
        }
        
        .room-header input:focus {
            outline: 2px solid var(--accent);
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
        }
        
        .time-cell {
            background: var(--bg);
            padding: 0.25rem 0.15rem;
            font-size: 0.7rem;
            font-weight: 600;
            text-align: right;
            color: var(--text-light);
            position: relative;
            min-width: 55px;
        }
        
        /* 30Î∂Ñ Îã®ÏúÑ ÏßÑÌïú ÏÑ† */
        .time-cell.hour-mark {
            border-top: 2px solid var(--primary);
            font-weight: 700;
            color: var(--primary);
        }
        
        /* 15Î∂Ñ Îã®ÏúÑ Ïó∞Ìïú ÏÑ† */
        .time-cell.quarter-mark {
            border-top: 1px solid #e0e0e0;
        }
        
        /* 5Î∂Ñ Îã®ÏúÑ - Íµ¨Î∂ÑÏÑ† ÏóÜÏùå */
        .time-cell.five-min {
            font-size: 0.65rem;
            color: #ccc;
            padding: 0.25rem;
            border-top: none;
        }
        
        /* ÏãúÍ∞Ñ Ïó¥ - 30Î∂ÑÎßàÎã§Îßå ÏãúÍ∞Ñ ÌëúÏãú */
        .time-cell .time-label {
            display: block;
        }
        
        .time-cell.five-min .time-label {
            visibility: hidden;
        }
        
        /* Î£∏ Ïª¨Îüº Ïª®ÌÖåÏù¥ÎÑà */
        .room-column {
            position: relative;
            background: var(--white);
            min-height: 20px;
        }
        
        /* ÎìúÎûòÍ∑∏ Ï§ë 5Î∂Ñ ÎààÍ∏à ÌëúÏãú */
        .room-column.dragging-over::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: repeating-linear-gradient(
                to bottom,
                transparent 0px,
                transparent 19px,
                rgba(46, 26, 71, 0.1) 19px,
                rgba(46, 26, 71, 0.1) 20px
            );
            pointer-events: none;
            z-index: 1;
        }
        
        /* ÎìúÎûòÍ∑∏ Ìà¥ÌåÅ */
        .drag-tooltip {
            position: fixed;
            background: var(--primary);
            color: white;
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            font-size: 0.8rem;
            pointer-events: none;
            z-index: 10000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            white-space: nowrap;
        }
        
        .drag-tooltip .time-info {
            font-weight: 700;
        }
        
        /* ÏÉàÎ°úÏö¥ Ïä§ÏºÄÏ§Ñ ÏÖÄ (5Î∂Ñ Îã®ÏúÑ) */
        .schedule-row {
            display: contents;
        }
        
        .schedule-cell {
            background: var(--white);
            min-height: 20px;
            position: relative;
            transition: all 0.2s;
            padding: 0;
        }
        
        /* 30Î∂Ñ Îã®ÏúÑ Íµ¨Î∂ÑÏÑ† */
        .schedule-cell.hour-mark {
            border-top: 2px solid var(--primary-light);
        }
        
        /* 15Î∂Ñ Îã®ÏúÑ Íµ¨Î∂ÑÏÑ† */
        .schedule-cell.quarter-mark {
            border-top: 1px solid #e0e0e0;
        }
        
        /* 5Î∂Ñ Îã®ÏúÑÎäî Íµ¨Î∂ÑÏÑ† ÏóÜÏùå (ÍπîÎÅîÌïòÍ≤å) */
        .schedule-cell.five-min {
            border-top: none;
        }
        
        .schedule-cell.drag-over,
        .schedule-cell.drag-target {
            background: rgba(255, 107, 157, 0.15) !important;
            box-shadow: inset 0 0 0 2px var(--accent);
        }
        
        .schedule-cell.has-session {
            padding-top: 0;
        }
        
        /* ÏÑ∏ÏÖò Ìó§Îçî (ÏÖÄ ÎÇ¥Î∂Ä) */
        .session-header-cell {
            background: linear-gradient(135deg, #3498DB 0%, #2980B9 100%);
            color: white;
            padding: 0.35rem 0.5rem;
            font-size: 0.75rem;
            font-weight: 600;
            margin: -0.25rem -0.25rem 0.25rem -0.25rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            position: relative;
            z-index: 5;
            transition: z-index 0s, filter 0.2s;
        }
        
        .session-header-cell:hover {
            filter: brightness(1.1);
            z-index: 25; /* Í∞ïÏùò Î∏îÎ°ù(z-index: 10~20)Î≥¥Îã§ ÏïûÏúºÎ°ú */
        }
        
        .session-header-cell .session-name {
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .session-header-cell .session-moderator {
            font-size: 0.65rem;
            opacity: 0.9;
            margin-left: 0.5rem;
        }
        
        .session-header-cell .session-remove {
            background: rgba(255,255,255,0.3);
            border: none;
            color: white;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0.7rem;
            margin-left: 0.25rem;
        }
        
        /* ÏÑ∏ÏÖò Ï∂îÍ∞Ä Î≤ÑÌäº */
        .add-session-btn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(52, 152, 219, 0.1);
            border: 1px dashed #3498DB;
            color: #3498DB;
            padding: 0.15rem 0.35rem;
            border-radius: 4px;
            font-size: 0.65rem;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 50;
            white-space: nowrap;
        }
        
        .schedule-cell:hover .add-session-btn {
            opacity: 1;
        }
        
        .add-session-btn:hover {
            background: #3498DB;
            color: white;
        }
        
        /* ÏÑ∏ÏÖò ÎÇ¥ Í∞ïÏùò (Îì§Ïó¨Ïì∞Í∏∞) */
        .scheduled-lecture.in-session {
            margin-left: 0.5rem;
            border-left: 3px solid rgba(255,255,255,0.5);
        }
        
        .scheduled-lecture {
            color: var(--white);
            padding: 0.5rem;
            border-radius: 6px;
            font-size: 0.8rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            position: absolute;
            left: 2px;
            right: 2px;
            z-index: 10;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .scheduled-lecture:hover {
            z-index: 20;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
        }
        
        .scheduled-lecture .lecture-title-display {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            font-weight: 600;
            font-size: 0.8rem;
            line-height: 1.3;
            margin-bottom: 0.25rem;
        }
        
        .scheduled-lecture .lecture-meta-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.7rem;
            opacity: 0.9;
            margin-top: auto;
        }
        
        .scheduled-lecture .speaker-name {
            font-weight: 500;
        }
        
        .scheduled-lecture .duration-badge {
            background: rgba(255,255,255,0.2);
            padding: 0.1rem 0.3rem;
            border-radius: 3px;
            font-size: 0.65rem;
        }
        
        .scheduled-lecture small {
            opacity: 0.9;
            font-size: 0.7rem;
        }
        
        .remove-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: rgba(255, 255, 255, 0.3);
            color: var(--white);
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            font-size: 1rem;
            line-height: 1;
            transition: all 0.2s;
        }
        
        .remove-btn:hover {
            background: rgba(255, 255, 255, 0.5);
            transform: scale(1.1);
        }
        
        .export-section {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--bg);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--accent);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.2s;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--white);
            padding: 2rem;
            border-radius: 16px;
            max-width: 700px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-header h2 {
            font-size: 1.5rem;
            color: var(--primary);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: var(--text-light);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s;
        }

        .modal-close:hover {
            background: var(--bg);
            color: var(--primary);
        }

        .speaker-list {
            max-height: 400px;
            overflow-y: auto;
            border: 2px solid var(--border);
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .speaker-item {
            padding: 1rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s;
        }

        .speaker-item:hover {
            background: var(--bg);
        }

        .speaker-item:last-child {
            border-bottom: none;
        }

        .speaker-info strong {
            display: block;
            margin-bottom: 0.25rem;
            color: var(--primary);
        }

        .speaker-info small {
            color: var(--text-light);
            display: block;
            margin-top: 0.25rem;
        }

        .speaker-actions {
            display: flex;
            gap: 0.5rem;
        }

        .search-sort-container {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            align-items: center;
        }

        .search-input {
            flex: 1;
            padding: 0.75rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 0.95rem;
            font-family: 'Noto Sans KR', sans-serif;
            transition: all 0.2s;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(255, 107, 157, 0.1);
        }

        .sort-select {
            padding: 0.75rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 0.95rem;
            font-family: 'Noto Sans KR', sans-serif;
            background: var(--white);
            cursor: pointer;
            min-width: 150px;
        }

        .sort-select:focus {
            outline: none;
            border-color: var(--accent);
        }

        .autocomplete-container {
            position: relative;
        }

        .autocomplete-list {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--white);
            border: 2px solid var(--border);
            border-top: none;
            border-radius: 0 0 8px 8px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 100;
            box-shadow: 0 4px 12px var(--shadow);
            display: none;
        }

        .autocomplete-list.active {
            display: block;
        }

        .autocomplete-item {
            padding: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 1px solid var(--border);
        }

        .autocomplete-item:hover {
            background: var(--bg);
        }

        .autocomplete-item.selected {
            background: var(--primary);
            color: white;
        }

        .autocomplete-item.selected strong {
            color: white;
        }

        .autocomplete-item.selected small {
            color: rgba(255, 255, 255, 0.8);
        }

        .autocomplete-item:last-child {
            border-bottom: none;
        }

        .autocomplete-item strong {
            display: block;
            color: var(--primary);
        }

        .autocomplete-item small {
            color: var(--text-light);
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .category-color {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }

        /* ÌôïÏù∏ Îã§Ïù¥ÏñºÎ°úÍ∑∏ Ïä§ÌÉÄÏùº */
        .confirm-dialog {
            background: var(--white);
            padding: 2rem;
            border-radius: 16px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }

        .confirm-dialog h3 {
            font-size: 1.25rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .confirm-dialog p {
            color: var(--text);
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .confirm-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        .form-grid-4 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        /* ÎßûÎ∞îÍæ∏Í∏∞ Îã§Ïù¥ÏñºÎ°úÍ∑∏ */
        .swap-dialog-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }
        
        .swap-dialog {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            max-width: 420px;
            width: 90%;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        
        .swap-dialog h3 {
            margin-bottom: 1rem;
            color: var(--primary);
        }
        
        .swap-dialog p {
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }
        
        .swap-options {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-top: 1.25rem;
        }
        
        .swap-option {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            background: white;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        
        .swap-option:hover, .swap-option:focus {
            border-color: var(--accent);
            background: rgba(255, 107, 157, 0.1);
            outline: none;
        }
        
        .swap-option.cancel {
            border-color: #ddd;
            color: #666;
        }
        
        .swap-option.cancel:hover {
            border-color: #999;
            background: #f5f5f5;
        }
        
        .option-key {
            background: var(--primary);
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
            min-width: 28px;
            text-align: center;
        }
        
        .swap-option.cancel .option-key {
            background: #999;
        }
        
        /* ÏÉâÏÉÅ ÏÑ†ÌÉù Î≤ÑÌäº */
        .color-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: 3px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .color-btn:hover {
            transform: scale(1.1);
        }
        
        .color-btn.selected {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px white, 0 0 0 4px var(--primary);
        }
        
        /* Î≤àÏó≠ ÎèÑÏõÄÎßê ÎßÅÌÅ¨ */
        .translation-help {
            font-size: 0.75rem;
            color: #888;
            margin-top: 4px;
        }
        
        .translation-help a {
            color: var(--accent);
            text-decoration: none;
            margin: 0 2px;
        }
        
        .translation-help a:hover {
            text-decoration: underline;
        }
        
        /* ÎìúÎûòÍ∑∏ Ìà¥ÌåÅ */
        .drag-tooltip {
            position: fixed;
            background: var(--primary);
            color: white;
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            font-size: 0.8rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            pointer-events: none;
            z-index: 10000;
            display: none;
            white-space: nowrap;
        }
        
        .drag-tooltip.active {
            display: block;
        }
        
        .drag-tooltip .tooltip-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .drag-tooltip .tooltip-time {
            font-size: 0.9rem;
            opacity: 0.95;
        }
        
        .drag-tooltip .tooltip-duration {
            font-size: 0.75rem;
            opacity: 0.8;
            margin-top: 0.15rem;
        }
        
        /* ÎìúÎûòÍ∑∏ Ï§ë 5Î∂Ñ ÎààÍ∏à ÌëúÏãú */
        .schedule-grid.dragging .schedule-cell::before {
            content: '';
            position: absolute;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;
            background: repeating-linear-gradient(
                to bottom,
                transparent 0px,
                transparent 19px,
                rgba(46, 26, 71, 0.08) 19px,
                rgba(46, 26, 71, 0.08) 20px
            );
            pointer-events: none;
            z-index: 1;
        }
        
        /* ÎìúÎûòÍ∑∏ Ï§ë 30Î∂Ñ Îã®ÏúÑ Í∞ïÏ°∞ */
        .schedule-grid.dragging .schedule-cell.hour-mark::after {
            content: '';
            position: absolute;
            left: 0;
            right: 0;
            top: 0;
            height: 2px;
            background: var(--primary);
            z-index: 2;
        }
        
        /* ÎìúÎûòÍ∑∏ Ïò§Î≤Ñ Ïãú ÌòÑÏû¨ ÏÖÄ ÌïòÏù¥ÎùºÏù¥Ìä∏ */
        .schedule-cell.drag-target {
            background: rgba(255, 107, 157, 0.15) !important;
            box-shadow: inset 0 0 0 2px var(--accent);
        }
        
        /* 5Î∂Ñ Îã®ÏúÑ ÏÖÄ ÎÜíÏù¥ Ï°∞Ï†ï */
        .schedule-cell {
            min-height: 20px;
            height: 20px;
        }
        
        .time-cell {
            min-height: 20px;
            height: 20px;
            display: flex;
            align-items: flex-start;
            justify-content: flex-end;
            padding-right: 0.5rem;
            font-size: 0.75rem;
            color: var(--text-light);
        }
        
        .time-cell.hour-mark {
            font-weight: 600;
            color: var(--primary);
            border-top: 2px solid var(--primary-light);
        }
        
        .time-cell.quarter-mark {
            color: var(--text-light);
            border-top: 1px solid var(--border);
        }
        
        .time-cell.five-min .time-label {
            display: none;
        }
    </style>
</head>
<body>
    <!-- ÎìúÎûòÍ∑∏ Ìà¥ÌåÅ -->
    <div class="drag-tooltip" id="dragTooltip">
        <div class="tooltip-title" id="tooltipTitle"></div>
        <div class="tooltip-time" id="tooltipTime"></div>
        <div class="tooltip-duration" id="tooltipDuration"></div>
    </div>

    <!-- Î°úÍ∑∏Ïù∏ Ïò§Î≤ÑÎ†àÏù¥ -->
    <div class="login-overlay" id="loginOverlay">
        <div class="login-box">
            <h2>üìÖ ÌïôÏà†ÎåÄÌöå Ïä§ÏºÄÏ§ÑÎü¨</h2>
            <p>Ìé∏ÏßëÌïòÎ†§Î©¥ Google Í≥ÑÏ†ïÏúºÎ°ú Î°úÍ∑∏Ïù∏ÌïòÏÑ∏Ïöî.<br>ÏäπÏù∏Îêú ÏÇ¨Ïö©ÏûêÎßå ÏàòÏ†ïÌï† Ïàò ÏûàÏäµÎãàÎã§.</p>
            <button class="google-login-btn" onclick="signInWithGoogle()">
                <img src="https://www.google.com/favicon.ico" alt="Google">
                Google Í≥ÑÏ†ïÏúºÎ°ú Î°úÍ∑∏Ïù∏
            </button>
        </div>
    </div>

    <div class="header">
        <div>
            <h1>üìÖ ÌïôÏà†ÎåÄÌöå Ïä§ÏºÄÏ§ÑÎü¨</h1>
        </div>
        <div class="header-actions">
            <!-- ÎèôÍ∏∞Ìôî ÏÉÅÌÉú -->
            <div class="sync-status synced" id="syncStatus">
                <span class="sync-dot"></span>
                <span id="syncText">ÎèôÍ∏∞ÌôîÎê®</span>
            </div>
            
            <!-- Ïò®ÎùºÏù∏ ÏÇ¨Ïö©Ïûê -->
            <div class="online-users" id="onlineUsers">
                <span>üë•</span>
                <div class="user-avatars" id="userAvatars"></div>
                <span id="onlineCount">0Î™Ö Ï†ëÏÜç</span>
            </div>
            
            <!-- ÌïúÍ∏Ä/ÏòÅÎ¨∏ Ï†ÑÌôò Î≤ÑÌäº -->
            <div style="display: flex; border-radius: 6px; overflow: hidden;">
                <button class="btn btn-small" id="langKoBtn" onclick="setLanguage('ko')" style="background: var(--accent); color: white; border-radius: 6px 0 0 6px;">ÌïúÍ∏Ä</button>
                <button class="btn btn-small" id="langEnBtn" onclick="setLanguage('en')" style="background: rgba(255,255,255,0.2); color: white; border-radius: 0 6px 6px 0;">English</button>
            </div>
            
            <!-- Î°úÍ∑∏Ïù∏ ÏÉÅÌÉú -->
            <div class="auth-status" id="authStatus">
                <span id="authText">Î°úÍ∑∏Ïù∏ ÌïÑÏöî</span>
            </div>
            
            <!-- ÏÇ¨Ïö©Ïûê Í¥ÄÎ¶¨ Î≤ÑÌäº (Í¥ÄÎ¶¨ÏûêÎßå Î≥¥ÏûÑ) -->
            <button class="btn btn-secondary btn-small user-mgmt-btn" onclick="openUserManagementModal()">
                üë• ÏÇ¨Ïö©Ïûê Í¥ÄÎ¶¨
                <span class="pending-badge" id="pendingBadge" style="display:none;">0</span>
            </button>
            
            <button class="btn btn-secondary btn-small" id="undoBtn" onclick="performUndo()" disabled>‚Ü© ÎêòÎèåÎ¶¨Í∏∞ (0/5)</button>
            <button class="btn btn-secondary btn-small" onclick="openSessionModal()">üìã ÏÑ∏ÏÖò Í¥ÄÎ¶¨</button>
            <button class="btn btn-secondary btn-small" onclick="openHelpModal()">‚ùì ÎèÑÏõÄÎßê</button>
            <button class="btn btn-secondary btn-small" onclick="openSpeakerModal()">üë§ Ïó∞Ïûê Í¥ÄÎ¶¨</button>
            <button class="btn btn-primary btn-small" onclick="openUploadModal()">üì§ Í∞ïÏùò ÏùºÍ¥Ñ ÏóÖÎ°úÎìú</button>
            <button class="btn btn-secondary btn-small" onclick="openBackupModal()">üíæ Î∞±ÏóÖ Í¥ÄÎ¶¨</button>
            <button class="btn btn-secondary btn-small admin-only-btn" onclick="resetAllData()" style="color:#e74c3c; display:none;">üîÑ Ï¥àÍ∏∞Ìôî</button>
        </div>
    </div>

    <div class="container">
        <div class="sidebar">
            <div class="card" id="addLectureCard">
                <div class="card-title" onclick="toggleCard('addLectureCard')">
                    ‚ûï Í∞ïÏùò Ï∂îÍ∞Ä
                    <span class="toggle-icon">‚ñº</span>
                </div>
                <div class="card-content">
                    <form class="lecture-form" id="lectureForm" onsubmit="return false;">
                        <div class="form-group">
                            <label>Î∂ÑÎ•ò</label>
                            <select id="category" required>
                                <option value="">ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Ï†úÎ™© (ÌïúÍ∏Ä)</label>
                            <input type="text" id="titleKo" required>
                        </div>
                        
                        <div class="form-group">
                            <label>Ï†úÎ™© (ÏòÅÎ¨∏)</label>
                            <input type="text" id="titleEn" placeholder="English title">
                            <div class="translation-help">
                                üí° Î≤àÏó≠: 
                                <a href="https://translate.google.com/?sl=ko&tl=en" target="_blank">Google</a> | 
                                <a href="https://papago.naver.com/" target="_blank">Papago</a> | 
                                <a href="https://www.deepl.com/translator#ko/en/" target="_blank">DeepL</a>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group autocomplete-container">
                                <label>Ïó∞Ïûê (ÌïúÍ∏Ä)</label>
                                <input type="text" id="speakerKo" autocomplete="off" required>
                                <div class="autocomplete-list" id="autocompleteList"></div>
                            </div>
                            <div class="form-group">
                                <label>Ïó∞Ïûê (ÏòÅÎ¨∏)</label>
                                <input type="text" id="speakerEn" placeholder="Speaker name">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>ÏÜåÏÜç</label>
                                <input type="text" id="affiliation">
                            </div>
                            <div class="form-group">
                                <label>Í∞ïÏùò ÏãúÍ∞Ñ</label>
                                <select id="lectureDuration" required>
                                    <option value="10">10Î∂Ñ</option>
                                    <option value="15" selected>15Î∂Ñ</option>
                                    <option value="20">20Î∂Ñ</option>
                                    <option value="30">30Î∂Ñ</option>
                                    <option value="40">40Î∂Ñ</option>
                                    <option value="50">50Î∂Ñ</option>
                                    <option value="60">60Î∂Ñ</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group" style="border-top: 1px dashed var(--border); padding-top: 0.75rem; margin-top: 0.5rem;">
                            <label style="color: var(--accent);">üè¢ Ïä§Ìè∞ÏÑú/Ï†úÌíà Ï†ïÎ≥¥ (ÏÑ†ÌÉù)</label>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>ÌöåÏÇ¨Î™Ö</label>
                                <input type="text" id="companyName" placeholder="Ïòà: ÎåÄÏõÖÏ†úÏïΩ">
                            </div>
                            <div class="form-group">
                                <label>Ï†úÌíàÎ™Ö</label>
                                <input type="text" id="productName" placeholder="Ïòà: ÎÇòÎ≥¥ÌÉÄ">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Ï†úÌíà ÏÑ§Î™Ö</label>
                            <input type="text" id="productDescription" placeholder="Ïòà: Î≥¥Ìà¥Î¶¨Îàî ÌÜ°Ïã†">
                        </div>
                        
                        <button type="button" class="btn btn-primary" id="addLectureBtn">Í∞ïÏùò Ï∂îÍ∞Ä</button>
                        <button type="button" class="btn btn-secondary" onclick="openCategoryModal()" style="margin-top: 0.5rem;">üìÇ Î∂ÑÎ•ò Í¥ÄÎ¶¨</button>
                    </form>
                </div>
            </div>
            
            <div class="card" id="lectureListCard">
                <div class="card-title">
                    üìö Í∞ïÏùò Î™©Î°ù
                    <button class="btn btn-small" id="toggleFiltersBtn" onclick="toggleCategoryFilters()" style="margin-left: auto; padding: 0.2rem 0.5rem; font-size: 0.7rem;">
                        üìÇ Î∂ÑÎ•ò Ï†ëÍ∏∞
                    </button>
                </div>
                <div class="card-content">
                    <!-- Í≤ÄÏÉâÏ∞Ω -->
                    <div class="lecture-search-box">
                        <input type="text" id="lectureSearchInput" placeholder="üîç Í∞ïÏùò Ï†úÎ™©, Ïó∞ÏûêÎ™Ö Í≤ÄÏÉâ..." oninput="filterLecturesBySearch()">
                        <button class="search-clear-btn" onclick="clearLectureSearch()" title="Í≤ÄÏÉâ Ï¥àÍ∏∞Ìôî">‚úï</button>
                    </div>
                    <div class="category-filters-wrapper" id="categoryFiltersWrapper">
                        <div class="category-filters" id="categoryFilters"></div>
                    </div>
                    <div class="lecture-list" id="lectureList"></div>
                </div>
            </div>
        </div>

        <div class="schedule-grid">
            <div class="grid-header">
                <h2>ÏãúÍ∞ÑÌëú</h2>
                <div class="date-selector-btns" id="dateSelectorBtns">
                    <button class="date-btn active" data-date="2026-04-11" onclick="switchDate('2026-04-11')">üìÖ ÌÜ†ÏöîÏùº (4/11)</button>
                    <button class="date-btn" data-date="2026-04-12" onclick="switchDate('2026-04-12')">üìÖ ÏùºÏöîÏùº (4/12)</button>
                </div>
                <button class="btn btn-small btn-secondary" onclick="addRoom()" style="margin-left: 1rem;">‚ûï Î£∏ Ï∂îÍ∞Ä</button>
            </div>

            <div class="schedule-table-wrapper">
                <div class="schedule-table" id="scheduleTable"></div>
            </div>

            <div class="export-section">
                <button class="btn btn-secondary" onclick="exportToExcel()">üìä ÏóëÏÖÄÎ°ú ÎÇ¥Î≥¥ÎÇ¥Í∏∞</button>
                <button class="btn btn-secondary" onclick="printSchedule()">üñ®Ô∏è Ïù∏ÏáÑ/PDF</button>
            </div>
            
            <!-- Firebase Ïã§ÏãúÍ∞Ñ ÎèôÍ∏∞Ìôî ÏïàÎÇ¥ -->
            <div style="margin-top: 1rem; padding: 0.75rem; border-radius: 8px; background: linear-gradient(135deg, #e8f5e9 0%, #f1f8e9 100%); display: flex; align-items: center; gap: 0.5rem;">
                <span>üîÑ</span>
                <span style="font-size: 0.85rem;">Ïã§ÏãúÍ∞Ñ ÏûêÎèô Ï†ÄÏû• ¬∑ Î™®Îì† Î≥ÄÍ≤ΩÏÇ¨Ìï≠ÏùÄ Ï¶âÏãú ÎèôÍ∏∞ÌôîÎê©ÎãàÎã§</span>
            </div>
        </div>
    </div>

    <!-- Î∂ÑÎ•ò Í¥ÄÎ¶¨ Î™®Îã¨ -->
    <div class="modal" id="categoryModal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h2>üìÇ Î∂ÑÎ•ò Í¥ÄÎ¶¨</h2>
                <button class="modal-close" onclick="closeCategoryModal()">√ó</button>
            </div>
            
            <div class="form-group">
                <label>ÏÉà Î∂ÑÎ•ò Ï∂îÍ∞Ä</label>
                <div style="display: flex; gap: 0.5rem;">
                    <input type="text" id="newCategoryName" placeholder="Î∂ÑÎ•òÎ™Ö (ÏòÅÎ¨∏)" style="flex: 1;">
                    <input type="color" id="newCategoryColor" value="#9B59B6" style="width: 60px; height: 42px; border: none; cursor: pointer;">
                    <button class="btn btn-primary" onclick="addCategory()">Ï∂îÍ∞Ä</button>
                </div>
            </div>

            <div style="margin: 1rem 0; padding: 0.75rem; background: #FFF3CD; border-radius: 8px; border-left: 4px solid #FFC107;">
                <small>‚ö†Ô∏è Î∂ÑÎ•òÎ•º ÏÇ≠Ï†úÌïòÎ©¥ Ìï¥Îãπ Î∂ÑÎ•òÏùò Í∞ïÏùòÎäî "Others"Î°ú Î≥ÄÍ≤ΩÎê©ÎãàÎã§.</small>
            </div>

            <div class="speaker-list" id="categoryList" style="max-height: 400px;"></div>
        </div>
    </div>

    <!-- ÏÑ∏ÏÖò Í¥ÄÎ¶¨ Î™®Îã¨ -->
    <div class="modal" id="sessionModal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h2>üìã ÏÑ∏ÏÖò Í¥ÄÎ¶¨</h2>
                <button class="modal-close" onclick="closeSessionModal()">√ó</button>
            </div>
            
            <div style="background: #E3F2FD; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border-left: 4px solid #2196F3;">
                <p style="margin: 0; font-size: 0.9rem;">üí° <strong>ÏãúÍ∞ÑÌëúÏóêÏÑú ÏÖÄ ÏúÑÏóê ÎßàÏö∞Ïä§Î•º Ïò¨Î¶¨Î©¥ "+ ÏÑ∏ÏÖò" Î≤ÑÌäºÏù¥ ÎÇòÌÉÄÎÇ©ÎãàÎã§.</strong></p>
                <p style="margin: 0.5rem 0 0 0; font-size: 0.85rem; color: #666;">Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌïòÏó¨ Ìï¥Îãπ ÏãúÍ∞Ñ/Î£∏Ïóê ÏÑ∏ÏÖòÏùÑ Ï∂îÍ∞ÄÌïòÏÑ∏Ïöî. ÏÑ∏ÏÖò Ìó§ÎçîÎ•º ÌÅ¥Î¶≠ÌïòÎ©¥ ÏàòÏ†ïÌï† Ïàò ÏûàÏäµÎãàÎã§.</p>
            </div>

            <div class="form-group">
                <label><strong>ÌòÑÏû¨ ÏÑ∏ÏÖò Î™©Î°ù</strong></label>
                <div id="sessionList" style="max-height: 400px; overflow-y: auto;"></div>
            </div>
        </div>
    </div>

    <!-- Ïó∞Ïûê Í¥ÄÎ¶¨ Î™®Îã¨ -->
    <div class="modal" id="speakerModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üë• Ïó∞Ïûê Í¥ÄÎ¶¨</h2>
                <button class="modal-close" onclick="closeSpeakerModal()">√ó</button>
            </div>
            
            <div class="form-group">
                <label>ÏÉà Ïó∞Ïûê Ï∂îÍ∞Ä</label>
                <div class="form-grid-4">
                    <input type="text" id="newSpeakerName" placeholder="Ïó∞ÏûêÎ™Ö (ÌïúÍ∏Ä)">
                    <input type="text" id="newSpeakerNameEn" placeholder="Ïó∞ÏûêÎ™Ö (ÏòÅÎ¨∏)">
                    <input type="text" id="newSpeakerAffiliation" placeholder="ÏÜåÏÜç (ÌïúÍ∏Ä)">
                    <input type="text" id="newSpeakerAffiliationEn" placeholder="ÏÜåÏÜç (ÏòÅÎ¨∏)">
                </div>
                <button class="btn btn-primary" onclick="addSpeaker()" style="margin-top: 0.5rem; width: 100%;">Ï∂îÍ∞Ä</button>
            </div>

            <div style="margin: 1.5rem 0;">
                <div class="search-sort-container">
                    <input type="text" id="speakerSearch" class="search-input" 
                           placeholder="üîç Ïó∞ÏûêÎ™Ö ÎòêÎäî ÏÜåÏÜçÏúºÎ°ú Í≤ÄÏÉâ..." 
                           oninput="searchSpeakers()">
                    <select id="speakerSort" class="sort-select" onchange="updateSpeakerList()">
                        <option value="name-ko">Í∞ÄÎÇòÎã§Ïàú (ÌïúÍ∏Ä)</option>
                        <option value="name-en">ABCÏàú (ÏòÅÎ¨∏)</option>
                        <option value="affiliation">ÏÜåÏÜçÏàú</option>
                        <option value="recent">ÏµúÍ∑º Ï∂îÍ∞ÄÏàú</option>
                    </select>
                </div>
            </div>

            <div class="speaker-list" id="speakerList"></div>
        </div>
    </div>

    <!-- Í∞ïÏùò ÏàòÏ†ï Î™®Îã¨ -->
    <div class="modal" id="editModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚úèÔ∏è Í∞ïÏùò ÏàòÏ†ï</h2>
                <button class="modal-close" onclick="closeEditModal()">√ó</button>
            </div>
            
            <form class="lecture-form" id="editForm" onsubmit="return false;">
                <input type="hidden" id="editLectureId">
                <div class="form-group">
                    <label>Î∂ÑÎ•ò</label>
                    <select id="editCategory" required>
                        <option value="Laser & EBDs">Laser & EBDs</option>
                        <option value="Injectables">Injectables</option>
                        <option value="Lifting Devices">Lifting Devices</option>
                        <option value="Bio-Stimulators">Bio-Stimulators</option>
                        <option value="Threads">Threads</option>
                        <option value="Regeneratives">Regeneratives</option>
                        <option value="Cosmeceuticals">Cosmeceuticals</option>
                        <option value="Aesthetic Devices">Aesthetic Devices</option>
                        <option value="Diagnostic Devices">Diagnostic Devices</option>
                        <option value="Dermatology">Dermatology</option>
                        <option value="Hair">Hair</option>
                        <option value="Body Contouring">Body Contouring</option>
                        <option value="Consumables">Consumables</option>
                        <option value="AI & CRM">AI & CRM</option>
                        <option value="Management & Marketing">Management & Marketing</option>
                        <option value="Sedation & Analgesia Devices">Sedation & Analgesia Devices</option>
                        <option value="Anatomy">Anatomy</option>
                        <option value="International Faculty & Global Trends">International Faculty & Global Trends</option>
                        <option value="ASLS">ASLS</option>
                        <option value="Safety Equipment">Safety Equipment</option>
                        <option value="Digital Solutions">Digital Solutions</option>
                        <option value="Medical Supplies">Medical Supplies</option>
                        <option value="Others">Others</option>
                        <option value="Other Solutions">Other Solutions</option>
                        <option value="Stem Cell & Functional">Stem Cell & Functional</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Ï†úÎ™© (ÌïúÍ∏Ä)</label>
                    <input type="text" id="editTitleKo" required>
                </div>
                
                <div class="form-group">
                    <label>Ï†úÎ™© (ÏòÅÎ¨∏)</label>
                    <input type="text" id="editTitleEn">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Ïó∞Ïûê (ÌïúÍ∏Ä)</label>
                        <input type="text" id="editSpeakerKo" required>
                    </div>
                    <div class="form-group">
                        <label>Ïó∞Ïûê (ÏòÅÎ¨∏)</label>
                        <input type="text" id="editSpeakerEn">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>ÏÜåÏÜç</label>
                    <input type="text" id="editAffiliation">
                </div>
                
                <div class="form-group">
                    <label>Í∞ïÏùò ÏãúÍ∞Ñ</label>
                    <select id="editDuration">
                        <option value="10">10Î∂Ñ</option>
                        <option value="15">15Î∂Ñ</option>
                        <option value="20">20Î∂Ñ</option>
                        <option value="30">30Î∂Ñ</option>
                        <option value="40">40Î∂Ñ</option>
                        <option value="50">50Î∂Ñ</option>
                        <option value="60">60Î∂Ñ</option>
                    </select>
                </div>
                
                <div style="display: flex; gap: 0.5rem;">
                    <button type="button" class="btn btn-primary" id="saveEditBtn" style="flex: 1;">ÏàòÏ†ï ÏôÑÎ£å</button>
                    <button type="button" class="btn btn-secondary" id="deleteEditBtn" style="background: #E74C3C; color: white;" onclick="deleteLectureFromModal()">üóëÔ∏è ÏÇ≠Ï†ú</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Ïó∞Ïûê Ï∂îÍ∞Ä ÌôïÏù∏ Îã§Ïù¥ÏñºÎ°úÍ∑∏ -->
    <div class="modal" id="confirmAddSpeakerModal">
        <div class="confirm-dialog">
            <h3>üìù ÏÉàÎ°úÏö¥ Ïó∞Ïûê Ï∂îÍ∞Ä</h3>
            <p id="confirmMessage"></p>
            <div class="confirm-actions">
                <button class="btn btn-secondary btn-small" onclick="closeConfirmAddSpeaker()">ÏïÑÎãàÏò§</button>
                <button class="btn btn-primary btn-small" onclick="confirmAddNewSpeaker()">Ïòà</button>
            </div>
        </div>
    </div>

    <!-- ÏÑ∏ÏÖò Ï∂îÍ∞Ä/ÏàòÏ†ï Î™®Îã¨ -->
    <div class="modal" id="cellSessionModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 id="cellSessionModalTitle">üìã ÏÑ∏ÏÖò Ï∂îÍ∞Ä</h2>
                <button class="modal-close" onclick="closeCellSessionModal()">√ó</button>
            </div>
            
            <form class="lecture-form" onsubmit="return false;">
                <input type="hidden" id="cellSessionTime">
                <input type="hidden" id="cellSessionRoom">
                <input type="hidden" id="cellSessionId">
                
                <div class="form-group">
                    <label>ÏÑ∏ÏÖòÎ™Ö (ÌïúÍ∏Ä) <span style="color: #E74C3C;">*</span></label>
                    <input type="text" id="cellSessionName" required placeholder="Ïòà: Î†àÏù¥Ï†Ä ÏπòÎ£åÏùò ÏµúÏã† ÎèôÌñ•">
                </div>
                
                <div class="form-group">
                    <label>ÏÑ∏ÏÖòÎ™Ö (ÏòÅÎ¨∏)</label>
                    <input type="text" id="cellSessionNameEn" placeholder="Ïòà: Latest Trends in Laser Treatment">
                    <div class="translation-help">
                        üí° Î≤àÏó≠: 
                        <a href="https://translate.google.com/?sl=ko&tl=en" target="_blank">Google</a> | 
                        <a href="https://papago.naver.com/" target="_blank">Papago</a> | 
                        <a href="https://www.deepl.com/translator#ko/en/" target="_blank">DeepL</a>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Ï¢åÏû• (ÌïúÍ∏Ä)</label>
                    <input type="text" id="cellSessionModerator" placeholder="Ïó∞ÏûêÎ™Ö ÏûÖÎ†•" list="moderatorSuggestions">
                    <datalist id="moderatorSuggestions"></datalist>
                </div>
                
                <div class="form-group">
                    <label>Ï¢åÏû• (ÏòÅÎ¨∏)</label>
                    <input type="text" id="cellSessionModeratorEn" placeholder="Chair name in English">
                </div>
                
                <div class="form-group">
                    <label>ÏÑ∏ÏÖò ÏÉâÏÉÅ</label>
                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;" id="sessionColorPicker">
                        <button type="button" class="color-btn" data-color="#3498DB" style="background: #3498DB;"></button>
                        <button type="button" class="color-btn" data-color="#E74C3C" style="background: #E74C3C;"></button>
                        <button type="button" class="color-btn" data-color="#2ECC71" style="background: #2ECC71;"></button>
                        <button type="button" class="color-btn" data-color="#9B59B6" style="background: #9B59B6;"></button>
                        <button type="button" class="color-btn" data-color="#F39C12" style="background: #F39C12;"></button>
                        <button type="button" class="color-btn" data-color="#1ABC9C" style="background: #1ABC9C;"></button>
                        <button type="button" class="color-btn" data-color="#E91E63" style="background: #E91E63;"></button>
                        <button type="button" class="color-btn" data-color="#00BCD4" style="background: #00BCD4;"></button>
                    </div>
                    <input type="hidden" id="cellSessionColor" value="#3498DB">
                </div>
                
                <button type="button" class="btn btn-primary" onclick="saveCellSession()" style="width: 100%;">Ï†ÄÏû•</button>
            </form>
        </div>
    </div>

    <!-- Ïó∞Ïûê ÏàòÏ†ï Î™®Îã¨ -->
    <div class="modal" id="editSpeakerModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚úèÔ∏è Ïó∞Ïûê Ï†ïÎ≥¥ ÏàòÏ†ï</h2>
                <button class="modal-close" onclick="closeEditSpeakerModal()">√ó</button>
            </div>
            
            <form class="lecture-form" onsubmit="return false;">
                <input type="hidden" id="editSpeakerIndex">
                <div class="form-group">
                    <label>Ïó∞ÏûêÎ™Ö (ÌïúÍ∏Ä)</label>
                    <input type="text" id="editSpeakerNameField" required>
                </div>
                <div class="form-group">
                    <label>Ïó∞ÏûêÎ™Ö (ÏòÅÎ¨∏)</label>
                    <input type="text" id="editSpeakerNameEnField">
                </div>
                <div class="form-group">
                    <label>ÏÜåÏÜç (ÌïúÍ∏Ä)</label>
                    <input type="text" id="editSpeakerAffiliationField" required>
                </div>
                <div class="form-group">
                    <label>ÏÜåÏÜç (ÏòÅÎ¨∏)</label>
                    <input type="text" id="editSpeakerAffiliationEnField">
                </div>
                <button type="button" class="btn btn-primary" onclick="saveEditedSpeaker()">Ï†ÄÏû•</button>
            </form>
        </div>
    </div>

    <!-- ÎèÑÏõÄÎßê Î™®Îã¨ -->
    <div class="modal" id="helpModal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2>‚ùì ÏÇ¨Ïö© ÎèÑÏõÄÎßê</h2>
                <button class="modal-close" onclick="closeHelpModal()">√ó</button>
            </div>
            
            <div style="max-height: 70vh; overflow-y: auto; padding: 1rem;">
                <h3 style="color: var(--primary); margin-top: 1rem; margin-bottom: 0.5rem;">‚òÅÔ∏è Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞Îèô</h3>
                <div style="background: #E8F5E9; padding: 1rem; border-radius: 8px; border-left: 4px solid #4CAF50; margin-bottom: 1rem;">
                    <h4 style="color: #2E7D32; margin-bottom: 0.5rem;">üîê Google Î°úÍ∑∏Ïù∏</h4>
                    <p style="margin-bottom: 0.5rem;">‚ë† Ïö∞Ï∏° ÏÉÅÎã® <strong>"üîê Google Î°úÍ∑∏Ïù∏"</strong> Î≤ÑÌäº ÌÅ¥Î¶≠</p>
                    <p style="margin-bottom: 0.5rem;">‚ë° Google Í≥ÑÏ†ï ÏÑ†ÌÉù Î∞è Î°úÍ∑∏Ïù∏</p>
                    <p style="margin-bottom: 0.5rem;">‚ë¢ ÎìúÎùºÏù¥Î∏å Ï†ëÍ∑º Í∂åÌïú ÌóàÏö©</p>
                    <p style="color: #666; font-size: 0.9rem;">‚úÖ Î°úÍ∑∏Ïù∏ ÌõÑ ÎìúÎùºÏù¥Î∏å Ï†ÄÏû•/Î∂àÎü¨Ïò§Í∏∞ Í∞ÄÎä•!</p>
                </div>

                <div style="background: var(--bg); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <h4 style="color: var(--accent); margin-bottom: 0.5rem;">üíæ ÎìúÎùºÏù¥Î∏åÏóê Ï†ÄÏû•</h4>
                    <p style="margin-bottom: 0.5rem;">‚ë† <strong>"üíæ ÎìúÎùºÏù¥Î∏åÏóê Ï†ÄÏû•"</strong> Î≤ÑÌäº ÌÅ¥Î¶≠</p>
                    <p style="margin-bottom: 0.5rem;">‚ë° ÏûêÎèôÏúºÎ°ú Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏åÏóê ÏóÖÎ°úÎìúÎê®</p>
                    <p style="color: var(--text-light); font-size: 0.9rem;">üí° ÏûêÎèôÏ†ÄÏû•: Î≥ÄÍ≤ΩÏÇ¨Ìï≠ ÏûàÏùÑ Îïå 30Ï¥àÎßàÎã§ ÏûêÎèô Ï†ÄÏû•</p>
                </div>

                <div style="background: var(--bg); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <h4 style="color: var(--accent); margin-bottom: 0.5rem;">‚òÅÔ∏è ÎìúÎùºÏù¥Î∏åÏóêÏÑú Î∂àÎü¨Ïò§Í∏∞</h4>
                    <p style="margin-bottom: 0.5rem;">‚ë† <strong>"‚òÅÔ∏è ÎìúÎùºÏù¥Î∏åÏóêÏÑú Î∂àÎü¨Ïò§Í∏∞"</strong> Î≤ÑÌäº ÌÅ¥Î¶≠</p>
                    <p style="margin-bottom: 0.5rem;">‚ë° Ï†ÄÏû•Îêú ÌååÏùº Î™©Î°ùÏóêÏÑú ÏÑ†ÌÉù</p>
                    <p style="margin-bottom: 0.5rem;">‚ë¢ Îç∞Ïù¥ÌÑ∞ ÏûêÎèô Î°úÎìú</p>
                </div>

                <h3 style="color: var(--primary); margin-top: 1.5rem; margin-bottom: 0.5rem;">üíæ Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• Î∞è Î∂àÎü¨Ïò§Í∏∞</h3>
                <div style="background: var(--bg); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <h4 style="color: var(--accent); margin-bottom: 0.5rem;">1Ô∏è‚É£ Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏åÏóê Ï†ÄÏû• (ÌòÑÏû¨ Î∞©Ïãù)</h4>
                    <p style="margin-bottom: 0.5rem;">‚ë† ÌïòÎã®Ïùò <strong>"üíæ Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏åÏóê Ï†ÄÏû•"</strong> Î≤ÑÌäº ÌÅ¥Î¶≠</p>
                    <p style="margin-bottom: 0.5rem;">‚ë° JSON ÌååÏùºÏù¥ ÏûêÎèôÏúºÎ°ú Îã§Ïö¥Î°úÎìúÎê®</p>
                    <p style="margin-bottom: 0.5rem;">‚ë¢ <a href="https://drive.google.com" target="_blank" style="color: var(--accent);">drive.google.com</a> Ï†ëÏÜç</p>
                    <p style="margin-bottom: 0.5rem;">‚ë£ Îã§Ïö¥Î°úÎìúÎêú ÌååÏùºÏùÑ ÎìúÎûòÍ∑∏ÌïòÏó¨ Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏åÏóê ÏóÖÎ°úÎìú</p>
                    <p style="color: var(--text-light); font-size: 0.9rem;">üí° ÌååÏùºÎ™Ö ÏòàÏãú: conference_schedule_20251208_1430.json</p>
                </div>

                <div style="background: var(--bg); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <h4 style="color: var(--accent); margin-bottom: 0.5rem;">2Ô∏è‚É£ ÌååÏùºÏóêÏÑú Î∂àÎü¨Ïò§Í∏∞ (ÌòÑÏû¨ Î∞©Ïãù)</h4>
                    <p style="margin-bottom: 0.5rem;">‚ë† Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏åÏóêÏÑú JSON ÌååÏùº Îã§Ïö¥Î°úÎìú</p>
                    <p style="margin-bottom: 0.5rem;">‚ë° ÌïòÎã®Ïùò <strong>"üìÇ ÌååÏùºÏóêÏÑú Î∂àÎü¨Ïò§Í∏∞"</strong> Î≤ÑÌäº ÌÅ¥Î¶≠</p>
                    <p style="margin-bottom: 0.5rem;">‚ë¢ Îã§Ïö¥Î°úÎìúÌïú JSON ÌååÏùº ÏÑ†ÌÉù</p>
                    <p style="margin-bottom: 0.5rem;">‚ë£ ÌååÏùº Ï†ïÎ≥¥ ÌôïÏù∏ ÌõÑ "ÌôïÏù∏" ÌÅ¥Î¶≠</p>
                    <p style="color: var(--text-light); font-size: 0.9rem;">‚ö†Ô∏è ÌòÑÏû¨ Îç∞Ïù¥ÌÑ∞Í∞Ä ÌååÏùºÏùò Îç∞Ïù¥ÌÑ∞Î°ú ÎçÆÏñ¥ÏîåÏõåÏßëÎãàÎã§!</p>
                </div>

                <div style="background: #E3F2FD; padding: 1rem; border-radius: 8px; border-left: 4px solid #2196F3; margin-bottom: 1rem;">
                    <h4 style="color: #1976D2; margin-bottom: 0.5rem;">üîÆ Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å ÏßÅÏ†ë Ïó∞Îèô (Ï∂îÌõÑ Í∞ÄÎä•)</h4>
                    <p style="margin-bottom: 0.5rem; color: #424242;">ÌòÑÏû¨Îäî <strong>Îã§Ïö¥Î°úÎìú ÌõÑ ÏóÖÎ°úÎìú</strong> Î∞©ÏãùÏûÖÎãàÎã§.</p>
                    <p style="margin-bottom: 0.5rem; color: #424242;">Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏åÏóêÏÑú ÏßÅÏ†ë Î∂àÎü¨Ïò§Î†§Î©¥ <strong>Google Drive API</strong> Ïó∞ÎèôÏù¥ ÌïÑÏöîÌï©ÎãàÎã§:</p>
                    <ul style="margin-left: 1.5rem; margin-top: 0.5rem; color: #424242;">
                        <li>Google Cloud Console ÌîÑÎ°úÏ†ùÌä∏ ÏÉùÏÑ±</li>
                        <li>Drive API ÌôúÏÑ±Ìôî</li>
                        <li>OAuth 2.0 Ïù∏Ï¶ù ÏÑ§Ï†ï</li>
                    </ul>
                    <p style="margin-top: 0.5rem; color: #666; font-size: 0.9rem;">üí° API Ïó∞Îèô Ïãú: "Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏åÏóêÏÑú Î∂àÎü¨Ïò§Í∏∞" Î≤ÑÌäºÏúºÎ°ú ÌååÏùº Î™©Î°ù ÏßÅÏ†ë Ï°∞Ìöå Í∞ÄÎä•</p>
                </div>

                <h3 style="color: var(--primary); margin-top: 1.5rem; margin-bottom: 0.5rem;">üîÑ ÏûêÎèô Ï†ÄÏû•</h3>
                <div style="background: var(--bg); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <p style="margin-bottom: 0.5rem;">‚úÖ Î™®Îì† Î≥ÄÍ≤ΩÏÇ¨Ìï≠ÏùÄ <strong>Î∏åÎùºÏö∞Ï†ÄÏóê ÏûêÎèôÏúºÎ°ú Ï†ÄÏû•</strong>Îê©ÎãàÎã§:</p>
                    <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                        <li>Í∞ïÏùò Ï∂îÍ∞Ä/ÏàòÏ†ï/ÏÇ≠Ï†ú</li>
                        <li>ÏãúÍ∞ÑÌëú Î∞∞Ïπò Î≥ÄÍ≤Ω</li>
                        <li>Ïó∞Ïûê Ï∂îÍ∞Ä/ÏàòÏ†ï/ÏÇ≠Ï†ú</li>
                    </ul>
                    <p style="margin-top: 0.5rem; color: var(--text-light); font-size: 0.9rem;">üí° ÌéòÏù¥ÏßÄÎ•º ÏÉàÎ°úÍ≥†Ïπ®ÌïòÍ±∞ÎÇò Î∏åÎùºÏö∞Ï†ÄÎ•º Îã´ÏïÑÎèÑ Îç∞Ïù¥ÌÑ∞Í∞Ä Ïú†ÏßÄÎê©ÎãàÎã§!</p>
                </div>

                <h3 style="color: var(--primary); margin-top: 1.5rem; margin-bottom: 0.5rem;">üë• Ïó∞Ïûê Í¥ÄÎ¶¨</h3>
                <div style="background: var(--bg); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <p style="margin-bottom: 0.5rem;"><strong>Ïó∞Ïûê Ï∂îÍ∞Ä:</strong> Ïó∞ÏûêÎ™Ö(ÌïúÍ∏Ä), Ïó∞ÏûêÎ™Ö(ÏòÅÎ¨∏), ÏÜåÏÜç(ÌïúÍ∏Ä), ÏÜåÏÜç(ÏòÅÎ¨∏) ÏûÖÎ†•</p>
                    <p style="margin-bottom: 0.5rem;"><strong>Ïó∞Ïûê Í≤ÄÏÉâ:</strong> Ïù¥Î¶Ñ ÎòêÎäî ÏÜåÏÜçÏúºÎ°ú Ïã§ÏãúÍ∞Ñ Í≤ÄÏÉâ</p>
                    <p style="margin-bottom: 0.5rem;"><strong>Ï†ïÎ†¨:</strong> Í∞ÄÎÇòÎã§Ïàú, ABCÏàú, ÏÜåÏÜçÏàú, ÏµúÍ∑º Ï∂îÍ∞ÄÏàú</p>
                    <p style="color: var(--text-light); font-size: 0.9rem;">üí° Í∞ïÏùò ÏûÖÎ†• Ïãú Ïó∞ÏûêÎ•º ÏÑ†ÌÉùÌïòÎ©¥ ÏòÅÎ¨∏Î™ÖÍ≥º ÏÜåÏÜçÏù¥ ÏûêÎèô ÏûÖÎ†•Îê©ÎãàÎã§!</p>
                </div>

                <h3 style="color: var(--primary); margin-top: 1.5rem; margin-bottom: 0.5rem;">üìù Í∞ïÏùò Ï∂îÍ∞Ä</h3>
                <div style="background: var(--bg); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <p style="margin-bottom: 0.5rem;">‚ë† Î∂ÑÎ•ò ÏÑ†ÌÉù (25Í∞ú Ïπ¥ÌÖåÍ≥†Î¶¨)</p>
                    <p style="margin-bottom: 0.5rem;">‚ë° Ï†úÎ™© ÏûÖÎ†• (ÌïúÍ∏Ä/ÏòÅÎ¨∏)</p>
                    <p style="margin-bottom: 0.5rem;">‚ë¢ Ïó∞Ïûê ÏûÖÎ†• - ÏûêÎèôÏôÑÏÑ± ÌôúÏö©</p>
                    <p style="margin-bottom: 0.5rem;">‚ë£ "Í∞ïÏùò Ï∂îÍ∞Ä" Î≤ÑÌäº ÌÅ¥Î¶≠</p>
                    <p style="color: var(--text-light); font-size: 0.9rem;">üí° Îì±Î°ùÎêòÏßÄ ÏïäÏùÄ Ïó∞ÏûêÎäî ÏûêÎèôÏúºÎ°ú Ï∂îÍ∞ÄÌï†ÏßÄ Î¨ºÏñ¥Î¥ÖÎãàÎã§!</p>
                </div>

                <h3 style="color: var(--primary); margin-top: 1.5rem; margin-bottom: 0.5rem;">üóìÔ∏è ÏãúÍ∞ÑÌëú Î∞∞Ïπò</h3>
                <div style="background: var(--bg); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <p style="margin-bottom: 0.5rem;">‚ë† Í∞ïÏùò Î™©Î°ùÏóêÏÑú Í∞ïÏùòÎ•º <strong>ÎìúÎûòÍ∑∏</strong></p>
                    <p style="margin-bottom: 0.5rem;">‚ë° ÏõêÌïòÎäî ÏãúÍ∞Ñ/Î£∏Ïóê <strong>ÎìúÎ°≠</strong></p>
                    <p style="margin-bottom: 0.5rem;">‚ë¢ Î∞∞ÏπòÎêú Í∞ïÏùòÎ•º ÎçîÎ∏îÌÅ¥Î¶≠ÌïòÏó¨ ÏàòÏ†ï</p>
                    <p style="margin-bottom: 0.5rem;">‚ë£ √ó Î≤ÑÌäºÏúºÎ°ú ÏãúÍ∞ÑÌëúÏóêÏÑú Ï†úÍ±∞</p>
                </div>

                <h3 style="color: var(--primary); margin-top: 1.5rem; margin-bottom: 0.5rem;">‚ö†Ô∏è Ï£ºÏùòÏÇ¨Ìï≠</h3>
                <div style="background: #FFF3CD; padding: 1rem; border-radius: 8px; border-left: 4px solid #FFC107;">
                    <p style="margin-bottom: 0.5rem;"><strong>Î∏åÎùºÏö∞Ï†Ä Ï∫êÏãúÎ•º ÏÇ≠Ï†úÌïòÎ©¥ Î°úÏª¨ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏÇ¨ÎùºÏßëÎãàÎã§!</strong></p>
                    <p style="margin-bottom: 0.5rem;">‚Üí Ï†ïÍ∏∞Ï†ÅÏúºÎ°ú Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏åÏóê Î∞±ÏóÖÌïòÏÑ∏Ïöî</p>
                    <p style="margin-top: 0.5rem;"><strong>Îã§Î•∏ Ïª¥Ìì®ÌÑ∞ÏóêÏÑú ÏûëÏóÖÌïòÎ†§Î©¥:</strong></p>
                    <p style="margin-left: 1rem;">‚ë† Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏åÏóê Ï†ÄÏû•</p>
                    <p style="margin-left: 1rem;">‚ë° Îã§Î•∏ Ïª¥Ìì®ÌÑ∞ÏóêÏÑú ÌååÏùº Îã§Ïö¥Î°úÎìú</p>
                    <p style="margin-left: 1rem;">‚ë¢ ÌååÏùºÏóêÏÑú Î∂àÎü¨Ïò§Í∏∞</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å ÌååÏùº Î™©Î°ù Î™®Îã¨ -->
    <div class="modal" id="driveFilesModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2>‚òÅÔ∏è Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏åÏóêÏÑú Î∂àÎü¨Ïò§Í∏∞</h2>
                <button class="modal-close" onclick="closeDriveFilesModal()">√ó</button>
            </div>
            
            <div id="driveFilesList" style="max-height: 400px; overflow-y: auto;">
                <p style="text-align: center; padding: 2rem; color: var(--text-light);">ÌååÏùº Î™©Î°ùÏùÑ Î∂àÎü¨Ïò§Îäî Ï§ë...</p>
            </div>
        </div>
    </div>

    <!-- ÏÇ¨Ïö©Ïûê Í¥ÄÎ¶¨ Î™®Îã¨ -->
    <div class="modal" id="userManagementModal">
        <div class="modal-content" style="max-width: 550px;">
            <div class="modal-header">
                <h2>üë• ÏÇ¨Ïö©Ïûê Í¥ÄÎ¶¨</h2>
                <button class="modal-close" onclick="closeUserManagementModal()">√ó</button>
            </div>
            
            <div style="padding: 1rem;">
                <!-- ÏäπÏù∏ ÎåÄÍ∏∞ ÏÑπÏÖò -->
                <div class="user-section">
                    <div class="user-section-title">
                        üîî ÏäπÏù∏ ÎåÄÍ∏∞
                        <span class="count" id="pendingCount">0Î™Ö</span>
                    </div>
                    <div class="user-list" id="pendingUsersList">
                        <p style="color:#999; text-align:center; padding:1rem;">Î°úÎî© Ï§ë...</p>
                    </div>
                </div>
                
                <!-- ÏäπÏù∏Îêú ÏÇ¨Ïö©Ïûê ÏÑπÏÖò -->
                <div class="user-section">
                    <div class="user-section-title">
                        ‚úÖ ÏäπÏù∏Îêú ÏÇ¨Ïö©Ïûê
                        <span class="count" id="approvedCount">0Î™Ö</span>
                    </div>
                    <div class="user-list" id="approvedUsersList">
                        <p style="color:#999; text-align:center; padding:1rem;">Î°úÎî© Ï§ë...</p>
                    </div>
                </div>
                
                <div style="margin-top: 1rem; padding: 1rem; background: #f0f7ff; border-radius: 8px; font-size: 0.85rem;">
                    <strong>üí° Í∂åÌïú ÏïàÎÇ¥</strong><br>
                    <span style="color:#f39c12;">üëë Í¥ÄÎ¶¨Ïûê</span>: Î™®Îì† Í∏∞Îä• + ÏÇ¨Ïö©Ïûê Í¥ÄÎ¶¨<br>
                    <span style="color:#27ae60;">‚úèÔ∏è Ìé∏ÏßëÏûê</span>: Í∞ïÏùò/ÏãúÍ∞ÑÌëú Ìé∏Ïßë Í∞ÄÎä•<br>
                    <span style="color:#e74c3c;">‚è≥ ÎåÄÍ∏∞Ï§ë</span>: Î≥¥Í∏∞Îßå Í∞ÄÎä• (ÏäπÏù∏ ÌïÑÏöî)
                </div>
            </div>
        </div>
    </div>

    <!-- Î∞±ÏóÖ Í¥ÄÎ¶¨ Î™®Îã¨ -->
    <div class="modal" id="backupModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2>üíæ Î∞±ÏóÖ Í¥ÄÎ¶¨</h2>
                <button class="modal-close" onclick="closeBackupModal()">√ó</button>
            </div>
            
            <div style="padding: 1rem;">
                <div style="display:flex; gap:0.5rem; margin-bottom:1rem;">
                    <button class="btn btn-primary" onclick="createBackup()" style="flex:1;">‚ûï ÏÉà Î∞±ÏóÖ ÏÉùÏÑ±</button>
                </div>
                
                <div class="backup-list-container">
                    <h4 style="margin-bottom:0.5rem; color:var(--primary);">üìÅ Ï†ÄÏû•Îêú Î∞±ÏóÖ</h4>
                    <div id="backupList" style="max-height:300px; overflow-y:auto;">
                        <p style="text-align:center; color:#999;">Î°úÎî© Ï§ë...</p>
                    </div>
                </div>
                
                <div style="margin-top:1rem; padding:0.75rem; background:#fff3cd; border-radius:8px; font-size:0.8rem;">
                    ‚ö†Ô∏è Î≥µÏõê Ïãú ÌòÑÏû¨ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏûêÎèôÏúºÎ°ú Î∞±ÏóÖÎê©ÎãàÎã§.
                </div>
            </div>
        </div>
    </div>

    <!-- Google API ÏÑ§Ï†ï Î™®Îã¨ -->
    <div class="modal" id="apiSetupModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2>‚öôÔ∏è Google API ÏÑ§Ï†ï</h2>
                <button class="modal-close" onclick="closeApiSetupModal()">√ó</button>
            </div>
            
            <div style="padding: 1rem;">
                <div style="background: #FFF3CD; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <p style="margin-bottom: 0.5rem;"><strong>‚ö†Ô∏è Google API ÌÇ§Í∞Ä ÏÑ§Ï†ïÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.</strong></p>
                    <p style="font-size: 0.9rem;">Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞ÎèôÏùÑ ÏúÑÌï¥ API ÌÇ§Î•º ÏÑ§Ï†ïÌï¥Ï£ºÏÑ∏Ïöî.</p>
                </div>

                <div class="form-group" style="margin-bottom: 1rem;">
                    <label>Client ID</label>
                    <input type="text" id="apiClientId" placeholder="xxxx.apps.googleusercontent.com" style="width: 100%;">
                </div>

                <div class="form-group" style="margin-bottom: 1rem;">
                    <label>API Key</label>
                    <input type="text" id="apiKey" placeholder="AIzaSy..." style="width: 100%;">
                </div>

                <button class="btn btn-primary" onclick="saveApiSettings()" style="width: 100%;">Ï†ÄÏû• Î∞è Ïó∞Í≤∞</button>

                <div style="margin-top: 1.5rem; padding: 1rem; background: var(--bg); border-radius: 8px;">
                    <h4 style="margin-bottom: 0.5rem;">üìñ API ÌÇ§ Î∞úÍ∏â Î∞©Î≤ï:</h4>
                    <ol style="margin-left: 1.5rem; font-size: 0.9rem;">
                        <li><a href="https://console.cloud.google.com" target="_blank" style="color: var(--accent);">Google Cloud Console</a> Ï†ëÏÜç</li>
                        <li>ÏÉà ÌîÑÎ°úÏ†ùÌä∏ ÏÉùÏÑ±</li>
                        <li>API ÎùºÏù¥Î∏åÎü¨Î¶¨ ‚Üí "Google Drive API" ÌôúÏÑ±Ìôî</li>
                        <li>ÏÇ¨Ïö©Ïûê Ïù∏Ï¶ù Ï†ïÎ≥¥ ‚Üí OAuth 2.0 ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ ID ÏÉùÏÑ±</li>
                        <li>API ÌÇ§ ÏÉùÏÑ±</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <!-- Í∞ïÏùò ÏùºÍ¥Ñ ÏóÖÎ°úÎìú Î™®Îã¨ -->
    <div class="modal" id="uploadModal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2>üì§ Í∞ïÏùò ÏùºÍ¥Ñ ÏóÖÎ°úÎìú</h2>
                <button class="modal-close" onclick="closeUploadModal()">√ó</button>
            </div>
            
            <div style="padding: 1rem;">
                <div style="background: #E8F4FD; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <p style="margin-bottom: 0.5rem;"><strong>üìã Í∞ïÏùò Î™©Î°ù ÌååÏùº ÏóÖÎ°úÎìú</strong></p>
                    <p style="font-size: 0.85rem; color: #666;">ÏßÄÏõê ÌòïÏãù: Excel (.xlsx, .xls), CSV (.csv)</p>
                    <p style="font-size: 0.85rem; color: #666; margin-top: 0.25rem;">ÌïÑÏàò Ïª¨Îüº: Ï†úÎ™©(Íµ≠Î¨∏) ÎòêÎäî Ï†úÎ™©, Ïó∞ÏûêÎ™Ö ÎòêÎäî Ïó∞Ïûê</p>
                    <p style="font-size: 0.85rem; color: #666; margin-top: 0.25rem;">ÏÑ†ÌÉù Ïª¨Îüº: Î∂ÑÎ•ò, Ï†úÎ™©(ÏòÅÎ¨∏), Î≥ëÏõêÎ™Ö, Í∞ïÏùòÏãúÍ∞Ñ</p>
                </div>
                
                <div style="background: #FFF3E0; padding: 0.75rem; border-radius: 8px; margin-bottom: 1rem;">
                    <p style="font-size: 0.85rem; color: #E65100;">
                        ‚ö†Ô∏è <strong>Ï£ºÏùò:</strong> Ïù¥ Í∏∞Îä•ÏùÄ Ï†ÑÏ≤¥ Í∞ïÏùò Î™©Î°ùÏùÑ Ìïú Î≤àÏóê Îì±Î°ùÌïòÎäî Ïö©ÎèÑÏûÖÎãàÎã§.<br>
                        ÏóÖÎ°úÎìú ÌõÑ ÏãúÍ∞ÑÌëú Î∞∞ÏπòÎäî ÎìúÎûòÍ∑∏ Ïï§ ÎìúÎ°≠ÏúºÎ°ú ÏßÑÌñâÌïòÏÑ∏Ïöî.
                    </p>
                </div>
                
                <div style="border: 2px dashed var(--border); border-radius: 12px; padding: 2rem; text-align: center; margin-bottom: 1rem; background: var(--bg);" id="dropZone">
                    <div style="font-size: 3rem; margin-bottom: 0.5rem;">üìÅ</div>
                    <p style="margin-bottom: 1rem;">ÌååÏùºÏùÑ Ïó¨Í∏∞Ïóê ÎìúÎûòÍ∑∏ÌïòÍ±∞ÎÇò ÌÅ¥Î¶≠ÌïòÏó¨ ÏÑ†ÌÉù</p>
                    <input type="file" id="uploadFileInput" accept=".xlsx,.xls,.csv" style="display: none;" onchange="handleFileSelect(event)">
                    <button class="btn btn-primary" id="selectFileBtn" onclick="document.getElementById('uploadFileInput').click()">ÌååÏùº ÏÑ†ÌÉù</button>
                </div>
                
                <!-- ÎØ∏Î¶¨Î≥¥Í∏∞ ÏòÅÏó≠ -->
                <div id="uploadPreview" style="display: none;">
                    <!-- Ï§ëÎ≥µ Í≤ΩÍ≥† Î∞∞ÎÑà -->
                    <div id="duplicateWarning" style="display: none; background: #FFF3E0; border: 1px solid #FFB74D; border-radius: 8px; padding: 0.75rem; margin-bottom: 0.75rem;">
                        <span style="color: #E65100; font-weight: 600;">‚ö†Ô∏è <span id="duplicateCount">0</span>Í∞ú Ï§ëÎ≥µ Î∞úÍ≤¨</span>
                        <span style="color: #666; font-size: 0.85rem; margin-left: 0.5rem;">ÎÖ∏ÎûÄÏÉâÏúºÎ°ú ÌëúÏãúÎêú Ìï≠Î™©ÏùÄ Ïù¥ÎØ∏ Ï°¥Ïû¨Ìï©ÎãàÎã§</span>
                    </div>
                    
                    <h4 style="margin-bottom: 0.5rem;">üìä ÎØ∏Î¶¨Î≥¥Í∏∞ (<span id="previewCount">0</span>Í∞ú Í∞ïÏùò)</h4>
                    <div style="max-height: 300px; overflow-y: auto; border: 1px solid var(--border); border-radius: 8px;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 0.8rem;">
                            <thead style="background: var(--primary); color: white; position: sticky; top: 0;">
                                <tr id="previewTableHeader">
                                    <th style="padding: 0.5rem; text-align: left; width: 30px;"></th>
                                    <th style="padding: 0.5rem; text-align: left;">Î∂ÑÎ•ò</th>
                                    <th style="padding: 0.5rem; text-align: left;">Ï†úÎ™©</th>
                                    <th style="padding: 0.5rem; text-align: left;">Ïó∞Ïûê</th>
                                    <th style="padding: 0.5rem; text-align: left;">ÏãúÍ∞Ñ</th>
                                </tr>
                            </thead>
                            <tbody id="previewTableBody"></tbody>
                        </table>
                    </div>
                    
                    <div style="margin-top: 1rem; display: flex; flex-direction: column; gap: 0.5rem;">
                        <label style="display: flex; align-items: center; gap: 0.5rem;">
                            <input type="checkbox" id="appendMode" checked>
                            <span>Í∏∞Ï°¥ Í∞ïÏùòÏóê Ï∂îÍ∞Ä (Ï≤¥ÌÅ¨ Ìï¥Ï†ú Ïãú Ï†ÑÏ≤¥ ÍµêÏ≤¥)</span>
                        </label>
                        <label id="skipDuplicatesLabel" style="display: none; align-items: center; gap: 0.5rem;">
                            <input type="checkbox" id="skipDuplicates" checked>
                            <span>üîÑ Ï§ëÎ≥µ Í∞ïÏùò Í±¥ÎÑàÎõ∞Í∏∞ (<span id="skipDuplicateCount">0</span>Í∞ú)</span>
                        </label>
                    </div>
                    
                    <div style="margin-top: 1rem; display: flex; gap: 0.5rem; justify-content: flex-end;">
                        <button class="btn btn-secondary" onclick="clearUploadPreview()">Ï∑®ÏÜå</button>
                        <button class="btn btn-primary" onclick="confirmUpload()">‚úÖ ÏóÖÎ°úÎìú ÌôïÏ†ï</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="data:text/javascript;base64,<?php echo base64_encode('
        // Ïó∞Ïûê Îç∞Ïù¥ÌÑ∞Îäî Ïó¨Í∏∞Ïóê ÏÇΩÏûÖÎê©ÎãàÎã§
    '); ?>"></script>

    <script>
// Îç∞Ïù¥ÌÑ∞Í∞Ä Îß§Ïö∞ ÌÅ¨ÎØÄÎ°ú Ï∂ïÏïΩÎêú ÌòïÌÉúÎ°úÎßå ÌëúÏãú
const SPEAKERS_DATA_JSON = '[{"name":"Yesin Lae","nameEn":"Yesin Lae","affiliation":"Ïù∏ÎèÑÎÑ§ÏãúÏïÑ","affiliationEn":"Indonesia"}]';

        // ============================================
        // Firebase Ïù∏Ï¶ù Î∞è ÏÇ¨Ïö©Ïûê Í¥ÄÎ¶¨ ÏãúÏä§ÌÖú
        // ============================================
        
        let currentUser = null;
        let currentUserRole = null; // 'admin', 'editor', 'pending', null
        let isOnline = true;
        let lastSyncTime = null;
        let pendingUsersCount = 0;
        
        // ÏµúÏ¥à Í¥ÄÎ¶¨Ïûê Ïù¥Î©îÏùº (Ïù¥ Ïù¥Î©îÏùºÏùÄ Ìï≠ÏÉÅ Í¥ÄÎ¶¨Ïûê)
        const SUPER_ADMIN_EMAIL = 'demire.ykh@gmail.com';
        
        // Google Î°úÍ∑∏Ïù∏
        function signInWithGoogle() {
            const provider = new firebase.auth.GoogleAuthProvider();
            auth.signInWithPopup(provider)
                .then((result) => {
                    console.log('Î°úÍ∑∏Ïù∏ ÏÑ±Í≥µ:', result.user.email);
                    // ÏÇ¨Ïö©Ïûê Îì±Î°ù/ÌôïÏù∏
                    registerOrCheckUser(result.user);
                })
                .catch((error) => {
                    console.error('Î°úÍ∑∏Ïù∏ ÏóêÎü¨:', error);
                    alert('Î°úÍ∑∏Ïù∏ Ïã§Ìå®: ' + error.message);
                });
        }
        
        // Î°úÍ∑∏ÏïÑÏõÉ
        function signOut() {
            auth.signOut().then(() => {
                console.log('Î°úÍ∑∏ÏïÑÏõÉÎê®');
                currentUserRole = null;
            });
        }
        
        // ÏÇ¨Ïö©Ïûê Îì±Î°ù ÎòêÎäî ÌôïÏù∏
        function registerOrCheckUser(user) {
            const userRef = database.ref(`/users/${user.uid}`);
            
            userRef.once('value').then((snapshot) => {
                if (snapshot.exists()) {
                    // Í∏∞Ï°¥ ÏÇ¨Ïö©Ïûê - ÎßàÏßÄÎßâ Ï†ëÏÜç ÏãúÍ∞Ñ ÏóÖÎç∞Ïù¥Ìä∏
                    userRef.update({
                        lastLogin: firebase.database.ServerValue.TIMESTAMP,
                        displayName: user.displayName,
                        photoURL: user.photoURL
                    });
                } else {
                    // ÏÉà ÏÇ¨Ïö©Ïûê Îì±Î°ù
                    const isSuperAdmin = user.email === SUPER_ADMIN_EMAIL;
                    userRef.set({
                        email: user.email,
                        displayName: user.displayName,
                        photoURL: user.photoURL,
                        role: isSuperAdmin ? 'admin' : 'pending', // ÏµúÏ¥à Í¥ÄÎ¶¨Ïûê ÎòêÎäî ÎåÄÍ∏∞
                        createdAt: firebase.database.ServerValue.TIMESTAMP,
                        lastLogin: firebase.database.ServerValue.TIMESTAMP
                    });
                    
                    if (!isSuperAdmin) {
                        console.log('ÏÉà ÏÇ¨Ïö©Ïûê - ÏäπÏù∏ ÎåÄÍ∏∞ Ï§ë');
                    }
                }
            });
        }
        
        // ============================================
        // ÏÑ∏ÏÖò ÌÉÄÏûÑÏïÑÏõÉ (2ÏãúÍ∞Ñ ÏûêÎèô Î°úÍ∑∏ÏïÑÏõÉ)
        // ============================================
        
        const SESSION_TIMEOUT = 2 * 60 * 60 * 1000; // 2ÏãúÍ∞Ñ (Î∞ÄÎ¶¨Ï¥à)
        let sessionTimeoutId = null;
        let lastActivityTime = Date.now();
        
        function resetSessionTimeout() {
            lastActivityTime = Date.now();
            
            if (sessionTimeoutId) {
                clearTimeout(sessionTimeoutId);
            }
            
            sessionTimeoutId = setTimeout(() => {
                if (currentUser) {
                    alert('‚è∞ Î≥¥ÏïàÏùÑ ÏúÑÌï¥ 2ÏãúÍ∞Ñ ÎèôÏïà ÌôúÎèôÏù¥ ÏóÜÏñ¥ ÏûêÎèô Î°úÍ∑∏ÏïÑÏõÉÎê©ÎãàÎã§.');
                    signOut();
                }
            }, SESSION_TIMEOUT);
        }
        
        // ÏÇ¨Ïö©Ïûê ÌôúÎèô Í∞êÏßÄ (ÎßàÏö∞Ïä§, ÌÇ§Î≥¥Îìú, ÌÑ∞Ïπò)
        function setupActivityListeners() {
            const activityEvents = ['mousedown', 'mousemove', 'keydown', 'scroll', 'touchstart', 'click'];
            
            activityEvents.forEach(event => {
                document.addEventListener(event, () => {
                    // ÎßàÏßÄÎßâ ÌôúÎèô ÌõÑ 1Î∂Ñ Ïù¥ÎÇ¥ÏóêÎäî ÌÉÄÏù¥Î®∏ Î¶¨ÏÖãÌïòÏßÄ ÏïäÏùå (ÏÑ±Îä• ÏµúÏ†ÅÌôî)
                    if (Date.now() - lastActivityTime > 60000) {
                        resetSessionTimeout();
                    }
                }, { passive: true });
            });
        }
        
        // ÏÑ∏ÏÖò ÌÉÄÏûÑÏïÑÏõÉ Ï¥àÍ∏∞Ìôî
        setupActivityListeners();
        
        // Ïù∏Ï¶ù ÏÉÅÌÉú Î¶¨Ïä§ÎÑà
        auth.onAuthStateChanged((user) => {
            currentUser = user;
            
            if (user) {
                // Î°úÍ∑∏Ïù∏ ÏÑ±Í≥µ
                document.getElementById('loginOverlay').classList.add('hidden');
                
                // ÏÑ∏ÏÖò ÌÉÄÏûÑÏïÑÏõÉ ÏãúÏûë
                resetSessionTimeout();
                
                // ÏÇ¨Ïö©Ïûê Ïó≠Ìï† Î¶¨Ïä§ÎÑà ÏãúÏûë
                listenToUserRole(user);
                
                // Ïò®ÎùºÏù∏ ÏÉÅÌÉú Îì±Î°ù
                registerOnlinePresence(user);
                
                // Ïã§ÏãúÍ∞Ñ Îç∞Ïù¥ÌÑ∞ Î¶¨Ïä§ÎÑà ÏãúÏûë
                startRealtimeListeners();
                
                // ÏÇ¨Ïö©Ïûê Îì±Î°ù/ÌôïÏù∏
                registerOrCheckUser(user);
                
                console.log('Î°úÍ∑∏Ïù∏Îê®:', user.email);
            } else {
                // Î°úÍ∑∏ÏïÑÏõÉ ÏÉÅÌÉú
                document.getElementById('loginOverlay').classList.remove('hidden');
                currentUserRole = null;
                updateAuthUI(null);
                
                // ÏÑ∏ÏÖò ÌÉÄÏûÑÏïÑÏõÉ Ï†ïÏßÄ
                if (sessionTimeoutId) {
                    clearTimeout(sessionTimeoutId);
                    sessionTimeoutId = null;
                }
            }
        });
        
        // ÏÇ¨Ïö©Ïûê Ïó≠Ìï† Ïã§ÏãúÍ∞Ñ Î¶¨Ïä§ÎÑà
        function listenToUserRole(user) {
            database.ref(`/users/${user.uid}/role`).on('value', (snapshot) => {
                currentUserRole = snapshot.val();
                updateAuthUI(user);
                updatePendingBadge();
                console.log('ÏÇ¨Ïö©Ïûê Ïó≠Ìï†:', currentUserRole);
            });
        }
        
        // Ïù∏Ï¶ù UI ÏóÖÎç∞Ïù¥Ìä∏
        function updateAuthUI(user) {
            const authStatus = document.getElementById('authStatus');
            
            // Í¥ÄÎ¶¨Ïûê Ï†ÑÏö© Î≤ÑÌäºÎì§ (Ï¥àÍ∏∞Ìôî Î≤ÑÌäº)
            const adminOnlyBtns = document.querySelectorAll('.admin-only-btn');
            
            if (user) {
                let roleText = '';
                let roleColor = '';
                
                switch(currentUserRole) {
                    case 'admin':
                        roleText = 'üëë Í¥ÄÎ¶¨Ïûê';
                        roleColor = '#f39c12';
                        // Í¥ÄÎ¶¨Ïûê Ï†ÑÏö© Î≤ÑÌäº ÌëúÏãú
                        adminOnlyBtns.forEach(btn => btn.style.display = '');
                        break;
                    case 'editor':
                        roleText = '‚úèÔ∏è Ìé∏ÏßëÏûê';
                        roleColor = '#27ae60';
                        // Í¥ÄÎ¶¨Ïûê Ï†ÑÏö© Î≤ÑÌäº Ïà®ÍπÄ
                        adminOnlyBtns.forEach(btn => btn.style.display = 'none');
                        break;
                    case 'pending':
                        roleText = '‚è≥ ÏäπÏù∏ÎåÄÍ∏∞';
                        roleColor = '#e74c3c';
                        adminOnlyBtns.forEach(btn => btn.style.display = 'none');
                        break;
                    default:
                        roleText = 'Î°úÎî©...';
                        roleColor = '#999';
                        adminOnlyBtns.forEach(btn => btn.style.display = 'none');
                }
                
                authStatus.innerHTML = `
                    <img class="user-photo" src="${user.photoURL || 'https://via.placeholder.com/28'}" alt="">
                    <span class="user-name">${user.displayName || user.email}</span>
                    <span style="color:${roleColor}; font-size:0.7rem;">${roleText}</span>
                    <button class="logout-btn" onclick="signOut()">Î°úÍ∑∏ÏïÑÏõÉ</button>
                `;
            } else {
                authStatus.innerHTML = `
                    <button class="login-btn" onclick="signInWithGoogle()">
                        üîê Î°úÍ∑∏Ïù∏
                    </button>
                `;
                // Î°úÍ∑∏ÏïÑÏõÉ Ïãú Í¥ÄÎ¶¨Ïûê Î≤ÑÌäº Ïà®ÍπÄ
                adminOnlyBtns.forEach(btn => btn.style.display = 'none');
            }
        }
        
        // Ìé∏Ïßë Í∂åÌïú ÌôïÏù∏
        function canEdit() {
            console.log('canEdit Ï≤¥ÌÅ¨:', { currentUser: !!currentUser, currentUserRole });
            if (!currentUser) {
                return false;
            }
            if (currentUserRole === 'pending') {
                return false;
            }
            // roleÏù¥ ÏïÑÏßÅ Î°úÎìúÎêòÏßÄ ÏïäÏïòÏúºÎ©¥ true Î∞òÌôò (Firebase Í∑úÏπôÏóêÏÑú Ï∞®Îã®Îê®)
            if (!currentUserRole) {
                return true; // ÏùºÎã® ÌóàÏö©, Firebase Í∑úÏπôÏóêÏÑú Ïã§Ï†ú Ï∞®Îã®
            }
            return currentUserRole === 'admin' || currentUserRole === 'editor';
        }
        
        // Ìé∏Ïßë ÏãúÎèÑ Ïãú Í∂åÌïú Ï≤¥ÌÅ¨ (UIÏóêÏÑú Ìò∏Ï∂ú)
        function checkEditPermission() {
            console.log('checkEditPermission:', { currentUser: !!currentUser, currentUserRole });
            
            if (!currentUser) {
                alert('Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.');
                return false;
            }
            if (currentUserRole === 'pending') {
                alert('‚è≥ ÏäπÏù∏ ÎåÄÍ∏∞ Ï§ëÏûÖÎãàÎã§.\nÍ¥ÄÎ¶¨ÏûêÏùò ÏäπÏù∏ ÌõÑ Ìé∏ÏßëÏù¥ Í∞ÄÎä•Ìï©ÎãàÎã§.');
                return false;
            }
            // roleÏù¥ ÏïÑÏßÅ Î°úÎìúÎêòÏßÄ ÏïäÏïòÏñ¥ÎèÑ ÏùºÎã® ÏßÑÌñâ (Firebase Í∑úÏπôÏóêÏÑú Ï∞®Îã®)
            return true;
        }
        
        // Í¥ÄÎ¶¨Ïûê Í∂åÌïú ÌôïÏù∏
        function isAdmin() {
            return currentUserRole === 'admin';
        }
        
        // ÎåÄÍ∏∞ Ï§ëÏù∏ ÏÇ¨Ïö©Ïûê Ïàò Î∞∞ÏßÄ ÏóÖÎç∞Ïù¥Ìä∏
        function updatePendingBadge() {
            if (!isAdmin()) {
                document.getElementById('pendingBadge').style.display = 'none';
                return;
            }
            
            database.ref('/users').orderByChild('role').equalTo('pending').once('value', (snapshot) => {
                const count = snapshot.numChildren();
                const badge = document.getElementById('pendingBadge');
                
                if (count > 0) {
                    badge.textContent = count;
                    badge.style.display = 'flex';
                } else {
                    badge.style.display = 'none';
                }
            });
        }
        
        // ============================================
        // ÏÇ¨Ïö©Ïûê Í¥ÄÎ¶¨ Î™®Îã¨
        // ============================================
        
        function openUserManagementModal() {
            if (!isAdmin()) {
                alert('Í¥ÄÎ¶¨ÏûêÎßå Ï†ëÍ∑ºÌï† Ïàò ÏûàÏäµÎãàÎã§.');
                return;
            }
            
            document.getElementById('userManagementModal').classList.add('active');
            loadUserList();
        }
        
        function closeUserManagementModal() {
            document.getElementById('userManagementModal').classList.remove('active');
        }
        
        function loadUserList() {
            const pendingList = document.getElementById('pendingUsersList');
            const approvedList = document.getElementById('approvedUsersList');
            
            pendingList.innerHTML = '<p style="color:#999; text-align:center;">Î°úÎî© Ï§ë...</p>';
            approvedList.innerHTML = '<p style="color:#999; text-align:center;">Î°úÎî© Ï§ë...</p>';
            
            database.ref('/users').once('value', (snapshot) => {
                const users = snapshot.val() || {};
                
                const pending = [];
                const approved = [];
                
                Object.entries(users).forEach(([uid, user]) => {
                    user.uid = uid;
                    if (user.role === 'pending') {
                        pending.push(user);
                    } else {
                        approved.push(user);
                    }
                });
                
                // Ïπ¥Ïö¥Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
                document.getElementById('pendingCount').textContent = pending.length + 'Î™Ö';
                document.getElementById('approvedCount').textContent = approved.length + 'Î™Ö';
                
                // ÎåÄÍ∏∞ Î™©Î°ù Î†åÎçîÎßÅ
                if (pending.length === 0) {
                    pendingList.innerHTML = '<p style="color:#999; text-align:center; padding:1rem;">ÏäπÏù∏ ÎåÄÍ∏∞ Ï§ëÏù∏ ÏÇ¨Ïö©ÏûêÍ∞Ä ÏóÜÏäµÎãàÎã§.</p>';
                } else {
                    pendingList.innerHTML = pending.map(user => `
                        <div class="user-item pending">
                            <img class="user-item-photo" src="${user.photoURL || 'https://via.placeholder.com/40'}" alt="">
                            <div class="user-item-info">
                                <div class="user-item-name">${user.displayName || 'Ïù¥Î¶Ñ ÏóÜÏùå'}</div>
                                <div class="user-item-email">${user.email}</div>
                                <div class="user-item-date">${formatDate(user.createdAt)} Í∞ÄÏûÖ</div>
                            </div>
                            <div class="user-item-actions">
                                <button class="approve-btn" onclick="approveUser('${user.uid}', 'editor')">‚úÖ ÏäπÏù∏</button>
                                <button class="reject-btn" onclick="rejectUser('${user.uid}')">‚ùå Í±∞Î∂Ä</button>
                            </div>
                        </div>
                    `).join('');
                }
                
                // ÏäπÏù∏Îêú Î™©Î°ù Î†åÎçîÎßÅ
                if (approved.length === 0) {
                    approvedList.innerHTML = '<p style="color:#999; text-align:center; padding:1rem;">ÏäπÏù∏Îêú ÏÇ¨Ïö©ÏûêÍ∞Ä ÏóÜÏäµÎãàÎã§.</p>';
                } else {
                    approvedList.innerHTML = approved.map(user => `
                        <div class="user-item ${user.role}">
                            <img class="user-item-photo" src="${user.photoURL || 'https://via.placeholder.com/40'}" alt="">
                            <div class="user-item-info">
                                <div class="user-item-name">${user.displayName || 'Ïù¥Î¶Ñ ÏóÜÏùå'}</div>
                                <div class="user-item-email">${user.email}</div>
                                <div class="user-item-role ${user.role}">${user.role === 'admin' ? 'üëë Í¥ÄÎ¶¨Ïûê' : '‚úèÔ∏è Ìé∏ÏßëÏûê'}</div>
                            </div>
                            <div class="user-item-actions">
                                ${user.email !== SUPER_ADMIN_EMAIL ? `
                                    <select onchange="changeUserRole('${user.uid}', this.value)" class="role-select">
                                        <option value="editor" ${user.role === 'editor' ? 'selected' : ''}>Ìé∏ÏßëÏûê</option>
                                        <option value="admin" ${user.role === 'admin' ? 'selected' : ''}>Í¥ÄÎ¶¨Ïûê</option>
                                    </select>
                                    <button class="remove-btn" onclick="removeUser('${user.uid}', '${user.email}')">üóëÔ∏è</button>
                                ` : '<span style="color:#999; font-size:0.75rem;">ÏµúÏ¥à Í¥ÄÎ¶¨Ïûê</span>'}
                            </div>
                        </div>
                    `).join('');
                }
            });
        }
        
        // ÎÇ†Ïßú Ìè¨Îß∑
        function formatDate(timestamp) {
            if (!timestamp) return '';
            const date = new Date(timestamp);
            return `${date.getMonth()+1}/${date.getDate()}`;
        }
        
        // ÏÇ¨Ïö©Ïûê ÏäπÏù∏
        function approveUser(uid, role) {
            database.ref(`/users/${uid}/role`).set(role)
                .then(() => {
                    loadUserList();
                    updatePendingBadge();
                    console.log('ÏÇ¨Ïö©Ïûê ÏäπÏù∏Îê®');
                })
                .catch(err => alert('ÏäπÏù∏ Ïã§Ìå®: ' + err.message));
        }
        
        // ÏÇ¨Ïö©Ïûê Í±∞Î∂Ä (ÏÇ≠Ï†ú)
        function rejectUser(uid) {
            if (!confirm('Ïù¥ ÏÇ¨Ïö©ÏûêÏùò Ï†ëÍ∑ºÏùÑ Í±∞Î∂ÄÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) return;
            
            database.ref(`/users/${uid}`).remove()
                .then(() => {
                    loadUserList();
                    updatePendingBadge();
                    console.log('ÏÇ¨Ïö©Ïûê Í±∞Î∂ÄÎê®');
                })
                .catch(err => alert('Í±∞Î∂Ä Ïã§Ìå®: ' + err.message));
        }
        
        // ÏÇ¨Ïö©Ïûê Ïó≠Ìï† Î≥ÄÍ≤Ω
        function changeUserRole(uid, newRole) {
            database.ref(`/users/${uid}/role`).set(newRole)
                .then(() => {
                    loadUserList();
                    console.log('Ïó≠Ìï† Î≥ÄÍ≤ΩÎê®:', newRole);
                })
                .catch(err => alert('Ïó≠Ìï† Î≥ÄÍ≤Ω Ïã§Ìå®: ' + err.message));
        }
        
        // ÏÇ¨Ïö©Ïûê ÏÇ≠Ï†ú
        function removeUser(uid, email) {
            if (!confirm(`"${email}" ÏÇ¨Ïö©ÏûêÎ•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?\nÎã§Ïãú Î°úÍ∑∏Ïù∏ÌïòÎ©¥ ÏäπÏù∏ ÎåÄÍ∏∞ ÏÉÅÌÉúÎ°ú ÎèåÏïÑÍ∞ëÎãàÎã§.`)) return;
            
            database.ref(`/users/${uid}`).remove()
                .then(() => {
                    loadUserList();
                    console.log('ÏÇ¨Ïö©Ïûê ÏÇ≠Ï†úÎê®');
                })
                .catch(err => alert('ÏÇ≠Ï†ú Ïã§Ìå®: ' + err.message));
        }
        
        // Ïò®ÎùºÏù∏ ÏÉÅÌÉú Îì±Î°ù
        function registerOnlinePresence(user) {
            const userStatusRef = database.ref(`/presence/${user.uid}`);
            const connectedRef = database.ref('.info/connected');
            
            connectedRef.on('value', (snapshot) => {
                if (snapshot.val() === false) {
                    updateSyncStatus('offline');
                    return;
                }
                
                userStatusRef.onDisconnect().remove().then(() => {
                    userStatusRef.set({
                        email: user.email,
                        displayName: user.displayName,
                        photoURL: user.photoURL,
                        lastSeen: firebase.database.ServerValue.TIMESTAMP
                    });
                    updateSyncStatus('synced');
                });
            });
        }
        
        // Ïò®ÎùºÏù∏ ÏÇ¨Ïö©Ïûê Î¶¨Ïä§ÎÑà
        function listenToOnlineUsers() {
            database.ref('/presence').on('value', (snapshot) => {
                const users = snapshot.val() || {};
                const userList = Object.values(users);
                
                const avatarsDiv = document.getElementById('userAvatars');
                const countSpan = document.getElementById('onlineCount');
                
                avatarsDiv.innerHTML = userList.slice(0, 5).map(u => 
                    `<img class="user-avatar" src="${u.photoURL || 'https://via.placeholder.com/24'}" title="${u.displayName || u.email}">`
                ).join('');
                
                countSpan.textContent = `${userList.length}Î™Ö Ï†ëÏÜç`;
            });
        }
        
        // ÎèôÍ∏∞Ìôî ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
        function updateSyncStatus(status, text) {
            const statusDiv = document.getElementById('syncStatus');
            const textSpan = document.getElementById('syncText');
            
            // ÏöîÏÜåÍ∞Ä ÏóÜÏúºÎ©¥ Î¨¥Ïãú
            if (!statusDiv || !textSpan) {
                console.log('syncStatus ÏóÖÎç∞Ïù¥Ìä∏:', status, text);
                return;
            }
            
            statusDiv.className = 'sync-status ' + status;
            
            switch(status) {
                case 'synced':
                    textSpan.textContent = text || 'ÎèôÍ∏∞ÌôîÎê®';
                    break;
                case 'syncing':
                    textSpan.textContent = text || 'Ï†ÄÏû• Ï§ë...';
                    break;
                case 'offline':
                    textSpan.textContent = text || 'Ïò§ÌîÑÎùºÏù∏';
                    break;
                default:
                    textSpan.textContent = text || status;
            }
        }
        
        // ============================================
        // Ïã§ÏãúÍ∞Ñ Îç∞Ïù¥ÌÑ∞ ÎèôÍ∏∞Ìôî
        // ============================================
        
        function startRealtimeListeners() {
            // Ïò®ÎùºÏù∏ ÏÇ¨Ïö©Ïûê Î¶¨Ïä§ÎÑà
            listenToOnlineUsers();
            
            // Í∞ïÏùò Îç∞Ïù¥ÌÑ∞ Î¶¨Ïä§ÎÑà
            database.ref('/data').on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    // ÏÑúÎ≤Ñ Îç∞Ïù¥ÌÑ∞Î°ú Î°úÏª¨ ÏóÖÎç∞Ïù¥Ìä∏
                    if (data.dataByDate) {
                        dataByDate = data.dataByDate;
                    }
                    // speakersÍ∞Ä ÏûàÍ≥† ÎπÑÏñ¥ÏûàÏßÄ ÏïäÏùÄ Í≤ΩÏö∞ÏóêÎßå ÏóÖÎç∞Ïù¥Ìä∏
                    if (data.speakers && data.speakers.length > 0) {
                        speakers = data.speakers;
                    }
                    if (data.categories && data.categories.length > 0) {
                        categories = data.categories;
                    }
                    
                    // ÌòÑÏû¨ ÎÇ†Ïßú Îç∞Ïù¥ÌÑ∞ Î°úÎìú
                    loadDateData(currentDate);
                    
                    // UI ÏóÖÎç∞Ïù¥Ìä∏
                    updateLectureList();
                    updateScheduleDisplay();
                    updateCategoryDropdowns();
                    
                    updateSyncStatus('synced', 'ÎèôÍ∏∞ÌôîÎê®');
                    console.log('Ïã§ÏãúÍ∞Ñ Îç∞Ïù¥ÌÑ∞ ÏàòÏã†');
                } else {
                    // FirebaseÏóê Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏúºÎ©¥ Í∏∞Î≥∏ Îç∞Ïù¥ÌÑ∞Î°ú Ï¥àÍ∏∞Ìôî
                    console.log('FirebaseÏóê Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå - Í∏∞Î≥∏Í∞í ÏÇ¨Ïö©');
                    updateSyncStatus('synced', 'Ï§ÄÎπÑÎê®');
                }
            });
        }
        
        // FirebaseÏóê Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
        function saveToFirebase() {
            if (!canEdit()) {
                console.log('Ìé∏Ïßë Í∂åÌïú ÏóÜÏùå');
                return;
            }
            
            updateSyncStatus('syncing');
            
            // ÌòÑÏû¨ ÎÇ†Ïßú Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
            dataByDate[currentDate] = {
                lectures: lectures,
                schedule: schedule,
                sessions: sessions
            };
            
            const dataToSave = {
                dataByDate: dataByDate,
                speakers: speakers,
                categories: categories,
                lastModified: firebase.database.ServerValue.TIMESTAMP,
                lastModifiedBy: currentUser ? currentUser.email : 'unknown'
            };
            
            database.ref('/data').set(dataToSave)
                .then(() => {
                    updateSyncStatus('synced', 'Ï†ÄÏû•Îê®');
                    console.log('Firebase Ï†ÄÏû• ÏôÑÎ£å');
                })
                .catch((error) => {
                    updateSyncStatus('offline', 'Ï†ÄÏû• Ïã§Ìå®');
                    console.error('Firebase Ï†ÄÏû• Ïã§Ìå®:', error);
                });
        }
        
        // Î∞±ÏóÖ ÏÉùÏÑ±
        function createBackup() {
            if (!canEdit()) {
                alert('Ìé∏Ïßë Í∂åÌïúÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.');
                return;
            }
            
            const now = new Date();
            const backupId = now.toISOString().split('T')[0] + '_' + now.toTimeString().split(' ')[0].replace(/:/g, '-');
            
            // ÌòÑÏû¨ Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
            dataByDate[currentDate] = {
                lectures: lectures,
                schedule: schedule,
                sessions: sessions
            };
            
            const backupData = {
                dataByDate: dataByDate,
                speakers: speakers,
                categories: categories,
                createdAt: firebase.database.ServerValue.TIMESTAMP,
                createdBy: currentUser.email
            };
            
            database.ref(`/backups/${backupId}`).set(backupData)
                .then(() => {
                    alert(`‚úÖ Î∞±ÏóÖÏù¥ ÏÉùÏÑ±ÎêòÏóàÏäµÎãàÎã§.\n\nÎ∞±ÏóÖ ID: ${backupId}`);
                })
                .catch((error) => {
                    alert('Î∞±ÏóÖ ÏÉùÏÑ± Ïã§Ìå®: ' + error.message);
                });
        }
        
        // Î∞±ÏóÖ Î™©Î°ù Î™®Îã¨ Ïó¥Í∏∞
        function openBackupModal() {
            if (!currentUser) {
                alert('Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.');
                return;
            }
            document.getElementById('backupModal').classList.add('active');
            loadBackupList();
        }
        
        function closeBackupModal() {
            document.getElementById('backupModal').classList.remove('active');
        }
        
        // ============================================
        // Í∞ïÏùò ÏùºÍ¥Ñ ÏóÖÎ°úÎìú Í∏∞Îä•
        // ============================================
        
        let pendingUploadData = []; // ÏóÖÎ°úÎìú ÎåÄÍ∏∞ Ï§ëÏù∏ Í∞ïÏùò Îç∞Ïù¥ÌÑ∞
        
        function openUploadModal() {
            if (!canEdit()) {
                alert('Ìé∏Ïßë Í∂åÌïúÏù¥ ÏóÜÏäµÎãàÎã§.');
                return;
            }
            document.getElementById('uploadModal').classList.add('active');
            clearUploadPreview();
            setupDropZone();
        }
        
        function closeUploadModal() {
            document.getElementById('uploadModal').classList.remove('active');
            clearUploadPreview();
        }
        
        function clearUploadPreview() {
            pendingUploadData = [];
            document.getElementById('uploadPreview').style.display = 'none';
            document.getElementById('previewTableBody').innerHTML = '';
            document.getElementById('previewCount').textContent = '0';
            document.getElementById('uploadFileInput').value = '';
            document.getElementById('duplicateWarning').style.display = 'none';
            document.getElementById('skipDuplicatesLabel').style.display = 'none';
        }
        
        function setupDropZone() {
            const dropZone = document.getElementById('dropZone');
            
            // Í∏∞Ï°¥ Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï†úÍ±∞ ÌõÑ Ïû¨ÏÑ§Ï†ï
            const newDropZone = dropZone.cloneNode(true);
            dropZone.parentNode.replaceChild(newDropZone, dropZone);
            
            newDropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                newDropZone.style.borderColor = 'var(--accent)';
                newDropZone.style.background = 'rgba(255, 107, 157, 0.1)';
            });
            
            newDropZone.addEventListener('dragleave', (e) => {
                e.preventDefault();
                newDropZone.style.borderColor = 'var(--border)';
                newDropZone.style.background = 'var(--bg)';
            });
            
            newDropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                newDropZone.style.borderColor = 'var(--border)';
                newDropZone.style.background = 'var(--bg)';
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    processUploadFile(files[0]);
                }
            });
            
            // ÌååÏùº ÏÑ†ÌÉù Î≤ÑÌäº Ïû¨Ïó∞Í≤∞
            const selectBtn = newDropZone.querySelector('#selectFileBtn') || document.getElementById('selectFileBtn');
            if (selectBtn) {
                selectBtn.onclick = () => document.getElementById('uploadFileInput').click();
            }
        }
        
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                processUploadFile(file);
            }
        }
        
        // Ï§ëÎ≥µ Í∞êÏßÄ Ìï®Ïàò
        function detectDuplicates(uploadData) {
            return uploadData.map(newLecture => {
                // Í∏∞Ï°¥ Í∞ïÏùò Î™©Î°ùÏóêÏÑú Ï§ëÎ≥µ Ï≤¥ÌÅ¨
                return lectures.some(existingLecture => {
                    // Ï†úÎ™©Ïù¥ Ïú†ÏÇ¨ÌïúÏßÄ Ï≤¥ÌÅ¨ (Ï†ïÍ∑úÌôî ÌõÑ ÎπÑÍµê)
                    const normalizedNewTitle = normalizeTitle(newLecture.titleKo);
                    const normalizedExistingTitle = normalizeTitle(existingLecture.titleKo);
                    
                    // Ï†úÎ™©Ïù¥ Í∞ôÍ±∞ÎÇò 80% Ïù¥ÏÉÅ Ïú†ÏÇ¨
                    const titleMatch = normalizedNewTitle === normalizedExistingTitle ||
                                      calculateSimilarity(normalizedNewTitle, normalizedExistingTitle) > 0.8;
                    
                    // Ïó∞ÏûêÍ∞Ä Í∞ôÏùÄÏßÄ Ï≤¥ÌÅ¨ (Îπà Í∞íÏù¥Î©¥ Ï†úÎ™©ÎßåÏúºÎ°ú ÌåêÎã®)
                    const speakerMatch = !newLecture.speakerKo || !existingLecture.speakerKo ||
                                        newLecture.speakerKo === existingLecture.speakerKo;
                    
                    return titleMatch && speakerMatch;
                });
            });
        }
        
        // Ï†úÎ™© Ï†ïÍ∑úÌôî (ÎπÑÍµêÎ•º ÏúÑÌï¥)
        function normalizeTitle(title) {
            if (!title) return '';
            return title
                .toLowerCase()
                .replace(/\s+/g, ' ')           // Îã§Ï§ë Í≥µÎ∞± Ï†úÍ±∞
                .replace(/[\n\r]/g, ' ')        // Ï§ÑÎ∞îÍøà Ï†úÍ±∞
                .replace(/[^\w\s„Ñ±-„Öé„Öè-„Ö£Í∞Ä-Ìû£]/g, '') // ÌäπÏàòÎ¨∏Ïûê Ï†úÍ±∞
                .trim();
        }
        
        // Î¨∏ÏûêÏó¥ Ïú†ÏÇ¨ÎèÑ Í≥ÑÏÇ∞ (Levenshtein distance Í∏∞Î∞ò)
        function calculateSimilarity(str1, str2) {
            if (!str1 || !str2) return 0;
            if (str1 === str2) return 1;
            
            const longer = str1.length > str2.length ? str1 : str2;
            const shorter = str1.length > str2.length ? str2 : str1;
            
            if (longer.length === 0) return 1.0;
            
            // Í∞ÑÎã®Ìïú Ïú†ÏÇ¨ÎèÑ: Í≥µÌÜµ Îã®Ïñ¥ ÎπÑÏú®
            const words1 = new Set(str1.split(' '));
            const words2 = new Set(str2.split(' '));
            const intersection = [...words1].filter(w => words2.has(w)).length;
            const union = new Set([...words1, ...words2]).size;
            
            return intersection / union;
        }
        
        function processUploadFile(file) {
            const validExtensions = ['.xlsx', '.xls', '.csv'];
            const fileName = file.name.toLowerCase();
            const isValid = validExtensions.some(ext => fileName.endsWith(ext));
            
            if (!isValid) {
                alert('ÏßÄÏõêÎêòÏßÄ ÏïäÎäî ÌååÏùº ÌòïÏãùÏûÖÎãàÎã§.\nÏßÄÏõê ÌòïÏãù: Excel (.xlsx, .xls), CSV (.csv)');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(firstSheet, { defval: '' });
                    
                    parseAndPreviewData(jsonData);
                } catch (error) {
                    console.error('ÌååÏùº ÌååÏã± Ïò§Î•ò:', error);
                    alert('ÌååÏùºÏùÑ ÏùΩÎäî Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.\n' + error.message);
                }
            };
            reader.readAsArrayBuffer(file);
        }
        
        function parseAndPreviewData(jsonData) {
            // Í∞ïÏùò ÏãúÍ∞Ñ Ïª¨Îüº Îß§Ìïë
            const durationMapping = {
                'Ï†ïÍ∑ú\nÍ∞ïÏùò\n(Ïùº/15Î∂Ñ)': 15,
                'ÏùºÎ∞ò\nÍ∞ïÏùò\n(ÌÜ†/20Î∂Ñ)': 20,
                'Ï∂îÍ∞ÄÍ∞ïÏùò\n(ÌÜ†ÏöîÏùº)': 20,
                'Îü∞Ï≤ú\nÍ∞ïÏùò\n(Ï†ïÍ∑ú/Ïùº)': 20,
                'Îü∞Ï≤ú\nÍ∞ïÏùò\n(ÌÜ†)': 20,
                'ÏùºÎ∞ò\nÍ∞ïÏùò\n(Ïùº/10Î∂Ñ)': 10,
                'Îü∞Ï≤ú\nÍ∞ïÏùò\n(Ïùº/20Î∂Ñ)': 20,
                'Îü∞Ï≤ú\nÍ∞ïÏùò\n(ÏùºÎ∞ò/ÌÜ†)': 20,
                'ÏóëÏä§ÌçºÌä∏Ïç®Î∞ã': 30,
                'Ïò§Ìîà\nÎ†âÏ≤ò\n(Ïùº/10Î∂Ñ)': 10
            };
            
            pendingUploadData = [];
            let lastCategory = ''; // Î∂ÑÎ•òÍ∞Ä ÎπÑÏñ¥ÏûàÏùÑ Îïå Ïù¥Ï†Ñ Í∞í ÏÇ¨Ïö©
            
            jsonData.forEach((row, index) => {
                // Ï†úÎ™©Ïù¥ ÏûàÎäî ÌñâÎßå Ï≤òÎ¶¨
                const titleKo = (row['Ï†úÎ™©(Íµ≠Î¨∏)'] || '').toString().trim();
                const titleEn = (row['Ï†úÎ™©(ÏòÅÎ¨∏)'] || '').toString().trim();
                
                if (!titleKo && !titleEn) return;
                if (titleKo === 'ÎØ∏Ï†ï' || titleEn === 'ÎØ∏Ï†ï') return;
                
                // Î∂ÑÎ•ò Ï≤òÎ¶¨ (ÎπÑÏñ¥ÏûàÏúºÎ©¥ Ïù¥Ï†Ñ Í∞í ÏÇ¨Ïö©)
                let category = (row['Î∂ÑÎ•ò'] || '').toString().trim();
                if (category) {
                    lastCategory = category;
                } else {
                    category = lastCategory;
                }
                
                // Í∞ïÏùò ÏãúÍ∞Ñ Í≤∞Ï†ï
                let duration = 15; // Í∏∞Î≥∏Í∞í
                for (const [col, dur] of Object.entries(durationMapping)) {
                    if (row[col] && row[col] !== '' && !isNaN(row[col])) {
                        duration = dur;
                        break;
                    }
                }
                
                const speakerName = (row['Ïó∞Ïûê'] || '').toString().trim();
                const hospitalName = (row['Î≥ëÏõêÎ™Ö'] || '').toString().trim();
                
                // Ïó∞ÏûêÍ∞Ä 'ÎØ∏Ï†ï'Ïù¥Î©¥ Îπà Í∞íÏúºÎ°ú Ï≤òÎ¶¨
                const finalSpeaker = speakerName === 'ÎØ∏Ï†ï' ? '' : speakerName;
                
                const lecture = {
                    id: Date.now() + index,
                    category: category || 'Others',
                    titleKo: titleKo || titleEn,
                    titleEn: titleEn,
                    speakerKo: finalSpeaker,
                    speakerEn: '',
                    affiliation: hospitalName,
                    affiliationEn: '',
                    duration: duration
                };
                
                pendingUploadData.push(lecture);
            });
            
            // ÎØ∏Î¶¨Î≥¥Í∏∞ ÌëúÏãú
            displayUploadPreview();
        }
        
        function displayUploadPreview() {
            if (pendingUploadData.length === 0) {
                alert('ÏóÖÎ°úÎìú Í∞ÄÎä•Ìïú Í∞ïÏùò Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.');
                return;
            }
            
            // Ï§ëÎ≥µ Í∞êÏßÄ
            const duplicates = detectDuplicates(pendingUploadData);
            const duplicateCount = duplicates.filter(d => d).length;
            
            // Ï§ëÎ≥µ Í≤ΩÍ≥† ÌëúÏãú
            document.getElementById('duplicateWarning').style.display = duplicateCount > 0 ? 'block' : 'none';
            document.getElementById('duplicateCount').textContent = duplicateCount;
            document.getElementById('skipDuplicatesLabel').style.display = duplicateCount > 0 ? 'flex' : 'none';
            document.getElementById('skipDuplicateCount').textContent = duplicateCount;
            
            document.getElementById('uploadPreview').style.display = 'block';
            document.getElementById('previewCount').textContent = pendingUploadData.length;
            document.getElementById('previewSessionCount').textContent = '';
            
            // ÌÖåÏù¥Î∏î Ìó§Îçî (Î™©Î°ù Î™®Îìú)
            document.getElementById('previewTableHeader').innerHTML = `
                <th style="padding: 0.5rem; text-align: left; width: 30px;"></th>
                <th style="padding: 0.5rem; text-align: left;">Î∂ÑÎ•ò</th>
                <th style="padding: 0.5rem; text-align: left;">Ï†úÎ™©(Íµ≠Î¨∏)</th>
                <th style="padding: 0.5rem; text-align: left;">Ïó∞Ïûê</th>
                <th style="padding: 0.5rem; text-align: left;">ÏãúÍ∞Ñ</th>
            `;
            
            const tbody = document.getElementById('previewTableBody');
            tbody.innerHTML = pendingUploadData.map((lecture, index) => {
                const isDuplicate = duplicates[index];
                const bgColor = isDuplicate ? '#FFF8E1' : (index % 2 ? '#f9f9f9' : 'white');
                return `
                <tr style="border-bottom: 1px solid var(--border); background: ${bgColor};" data-index="${index}" data-duplicate="${isDuplicate}">
                    <td style="padding: 0.4rem; text-align: center;">
                        ${isDuplicate ? '<span title="Ï§ëÎ≥µ Ìï≠Î™©">üîÑ</span>' : ''}
                    </td>
                    <td style="padding: 0.4rem;">${lecture.category}</td>
                    <td style="padding: 0.4rem;">${lecture.titleKo.substring(0, 40)}${lecture.titleKo.length > 40 ? '...' : ''}</td>
                    <td style="padding: 0.4rem;">${lecture.speakerKo || '-'}</td>
                    <td style="padding: 0.4rem;">${lecture.duration}Î∂Ñ</td>
                </tr>
            `}).join('');
        }
        
        function confirmUpload() {
            if (pendingUploadData.length === 0) {
                alert('ÏóÖÎ°úÎìúÌï† Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.');
                return;
            }
            
            const appendMode = document.getElementById('appendMode').checked;
            const skipDuplicates = document.getElementById('skipDuplicates')?.checked ?? true;
            
            // Ï†ÑÏ≤¥ ÍµêÏ≤¥ Î™®Îìú
            if (!appendMode) {
                if (!confirm(`‚ö†Ô∏è Í∏∞Ï°¥ Í∞ïÏùò ${lectures.length}Í∞úÎ•º Î™®Îëê ÏÇ≠Ï†úÌïòÍ≥† ÏÉàÎ°úÏö¥ ${pendingUploadData.length}Í∞úÎ°ú ÎåÄÏ≤¥Ìï©ÎãàÎã§.\n\n‚ö†Ô∏è ÏãúÍ∞ÑÌëú Î∞∞ÏπòÎèÑ Î™®Îëê Ï¥àÍ∏∞ÌôîÎê©ÎãàÎã§!\n\nÍ≥ÑÏÜçÌïòÏãúÍ≤†ÏäµÎãàÍπå?`)) {
                    return;
                }
                // Í∞ïÏùò Î™©Î°ù Ï¥àÍ∏∞Ìôî
                lectures = [];
                // Î™®Îì† ÎÇ†ÏßúÏùò ÏãúÍ∞ÑÌëúÎèÑ Ï¥àÍ∏∞Ìôî
                Object.keys(dataByDate).forEach(date => {
                    if (dataByDate[date]) {
                        dataByDate[date].lectures = [];
                        dataByDate[date].schedule = {};
                    }
                });
                schedule = {};
            }
            
            // Ï§ëÎ≥µ Í∞êÏßÄ
            const duplicates = detectDuplicates(pendingUploadData);
            let skippedCount = 0;
            let addedCount = 0;
            
            // Í∞ïÏùò ID Ïû¨Ìï†Îãπ (Ï∂©Îèå Î∞©ÏßÄ)
            const baseId = Date.now();
            pendingUploadData.forEach((lecture, index) => {
                // Ï§ëÎ≥µ Í±¥ÎÑàÎõ∞Í∏∞ ÏòµÏÖòÏù¥ ÏºúÏ†∏ÏûàÍ≥†, Ïù¥ Ìï≠Î™©Ïù¥ Ï§ëÎ≥µÏù¥Î©¥ Ïä§ÌÇµ
                if (skipDuplicates && duplicates[index]) {
                    skippedCount++;
                    return;
                }
                
                lecture.id = baseId + addedCount;
                lectures.push(lecture);
                addedCount++;
            });
            
            // ÏÉà Ïπ¥ÌÖåÍ≥†Î¶¨ ÏûêÎèô Ï∂îÍ∞Ä
            const newCategories = [...new Set(pendingUploadData.map(l => l.category))];
            newCategories.forEach(cat => {
                if (cat && !categories.includes(cat)) {
                    categories.push(cat);
                }
            });
            
            // ÏÉà Ïó∞Ïûê ÏûêÎèô Ï∂îÍ∞Ä
            pendingUploadData.forEach(lecture => {
                if (lecture.speakerKo && !speakers.find(s => s.name === lecture.speakerKo)) {
                    speakers.push({
                        name: lecture.speakerKo,
                        nameEn: lecture.speakerEn || '',
                        affiliation: lecture.affiliation || '',
                        affiliationEn: lecture.affiliationEn || ''
                    });
                }
            });
            
            // Í∞ïÏùò Î™©Î°ùÏùÄ Ï†ÑÏó≠Ïù¥ÎØÄÎ°ú Î™®Îì† ÎÇ†ÏßúÏóê ÎèôÏùºÌïòÍ≤å Ï†ÄÏû•
            Object.keys(dataByDate).forEach(date => {
                if (dataByDate[date]) {
                    dataByDate[date].lectures = [...lectures];
                }
            });
            
            // Ï†ÄÏû• Î∞è UI ÏóÖÎç∞Ïù¥Ìä∏
            saveAndSync();
            updateCategoryDropdowns();
            createCategoryFilters();
            updateLectureList();
            
            // Í≤∞Í≥º Î©îÏãúÏßÄ
            let message = `‚úÖ ${addedCount}Í∞ú Í∞ïÏùòÍ∞Ä ${appendMode ? 'Ï∂îÍ∞Ä' : 'ÏóÖÎ°úÎìú'}ÎêòÏóàÏäµÎãàÎã§!`;
            if (skippedCount > 0) {
                message += `\n\nüîÑ ${skippedCount}Í∞ú Ï§ëÎ≥µ Ìï≠Î™©ÏùÄ Í±¥ÎÑàÎõ∞ÏóàÏäµÎãàÎã§.`;
            }
            alert(message);
            
            closeUploadModal();
        }
        
        // Î∞±ÏóÖ Î™©Î°ù Î∂àÎü¨Ïò§Í∏∞
        function loadBackupList() {
            const list = document.getElementById('backupList');
            list.innerHTML = '<p style="text-align:center; color:#999;">Î°úÎî© Ï§ë...</p>';
            
            database.ref('/backups').orderByChild('createdAt').limitToLast(20).once('value', (snapshot) => {
                const backups = [];
                snapshot.forEach((child) => {
                    backups.push({ id: child.key, ...child.val() });
                });
                
                backups.reverse(); // ÏµúÏã†Ïàú
                
                if (backups.length === 0) {
                    list.innerHTML = '<p style="text-align:center; color:#999; padding:2rem;">Ï†ÄÏû•Îêú Î∞±ÏóÖÏù¥ ÏóÜÏäµÎãàÎã§.</p>';
                    return;
                }
                
                list.innerHTML = backups.map(backup => `
                    <div class="backup-item">
                        <div class="backup-info">
                            <div class="backup-id">üìÅ ${backup.id}</div>
                            <div class="backup-meta">${backup.createdBy} ¬∑ ${formatDateTime(backup.createdAt)}</div>
                        </div>
                        <div class="backup-actions">
                            <button class="btn btn-small btn-primary" onclick="restoreBackup('${backup.id}')">Î≥µÏõê</button>
                            <button class="btn btn-small btn-secondary" onclick="deleteBackup('${backup.id}')">ÏÇ≠Ï†ú</button>
                        </div>
                    </div>
                `).join('');
            });
        }
        
        // ÎÇ†ÏßúÏãúÍ∞Ñ Ìè¨Îß∑
        function formatDateTime(timestamp) {
            if (!timestamp) return '';
            const date = new Date(timestamp);
            return `${date.getMonth()+1}/${date.getDate()} ${date.getHours()}:${String(date.getMinutes()).padStart(2,'0')}`;
        }
        
        // Î∞±ÏóÖ Î≥µÏõê
        function restoreBackup(backupId) {
            if (!canEdit()) {
                alert('Ìé∏Ïßë Í∂åÌïúÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.');
                return;
            }
            
            if (!confirm(`"${backupId}" Î∞±ÏóÖÏùÑ Î≥µÏõêÌïòÏãúÍ≤†ÏäµÎãàÍπå?\n\nÌòÑÏû¨ Îç∞Ïù¥ÌÑ∞Í∞Ä Î∞±ÏóÖ Îç∞Ïù¥ÌÑ∞Î°ú ÎåÄÏ≤¥Îê©ÎãàÎã§.`)) {
                return;
            }
            
            database.ref(`/backups/${backupId}`).once('value', (snapshot) => {
                const backup = snapshot.val();
                if (!backup) {
                    alert('Î∞±ÏóÖÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                    return;
                }
                
                // Î≥µÏõê Ï†Ñ ÌòÑÏû¨ Îç∞Ïù¥ÌÑ∞ ÏûêÎèô Î∞±ÏóÖ
                const autoBackupId = 'auto_before_restore_' + new Date().toISOString().replace(/[:.]/g, '-');
                dataByDate[currentDate] = { lectures, schedule, sessions };
                database.ref(`/backups/${autoBackupId}`).set({
                    dataByDate: dataByDate,
                    speakers: speakers,
                    categories: categories,
                    createdAt: firebase.database.ServerValue.TIMESTAMP,
                    createdBy: currentUser.email + ' (ÏûêÎèôÎ∞±ÏóÖ)'
                });
                
                // Îç∞Ïù¥ÌÑ∞ Î≥µÏõê
                const dataToRestore = {
                    dataByDate: backup.dataByDate || {},
                    speakers: backup.speakers || [],
                    categories: backup.categories || [],
                    lastModified: firebase.database.ServerValue.TIMESTAMP,
                    lastModifiedBy: currentUser.email + ' (Î≥µÏõê)'
                };
                
                database.ref('/data').set(dataToRestore)
                    .then(() => {
                        alert('‚úÖ Î∞±ÏóÖÏù¥ Î≥µÏõêÎêòÏóàÏäµÎãàÎã§.');
                        closeBackupModal();
                    })
                    .catch(err => alert('Î≥µÏõê Ïã§Ìå®: ' + err.message));
            });
        }
        
        // Î∞±ÏóÖ ÏÇ≠Ï†ú
        function deleteBackup(backupId) {
            if (!isAdmin()) {
                alert('Í¥ÄÎ¶¨ÏûêÎßå Î∞±ÏóÖÏùÑ ÏÇ≠Ï†úÌï† Ïàò ÏûàÏäµÎãàÎã§.');
                return;
            }
            
            if (!confirm(`"${backupId}" Î∞±ÏóÖÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?`)) return;
            
            database.ref(`/backups/${backupId}`).remove()
                .then(() => {
                    loadBackupList();
                })
                .catch(err => alert('ÏÇ≠Ï†ú Ïã§Ìå®: ' + err.message));
        }
        
        // Í∏∞Ï°¥ saveAndSyncÎ•º Firebase Ï†ÄÏû•ÏúºÎ°ú Î≥ÄÍ≤Ω
        function saveAndSync() {
            saveCurrentDateData(); // Î®ºÏ†Ä Î°úÏª¨ Ï†ÄÏû•
            saveToFirebase(); // FirebaseÏóê Ï†ÄÏû•
        }
        
        // ÌòÑÏû¨ ÎÇ†Ïßú Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• (Î°úÏª¨ + Firebase)
        function saveCurrentDateData() {
            dataByDate[currentDate] = {
                lectures: [...lectures],
                schedule: {...schedule},
                sessions: [...sessions]
            };
            saveAllDataToStorage(); // Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄÏóêÎèÑ Ï†ÄÏû•
            saveToFirebase();
        }

        // ============================================
        // ÎÇ†ÏßúÎ≥Ñ ÏÑ§Ï†ï
        // ============================================
        const CONFERENCE_DATES = [
            { date: '2026-04-11', label: 'ÌÜ†ÏöîÏùº (4/11)', day: 'sat' },
            { date: '2026-04-12', label: 'ÏùºÏöîÏùº (4/12)', day: 'sun' }
        ];
        
        // ÎÇ†ÏßúÎ≥Ñ Î£∏ ÏÑ§Ï†ï
        const ROOMS_BY_DATE = {
            '2026-04-11': [ // ÌÜ†ÏöîÏùº
                '(ÌÜ†)1Ï∏µ Ï†ÑÏãúÏû•A Combination Lab',
                '(ÌÜ†)1Ï∏µ Ï†ÑÏãúÏû•B Regional Blueprint',
                '(ÌÜ†)4Ï∏µ NextWave Insight',
                '(ÌÜ†)4Ï∏µ Scientific Forum',
                '(ÌÜ†)4Ï∏µ International Session - Indonesia',
                '(ÌÜ†)4Ï∏µ International Session - Philippines',
                '(ÌÜ†)3Ï∏µ Injectables Studio(LIVE)',
                '(ÌÜ†)3Ï∏µ Í∞úÏõêÎ∞©'
            ],
            '2026-04-12': [ // ÏùºÏöîÏùº
                '(Ïùº)1Ï∏µ Ï†ÑÏãúÏû•A Combination Lab',
                '(Ïùº)1Ï∏µ Ï†ÑÏãúÏû•B Regional Blueprint',
                '(Ïùº)4Ï∏µ LASER Suite',
                '(Ïùº)4Ï∏µ Injectables Forum',
                '(Ïùº)4Ï∏µ Regeneration Matrix',
                '(Ïùº)4Ï∏µ Contour Mapping',
                '(Ïùº)4Ï∏µ Body Metabolic Lab',
                '(Ïùº)4Ï∏µ Surgical Theater',
                '(Ïùº)3Ï∏µ LASER Studio(LIVE)',
                '(Ïùº)Openlecture1',
                '(Ïùº)Openlecture2'
            ]
        };
        
        let currentDate = '2026-04-11'; // ÌòÑÏû¨ ÏÑ†ÌÉùÎêú ÎÇ†Ïßú
        let rooms = ROOMS_BY_DATE[currentDate];
        
        // ÎÇ†ÏßúÎ≥Ñ Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•ÏÜå
        let dataByDate = {
            '2026-04-11': { lectures: [], schedule: {}, sessions: [] },
            '2026-04-12': { lectures: [], schedule: {}, sessions: [] }
        };
        
const SPEAKERS_DATA = JSON.parse('[{"name":"Yesin Lae","nameEn":"Yesin Lae","affiliation":"Ïù∏ÎèÑÎÑ§ÏãúÏïÑ","affiliationEn":"Indonesia"},{"name":"Ting Song Lim","nameEn":"Ting Song Lim","affiliation":"Malaysia","affiliationEn":"Malaysia"},{"name":"Thanya Techapichetvanich","nameEn":"Thanya Techapichetvanich","affiliation":"ÌÉúÍµ≠","affiliationEn":"Thailand"},{"name":"Sky Wong","nameEn":"Sky Wong","affiliation":"HongKong","affiliationEn":"HongKong"},{"name":"Rungsima Wanitphakdeedecha","nameEn":"Rungsima Wanitphakdeedecha","affiliation":"ÌÉúÍµ≠","affiliationEn":"Thailand"},{"name":"Rosario Abaya Blas","nameEn":"Rosario Abaya Blas","affiliation":"ÌïÑÎ¶¨ÌïÄ","affiliationEn":"Philippines"},{"name":"Raheleh Sarbaziha","nameEn":"Raheleh Sarbaziha","affiliation":"USA","affiliationEn":"USA"},{"name":"Prof. Beomjoon Kim","nameEn":"Prof. Beomjoon Kim","affiliation":"Japan","affiliationEn":"Japan"},{"name":"Paul Han","nameEn":"Paul Han","affiliation":"Australia","affiliationEn":"Australia"},{"name":"Nguyen Thi Thu Trang","nameEn":"Nguyen Thi Thu Trang","affiliation":"Vietnam","affiliationEn":"Vietnam"},{"name":"Joelle Lieman","nameEn":"Joelle Lieman","affiliation":"USA","affiliationEn":"USA"},{"name":"Inigo de Felipe","nameEn":"Inigo de Felipe","affiliation":"Spain","affiliationEn":"Spain"},{"name":"Glynis Ablon","nameEn":"Glynis Ablon","affiliation":"ÎØ∏Íµ≠","affiliationEn":"USA"},{"name":"Elina Theodorakopoulou","nameEn":"Elina Theodorakopoulou","affiliation":"Greece","affiliationEn":"Greece"},{"name":"Yoshiuki Aikawa","nameEn":"Yoshiuki Aikawa","affiliation":"SBC (Shonan Beauty Clinic)","affiliationEn":"SBC (Shonan Beauty Clinic)"},{"name":"Shoko Takahashi","nameEn":"Shoko Takahashi","affiliation":"SBC (Shonan Beauty Clinic)","affiliationEn":"SBC (Shonan Beauty Clinic)"},{"name":"SAAMI KHALIFIAN","nameEn":"SAAMI KHALIFIAN","affiliation":"USA","affiliationEn":"USA"},{"name":"MARK DEUBER","nameEn":"MARK DEUBER","affiliation":"USA","affiliationEn":"USA"},{"name":"Contessa Salvador","nameEn":"Contessa Salvador","affiliation":"Philippines","affiliationEn":"Philippines"},{"name":"Ayaka Nishikawa","nameEn":"Ayaka Nishikawa","affiliation":"SBC (Shonan Beauty Clinic)","affiliationEn":"SBC (Shonan Beauty Clinic)"},{"name":"Ai Mitsui","nameEn":"Ai Mitsui","affiliation":"SBC (Shonan Beauty Clinic)","affiliationEn":"SBC (Shonan Beauty Clinic)"},{"name":"Chia Chi Kao","nameEn":"Chia Chi Kao","affiliation":"USA","affiliationEn":"USA"},{"name":"Atinuch Doungkaew","nameEn":"Atinuch Doungkaew","affiliation":"Thailand","affiliationEn":"Thailand"},{"name":"Almond Wibowo","nameEn":"Almond Wibowo","affiliation":"Ïù∏ÎèÑÎÑ§ÏãúÏïÑ","affiliationEn":"Indonesia"},{"name":"Ìô©Ï†úÏôÑ","nameEn":"Hwang Je-wan","affiliation":"Î©îÏù¥Î¶∞ÏùòÏõê ÎçîÌòÑÎåÄ ÎåÄÍµ¨","affiliationEn":"Mayline Clinic"},{"name":"Ìô©Ïö©Ìò∏","nameEn":"Hwang Yong-ho","affiliation":"Ïõ∞Ïä§ÌÇ®ÏùòÏõê","affiliationEn":"Wellskin Clinic"},{"name":"ÌôçÌïúÎπõ","nameEn":"Hong Han-bit","affiliation":"Î£©Ïä§Ïõ∞ÏùòÏõê","affiliationEn":"Luxwell Clinic"},{"name":"ÏµúÌò∏ÏÑ±","nameEn":"Choi Ho-seong","affiliation":"ÌîºÏñ¥ÎÇòÏùòÏõê","affiliationEn":"Pieona Clinic"},{"name":"ÏµúÌòúÏÑ†","nameEn":"Choi Hye-seon","affiliation":"ÍπÄÏïàÍ≥ºÎ≥ëÏõê","affiliationEn":"Kim Eye Hospital"},{"name":"ÏµúÏõêÏö∞","nameEn":"Choi Won-woo","affiliation":"Ïõ∞Ïä§ÌîºÎ∂ÄÍ≥º","affiliationEn":"Wells Dermatology"},{"name":"ÏµúÏÑ±Îçï","nameEn":"Choi Seong-deok","affiliation":"ÏïÑÏù¥Î≥∏Î≥ëÏõê","affiliationEn":"Eyebon Hospital"},{"name":"ÏµúÎÇòÏòÅ","nameEn":"Choi Na-young","affiliation":"ÏÉàÎÇòÏùòÏõê","affiliationEn":"Saena Clinic"},{"name":"Ï¥àÏ≤≠Ïó∞Ïûê(ÍπÄÏÉÅÏóΩ)","nameEn":"Guest Speaker (Kim Sang-yeop)","affiliation":"Ï¥àÏ≤≠Ïó∞Ïûê(JFÌîºÎ∂ÄÍ≥º)","affiliationEn":"JF Dermatology"},{"name":"Ï°∞Ï∞ΩÌôò","nameEn":"Cho Chang-hwan","affiliation":"ÎèôÏïàÏ§ëÏã¨ÏùòÏõê","affiliationEn":"Dongan Center Clinic"},{"name":"Ï°∞ÏòÅÏßÄ","nameEn":"Cho Young-ji","affiliation":"Î™®ÎûòÏãúÍ≥ÑÏùòÏõê","affiliationEn":"Hourglass Clinic"},{"name":"Ï°∞ÏäπÌòÑ","nameEn":"Cho Seung-hyeon","affiliation":"Ï≤≠Îã¥Ïó†ÏóêÏä§ÏùòÏõê","affiliationEn":"Cheongdam MS Clinic"},{"name":"Ï†ïÏû¨Ïú§","nameEn":"Jeong Jae-yoon","affiliation":"ÎØ∏ÏóòÎ•¥ Ïù∏ Ï≤≠Îã¥","affiliationEn":"Mielr in Cheongdam"},{"name":"Ïû•ÌòÑÏÑù","nameEn":"Jang Hyeon-seok","affiliation":"ÏÖÄÎü¨Î∏åÏùòÏõê","affiliationEn":"Celleb Clinic"},{"name":"ÏûÑÌôçÏ≤†","nameEn":"Lim Hong-cheol","affiliation":"Í¥ëÏ£ºÏÑ±ÌòïÏô∏Í≥º","affiliationEn":"Gwangju Plastic Surgery"},{"name":"ÏûÑÏÑ∏Ìõà","nameEn":"Lim Se-hoon","affiliation":"ÏûÑÏùòÏõê","affiliationEn":"Lim Clinic"},{"name":"Ïù¥Ìô©Ìù¨","nameEn":"Lee Hwang-hee","affiliation":"Ï≤≠Îã¥ÏóîÎπÑÏùòÏõê","affiliationEn":"Cheongdam NB Clinic"},{"name":"Ïù¥Ìôú","nameEn":"Lee Hwal","affiliation":"ÎùºÎ†åÏùòÏõê","affiliationEn":"Laren Clinic"},{"name":"Ïù¥ÌôîÏ§Ä","nameEn":"Lee Hwa-jun","affiliation":"ÎπàÏÑºÌä∏ÏùòÏõê","affiliationEn":"Vincent Clinic"},{"name":"Ïù¥ÏßÑÏïÑ","nameEn":"Lee Jin-a","affiliation":"Ïú†ÏïàÌÅ¥Î¶¨Îãâ","affiliationEn":"Yuan Clinic"},{"name":"Ïù¥Ï§Ä","nameEn":"Lee Jun","affiliation":"Ï†úÏù¥ÏóòÏùòÏõê Íµ¨ÎØ∏Ï†ê","affiliationEn":"JL Clinic Gumi"},{"name":"Ïù¥Ï£ºÏòÅ","nameEn":"Lee Ju-young","affiliation":"Ï†úÏù¥Ïú†ÏùòÏõê Ïö∏ÏÇ∞Ï†ê","affiliationEn":"JY Clinic Ulsan"},{"name":"Ïù¥Ï¢ÖÌõà","nameEn":"Lee Jong-hoon","affiliation":"Î¶¨Ï¶àÎ≤®ÏùòÏõê","affiliationEn":"Rizbell Clinic"},{"name":"Ïù¥Ï¢ÖÏßÑ","nameEn":"Lee Jong-jin","affiliation":"ÏÑ∏ÎùºÎØ∏ÌÅ¨ÏùòÏõê Í∞ïÎÇ®","affiliationEn":"Ceramic Clinic Gangnam"},{"name":"Ïù¥Ï†ïÏö∞","nameEn":"Lee Jeong-woo","affiliation":"ÏóòÎ†àÎ∏åÏùòÏõê","affiliationEn":"Elev Clinic"},{"name":"Ïù¥Ïû¨Îèô","nameEn":"Lee Jae-dong","affiliation":"ÎØ∏ÏÜåÎã¥ÏùòÏõê","affiliationEn":"Misodam Clinic"},{"name":"Ïù¥ÏõêÍ∏∞","nameEn":"Lee Won-gi","affiliation":"ÌÜ°Ïä§Ïï§ÌïÑÏùòÏõê Íµ¨ÏõîÏ†ê","affiliationEn":"Tox&Fill Clinic Guwol"},{"name":"Ïù¥Ïö©ÌòÑ","nameEn":"Lee Yong-hyeon","affiliation":"Í≤ΩÎåÄsdÏùòÏõê","affiliationEn":"Kyungdae SD Clinic"},{"name":"Ïù¥Ïö©Ìñâ","nameEn":"Lee Yong-haeng","affiliation":"Ïõ∞Í∞ÄÏùòÏõê","affiliationEn":"Wellga Clinic"},{"name":"Ïù¥ÏÉÅÌóå","nameEn":"Lee Sang-heon","affiliation":"Ïï±ÌÉÄÏù¥Î°†Î∞îÏù¥Ïò§","affiliationEn":"Aptiron Bio"},{"name":"Ïù¥ÏÉÅÏàò","nameEn":"Lee Sang-soo","affiliation":"ÎØ∏ÎùºÎ≤®ÏùòÏõê","affiliationEn":"Mirabel Clinic"},{"name":"Ïù¥ÏÉÅÎèà","nameEn":"Lee Sang-don","affiliation":"ÎåÄÎØ∏Î†à ÌïôÏà†Í≥†Î¨∏","affiliationEn":"Daemire Academic Advisor"},{"name":"Ïù¥ÎØºÌò∏","nameEn":"Lee Min-ho","affiliation":"Î≤†Ïä§ÌÉëÏùòÏõê","affiliationEn":"Bestop Clinic"},{"name":"Ïù¥ÎØºÏ£º","nameEn":"Lee Min-ju","affiliation":"Î£®ÎØ∏ÏùòÏõê","affiliationEn":"Lumi Clinic"},{"name":"Ïù¥ÎûÄ","nameEn":"Lee Ran","affiliation":"Ïù¥Ï††ÏùòÏõê","affiliationEn":"Ezen Clinic"},{"name":"Ïù¥Í≤ΩÏùÄ","nameEn":"Lee Kyeong-eun","affiliation":"ÎÑ¨ÏùòÏõê","affiliationEn":"Nel Clinic"},{"name":"Ïú§ÌòÑÏ≤†","nameEn":"Yoon Hyeon-cheol","affiliation":"ÏóîÌîåÎü¨Ïä§ÏùòÏõê","affiliationEn":"N Plus Clinic"},{"name":"Ïú§Ï†ïÌòÑ","nameEn":"Yoon Jeong-hyeon","affiliation":"Ïó∞ÏÑ∏ÌåúÏä§ÏùòÏõê","affiliationEn":"Yonsei Farms Clinic"},{"name":"Ïú§ÏÑ±ÏùÄ","nameEn":"Yoon Seong-eun","affiliation":"Î∏åÎûúÎâ¥ÏùòÏõê","affiliationEn":"Brand New Clinic"},{"name":"Ïú†ÏßÄÌòÑ","nameEn":"Yoo Ji-hyeon","affiliation":"Î£®ÎØ∏ÏùòÏõê","affiliationEn":"Lumi Clinic"},{"name":"Ïú†Ïû¨Ïö±","nameEn":"Yoo Jae-wook","affiliation":"Î∞îÎ°úÎØ∏ÏùòÏõê","affiliationEn":"Baromi Clinic"},{"name":"Ïú†Í≤ΩÌõà","nameEn":"Yoo Kyeong-hoon","affiliation":"Î£®ÎØ∏ÏùòÏõê","affiliationEn":"Lumi Clinic"},{"name":"ÏõêÎåÄÌïú","nameEn":"Won Dae-han","affiliation":"ÌîÑÎ¶¨ÎØ∏ÌÅ¥Î¶¨Îãâ","affiliationEn":"Freeme Clinic"},{"name":"Ïö∞ÏßÄÏÇ∞","nameEn":"Woo Ji-san","affiliation":"ÏΩîÏù¥Ï¶à ÎåÄÌëúÏù¥ÏÇ¨","affiliationEn":"COEZ CEO"},{"name":"Ïò§ÏÑúÏ§Ä","nameEn":"Oh Seo-jun","affiliation":"ÎçîÎßàÏä§ÌÑ∞ÌÅ¥Î¶¨Îãâ","affiliationEn":"The Master Clinic"},{"name":"ÏïàÌòÑÏ§Ä","nameEn":"Ahn Hyeon-jun","affiliation":"Ìä∏ÎùºÏù¥ÏóÖ","affiliationEn":"Tryup"},{"name":"ÏïàÏßÑÎ†¨","nameEn":"Ahn Jin-yeol","affiliation":"ÏÑ∏Î¨¥Î≤ïÏù∏ Í∏ÄÎ°úÎπÑ","affiliationEn":"Globee Tax"},{"name":"ÏïàÏÑ±Ìôò","nameEn":"Ahn Seong-hwan","affiliation":"Ïó∞ÏÑ∏ÎùºÏù∏ÏùòÏõê","affiliationEn":"Yonsei Line Clinic"},{"name":"Ïã†ÏäπÌò∏","nameEn":"Shin Seung-ho","affiliation":"Ïã†Ïú†ÏùòÏõê","affiliationEn":"Shinyu Clinic"},{"name":"ÏÜ°Ïö∞Ï≤†","nameEn":"Song Woo-cheol","affiliation":"ÏóêÎ∏åÎ¶¨ÏóÖÏùòÏõê","affiliationEn":"Every Up Clinic"},{"name":"ÏÜêÏßÄÌù¨","nameEn":"Son Ji-hee","affiliation":"ÌéòÏù¥Î∏åÌîºÎ∂ÄÍ≥º","affiliationEn":"Fave Dermatology"},{"name":"ÏÑ±ÏàòÌôò","nameEn":"Seong Soo-hwan","affiliation":"ÎØ∏ÏÜåÏïàÏùòÏõê","affiliationEn":"Misoan Clinic"},{"name":"ÏÑúÌù¨Ïõê","nameEn":"Seo Hee-won","affiliation":"Ï≤≠Îã¥ÏÑúÌÅ¥ÏùòÏõê","affiliationEn":"Cheongdam Circle Clinic"},{"name":"ÏÑúÍ≤ΩÌù¨","nameEn":"Seo Kyeong-hee","affiliation":"ÏïÑÏù¥Îü¨Î∏åÍ∞ïÎÇ®ÏùòÏõê","affiliationEn":"I Love Gangnam Clinic"},{"name":"Î∞∞Í≤ΩÌÉú","nameEn":"Bae Kyeong-tae","affiliation":"ÏûáÏ∏†ÎØ∏ÏùòÏõê ÏÑ∏Ï¢ÖÏ†ê","affiliationEn":"It\'s Me Clinic Sejong"},{"name":"Î∞ïÏ§ÄÏòÅ","nameEn":"Park Jun-young","affiliation":"Ïò§Ïö¥ÏùòÏõê","affiliationEn":"Oun Clinic"},{"name":"Î∞ïÏ£ºÏôÑ","nameEn":"Park Ju-wan","affiliation":"ÏïÑÏù¥ÏΩòÏïàÍ≥º","affiliationEn":"Icon Eye Clinic"},{"name":"Î∞ïÏ¢ÖÌõà","nameEn":"Park Jong-hoon","affiliation":"Ïò§Ïö¥ÏùòÏõê","affiliationEn":"Oun Clinic"},{"name":"Î∞ïÏõêÍ∑ú","nameEn":"Park Won-gyu","affiliation":"Î¶¨ÏñºÎØ∏ÏùòÏõê","affiliationEn":"Real Me Clinic"},{"name":"Î∞ïÏòÅÏßÑ","nameEn":"Park Young-jin","affiliation":"Ïò§Î∏îÎ¶¨Î∏åÏùòÏõê","affiliationEn":"Obliv Clinic"},{"name":"Î∞ïÏàòÏó∞","nameEn":"Park Soo-yeon","affiliation":"Î©îÏù¥ÎìúÏòÅ ÏÑ±ÌòïÏô∏Í≥º","affiliationEn":"Made Young Plastic Surgery"},{"name":"Î∞ïÏÜåÏú§","nameEn":"Park So-yoon","affiliation":"Ï≤≠Îã¥ ÏóêÎÅåÎùºÎìúÏùòÏõê","affiliationEn":"Cheongdam Eclat Clinic"},{"name":"Î∞ïÎØºÌòï","nameEn":"Park Min-hyeong","affiliation":"Î©îÏù¥Î¶∞ÏùòÏõê ÎçîÌòÑÎåÄ ÎåÄÍµ¨","affiliationEn":"Mayline Clinic Daegu"},{"name":"ÎØºÌò∏Í∑†","nameEn":"Min Ho-gyun","affiliation":"Ïú†ÎØ∏ÎÖ∏ÏùòÏõê","affiliationEn":"Yumino Clinic"},{"name":"ÎØºÏïÑÎ¶º","nameEn":"Min A-rim","affiliation":"ÎØºÏï§ÎØºÏùòÏõê","affiliationEn":"Min & Min Clinic"},{"name":"Î¨∏ÌòïÏßÑ","nameEn":"Moon Hyeong-jin","affiliation":"ÎåÄÎØ∏Î†à ÌïôÏà†Í≥†Î¨∏","affiliationEn":"Daemire Academic Advisor"},{"name":"ÎÇòÍ≥µÏ∞¨","nameEn":"Na Gong-chan","affiliation":"Î°úÎπàÏùòÏõê","affiliationEn":"Robin Clinic"},{"name":"ÍπÄÌù¨ÏßÑ","nameEn":"Kim Hee-jin","affiliation":"Ïó∞ÏÑ∏ÎåÄÌïôÍµê ÏπòÍ≥ºÎåÄÌïô ÍµêÏàò","affiliationEn":"Yonsei University Dental Professor"},{"name":"ÍπÄÌò∏Îèô","nameEn":"Kim Ho-dong","affiliation":"Ïú§Ï†ïÌòÑÎã¥Îãπ","affiliationEn":"Yoon Jeong-hyeon Department"},{"name":"ÍπÄÌòÑÏàò","nameEn":"Kim Hyeon-soo","affiliation":"ÍπÄÌòÑÏàòÎÇ¥Í≥º","affiliationEn":"Kim Hyeon-soo Internal Medicine"},{"name":"ÍπÄÌòÑÍ≤Ω","nameEn":"Kim Hyeon-kyeong","affiliation":"Î™®Ïö∞Îã§ÏùòÏõê","affiliationEn":"Mouda Clinic"},{"name":"ÍπÄÌïôÏàò","nameEn":"Kim Hak-soo","affiliation":"Îã•ÌÑ∞Î≤†Ïù¥ÏßÅÏùòÏõê","affiliationEn":"Dr. Basic Clinic"},{"name":"ÍπÄÏßÑÏò§","nameEn":"Kim Jin-o","affiliation":"Îâ¥Ìó§Ïñ¥Î™®Î∞úÏÑ±ÌòïÏô∏Í≥ºÏùòÏõê","affiliationEn":"New Hair Clinic"},{"name":"ÍπÄÏ§Ä","nameEn":"Kim Jun","affiliation":"Î∞îÎ°úÏΩîÏùòÏõê","affiliationEn":"Baroco Clinic"},{"name":"ÍπÄÏ†ïÏ£º","nameEn":"Kim Jeong-ju","affiliation":"Ïã†ÌïúÏóêÏä§","affiliationEn":"Shinhan S"},{"name":"ÍπÄÏû¨Ìôç","nameEn":"Kim Jae-hong","affiliation":"ÎçîÎçîÎ∏îÏú†ÏùòÏõê","affiliationEn":"The W Clinic"},{"name":"ÍπÄÏû¨Ïö∞","nameEn":"Kim Jae-woo","affiliation":"ÌÅ¥ÎûòÏä§ÏõêÏùòÏõê","affiliationEn":"Class One Clinic"},{"name":"ÍπÄÏû¨ÏòÅ","nameEn":"Kim Jae-young","affiliation":"ÎìúÎ¶ºÌó§Ïñ¥ÎùºÏù∏ÏùòÏõê","affiliationEn":"Dream Hairline Clinic"},{"name":"ÍπÄÏòÅÍ∂å","nameEn":"Kim Young-kwon","affiliation":"ÏóòÏ∏†ÏùòÏõê","affiliationEn":"Eltz Clinic"},{"name":"ÍπÄÏÜåÏùÄ","nameEn":"Kim So-eun","affiliation":"Îã§ÏÇ∞ ÎçîÏò¨Î¶ºÏùòÏõê","affiliationEn":"Dasan The Ollim Clinic"},{"name":"ÍπÄÏÑ±ÏßÑ","nameEn":"Kim Seong-jin","affiliation":"Ïä§ÏºÄÏ§ÑÏùòÏõê","affiliationEn":"Schedule Clinic"},{"name":"ÍπÄÎëêÌïú","nameEn":"Kim Doo-han","affiliation":"Í∞ïÌïúÎØ∏ÏùòÏõê","affiliationEn":"Ganghanmi Clinic"},{"name":"ÍπÄÎÇòÎûòÏúÑ","nameEn":"Kim Na-rae-wi","affiliation":"Ïï§ÌÇ¥ÏùòÏõê","affiliationEn":"And Kim Clinic"},{"name":"ÍπÄÍ∏∞Ìôç","nameEn":"Kim Gi-hong","affiliation":"Îâ¥ÎãàÏä§ÏùòÏõê","affiliationEn":"Newnis Clinic"},{"name":"ÍπÄÍ∏∞Ïö±B","nameEn":"Kim Gi-wook B","affiliation":"Î∏åÎûúÎìúÏú†ÏùòÏõê","affiliationEn":"Brand You Clinic"},{"name":"ÍπÄÍ∏∞Ïö±A","nameEn":"Kim Gi-wook A","affiliation":"ÏïÑÏù¥ÎîîÏùòÏõê ÏúÑÎ°ÄÏ†ê","affiliationEn":"ID Clinic Wirye"},{"name":"ÍπÄÍ∏∞Î≤î","nameEn":"Kim Gi-beom","affiliation":"ÎØ∏ÏÜåÍ∞ÄÏù∏ÌîºÎ∂ÄÍ≥º ÍπÄÌè¨Ï†ê","affiliationEn":"Misogain Dermatology Gimpo"},{"name":"ÍπÄÍ≤ΩÎ¥â","nameEn":"Kim Kyeong-bong","affiliation":"Î°úÌïòÏä§ÏùòÏõê","affiliationEn":"Lohas Clinic"},{"name":"ÍπÄÍ±¥Ïö∞","nameEn":"Kim Geon-woo","affiliation":"Î•¥ÎîîÏïÑÎßùÏùòÏõê","affiliationEn":"Le Diamant Clinic"},{"name":"Í∏∞Î¨∏ÏÉÅ","nameEn":"Gi Moon-sang","affiliation":"ÏïàÏÇ∞ÏóîÎπÑÏùòÏõê","affiliationEn":"Ansan NB Clinic"},{"name":"Íµ≠ÏßÄÏàò","nameEn":"Kook Ji-soo","affiliation":"ÏûáÏ∏†ÎØ∏ÏùòÏõê ÏïàÏÇ∞Ï†ê","affiliationEn":"It\'s Me Clinic Ansan"},{"name":"Íµ¨Ïú§Ïàò","nameEn":"Koo Yoon-soo","affiliation":"ÏÑúÏö∏ÎÇòÏù∏Ïï§ÏùòÏõê Ï≤úÏïà","affiliationEn":"Seoul Nine& Clinic Cheonan"},{"name":"Íµ¨ÏÜåÏó∞","nameEn":"Koo So-yeon","affiliation":"ÎèôÏïàÏ§ëÏã¨ÏùòÏõê","affiliationEn":"Dongan Center Clinic"},{"name":"Í≥µÏòÅÏàò","nameEn":"Gong Young-soo","affiliation":"Îã•ÌÑ∞ÎîîÏûêÏù¥ÎÑàÏùòÏõê ÎèôÌÉÑÏ†ê","affiliationEn":"Dr. Designer Clinic Dongtan"},{"name":"Í≥†ÏùµÏàò","nameEn":"Go Ik-soo","affiliation":"Í≥†ÏùµÏàòÏÑ±ÌòïÏô∏Í≥º","affiliationEn":"Go Ik-soo Plastic Surgery"},{"name":"Í∞ïÌïúÎ≥Ñ","nameEn":"Kang Han-byeol","affiliation":"ÎπÑÏóòÏóêÏä§ÏùòÏõê Ïû†Ïã§Ï†ê","affiliationEn":"BLS Clinic Jamsil"},{"name":"Í∞ïÏù∏Ìò∏","nameEn":"Kang In-ho","affiliation":"Ïó∞ÏÑ∏Î¶¨Ï¶àÏùòÏõê","affiliationEn":"Yonsei Leeds Clinic"},{"name":"Í∞ïÎ¨¥ÏÇº","nameEn":"Kang Moo-sam","affiliation":"Îã§ÎπàÏπòÏùòÏõê","affiliationEn":"Da Vinci Clinic"},{"name":"ÍπÄÎ≤îÏ§Ä","nameEn":"Kim Beom-jun","affiliation":"ÎèôÍ≤ΩÎåÄÌïôÍµê","affiliationEn":"Tokyo University"},{"name":"Î∞∞ÌòïÍ∑ú","nameEn":"Bae Hyeong-gyu","affiliation":"Ïó∞ÏÑ∏ÎåÄÌïôÍµê ÏùòÍ≥ºÎåÄÌïô","affiliationEn":"Yonsei University Medical School"},{"name":"Ïù¥ÌòÑÏ£º","nameEn":"Lee Hyeon-ju","affiliation":"Í≥®ÎìúÏ†úÏù¥ÏùòÏõê","affiliationEn":"Gold J Clinic"},{"name":"Ïù¥ÏäπÌù¨","nameEn":"Lee Seung-hee","affiliation":"ÏùºÎùºÏä§ÏùòÏõê","affiliationEn":"Illas Clinic"},{"name":"ÏïàÎèôÌòÑ","nameEn":"Ahn Dong-hyeon","affiliation":"ÎåÄÏòÅÏÑ±ÌòïÏô∏Í≥º","affiliationEn":"Daeyoung Plastic Surgery"},{"name":"ÏóºÏ∞ΩÌôò","nameEn":"Yeom Chang-hwan","affiliation":"ÏóºÏ∞ΩÌôòÎ≥ëÏõê","affiliationEn":"Yeom Chang-hwan Hospital"},{"name":"Î∞ïÍ∑úÎ¶¨","nameEn":"Park Gyu-ri","affiliation":"Ìñ•ÎèôÎØ∏ÎùºÌÅ¥ÏùòÏõê","affiliationEn":"Hyangdong Miracle Clinic"},{"name":"Ïù¥ÏÑ†ÎØº","nameEn":"Lee Seon-min","affiliation":"Î™®Î©òÌÖÄÌó§Ïñ¥ÎùºÏù∏ÏùòÏõê","affiliationEn":"Momentum Hairline Clinic"},{"name":"ÏÑúÎØºÌù¨","nameEn":"Seo Min-hee","affiliation":"ÎπÖÏõ®Ïù¥Î∏åÏì∞Î¶¨","affiliationEn":"Big Wave Three"},{"name":"ÎèÑÏû¨Ïö¥","nameEn":"Do Jae-woon","affiliation":"Ïù¥ÏßÄÎèôÏïàÏùòÏõê","affiliationEn":"Easy Dongan Clinic"},{"name":"Ïù¥Ïû•Ïõê","nameEn":"Lee Jang-won","affiliation":"Î∞∏Îü∞Ïä§Îû© ÏÑ±ÌòïÏô∏Í≥º","affiliationEn":"Balance Lab Plastic Surgery"},{"name":"ÍπÄÎØºÏäπ","nameEn":"Kim Min-seung","affiliation":"ÏïÑÏù¥ÎãàÌÅ¥Î¶¨Îãâ","affiliationEn":"Ini Clinic"},{"name":"ÌôçÍ∏∞ÏõÖ","nameEn":"Hong Gi-woong","affiliation":"ÏÉòÏä§ÌÇ®ÏÑ±ÌòïÏô∏Í≥º","affiliationEn":"Sam Skin Plastic Surgery"},{"name":"Ïò§Ïö±","nameEn":"Oh Wook","affiliation":"Î©îÏù¥Î¶∞ÏùòÏõê ÎçîÌòÑÎåÄ ÏÑúÏö∏","affiliationEn":"Mayline Clinic Seoul"},{"name":"ÍπÄÌôîÌèâ","nameEn":"Kim Hwa-pyeong","affiliation":"Î∞îÏö∞Ïä§ÏùòÏõê","affiliationEn":"Baus Clinic"},{"name":"Ï†ïÏßÑÏàò","nameEn":"Jeong Jin-soo","affiliation":"ÌÅ¨Î¶¨Ïä§ÎßàÏä§ÏùòÏõê","affiliationEn":"Christmas Clinic"},{"name":"Ïù¥ÌòÑÌù¨","nameEn":"Lee Hyeon-hee","affiliation":"Î•¥Ïõ∞ÏùòÏõê","affiliationEn":"Le Well Clinic"},{"name":"ÏµúÏ†ÑÌïÑ","nameEn":"Choi Jeon-pil","affiliation":"ÌïòÎäòÎäêÎÇåÌîºÎ∂ÄÍ≥º","affiliationEn":"Haneul Neukkeim Dermatology"},{"name":"ÏïàÌö®ÏÉÅ","nameEn":"Ahn Hyo-sang","affiliation":"ÎîîÎùºÏö¥ÏßÄÌîºÎ∂ÄÍ≥º","affiliationEn":"The Lounge Dermatology"},{"name":"Ïò§ÎåÄÎ™Ö","nameEn":"Oh Dae-myeong","affiliation":"ÏÖÄÏóÖÏÑ±ÌòïÏô∏Í≥º","affiliationEn":"Cell Up Plastic Surgery"},{"name":"Ïù¥ÎèôÏßÑ","nameEn":"Lee Dong-jin","affiliation":"ÎπÑÏóòÏóêÏä§ÏùòÏõê","affiliationEn":"BLS Clinic"},{"name":"Ïù¥Ïö±","nameEn":"Lee Wook","affiliation":"ÎÖ∏Î∏îÌÅ¥ÎûòÏãùÏùòÏõê","affiliationEn":"Noble Classic Clinic"},{"name":"ÍπÄÏ¢ÖÏÑú","nameEn":"Kim Jong-seo","affiliation":"ÍπÄÏ¢ÖÏÑúÏÑ±ÌòïÏô∏Í≥º","affiliationEn":"Kim Jong-seo Plastic Surgery"},{"name":"Í∞ïÎ¶¨Î¶¨","nameEn":"Kang Ri-ri","affiliation":"ÎçîÎ≤†Ïù¥ÏßÄÏùòÏõê","affiliationEn":"The Beige Clinic"},{"name":"ÏÜ°ÎèôÌòÅ","nameEn":"Song Dong-hyeok","affiliation":"ÏóòÏä§ÌÉÄÏùòÏõê","affiliationEn":"L Star Clinic"},{"name":"ÍπÄÌòúÏßÑ","nameEn":"Kim Hye-jin","affiliation":"ÎçîÏõ∞ÎãàÏä§ÏùòÏõê","affiliationEn":"The Wellness Clinic"},{"name":"Ïù¥ÏßÄÎØº","nameEn":"Lee Ji-min","affiliation":"ÎîîÎ†âÌÑ∞ÌîºÎ∂ÄÍ≥ºÏùòÏõê","affiliationEn":"Director Dermatology Clinic"},{"name":"Í≥†Î™ÖÏßÑ","nameEn":"Go Myeong-jin","affiliation":"ÏòàÏÅ®Ï£ºÏùòÏÅ®ÏùòÏõê ÏÑúÏö∏ÎåÄÏûÖÍµ¨Ï†ê","affiliationEn":"Yeppeum Juui Ppeum Clinic SNU"},{"name":"Í∞ïÏ†ïÏ§ë","nameEn":"Kang Jeong-joong","affiliation":"Îã•ÌÑ∞ÏÑ†ÏùòÏõê","affiliationEn":"Dr. Sun Clinic"},{"name":"Ïã†ÏòàÏßÑ","nameEn":"Shin Ye-jin","affiliation":"ÎìúÎÑ§ÏùòÏõê","affiliationEn":"Dne Clinic"},{"name":"Ïù¥Ï∞¨Ï¢Ö","nameEn":"Lee Chan-jong","affiliation":"Î≥ëÏõêÎ™ÖÏûÖÎ†•","affiliationEn":"Hospital Name"},{"name":"Í∂åÏòÅÎåÄ","nameEn":"Kwon Young-dae","affiliation":"Ïò§ÏÇ∞ Í∞ïÎÇ®ÏÑ±ÌòïÏô∏Í≥º","affiliationEn":"Osan Gangnam Plastic Surgery"},{"name":"Î∞ïÏû¨ÏõÖ","nameEn":"Park Jae-woong","affiliation":"ÌÅ¥Î¶∞ÌÉÄÌà¨ÏùòÏõê","affiliationEn":"Clean Tattoo Clinic"},{"name":"Jason Yip","nameEn":"Jason Yip","affiliation":"Astute Clinic","affiliationEn":"Astute Clinic"},{"name":"Ï°∞ÏòÅÏ§Ä","nameEn":"Cho Young-jun","affiliation":"Î≥ëÏõêÎ™Ö ÏûÖÎ†•","affiliationEn":"Hospital Name"},{"name":"Ïú†ÌòúÎØ∏","nameEn":"Yoo Hye-mi","affiliation":"ÎπÑÏïÑÏù¥Ïò§ÏÑ±ÌòïÏô∏Í≥º","affiliationEn":"Bio Plastic Surgery"},{"name":"Ïú§ÌòÑÏäπ","nameEn":"Yoon Hyeon-seung","affiliation":"ÎØ∏ÎØ∏Ïç∏ÏùòÏõê","affiliationEn":"Mimi Some Clinic"},{"name":"Î∞ïÌòïÏö±","nameEn":"Park Hyeong-wook","affiliation":"ÎåÑÏùòÏõê","affiliationEn":"Dan Clinic"},{"name":"ÌôçÏ¢ÖÏö±","nameEn":"Hong Jong-wook","affiliation":"Î¨ºÎ∞©Ïö∏ÏÑ±ÌòïÏô∏Í≥º","affiliationEn":"Waterdrop Plastic Surgery"},{"name":"ÏµúÍ∞ïÌõà","nameEn":"Choi Gang-hoon","affiliation":"ÎπÑÏò¨ÎùºÏÖÄÏÑ±ÌòïÏô∏Í≥º","affiliationEn":"Viola Cell Plastic Surgery"},{"name":"ÍπÄÏßÄÏÑ†","nameEn":"Kim Ji-seon","affiliation":"MHÏùòÏõê","affiliationEn":"MH Clinic"},{"name":"Í≥†ÏòÅÏÉÅ","nameEn":"Go Young-sang","affiliation":"Î∞îÏö∞Ïä§ÏùòÏõê","affiliationEn":"Baus Clinic"},{"name":"ÎÇ®ÌòÑÏÑù","nameEn":"Nam Hyeon-seok","affiliation":"ÏÉ§Ïù∏ÎπîÏùòÏõê ÏÜ°ÎèÑÏ†ê","affiliationEn":"Shine Beam Clinic Songdo"},{"name":"ÍπÄÎØ∏ÏßÑ","nameEn":"Kim Mi-jin","affiliation":"Î©îÏù¥Î¶∞ÏùòÏõê ÎçîÌòÑÎåÄ ÏÑúÏö∏","affiliationEn":"Mayline Clinic Seoul"},{"name":"ÏïàÌÉúÌôò","nameEn":"Ahn Tae-hwan","affiliation":"ÌîÑÎ†àÏâ¨Ïù¥ÎπÑÏù∏ÌõÑÍ≥ºÏùòÏõê","affiliationEn":"Fresh ENT Clinic"},{"name":"Ïã†Ïö©Î∞∞","nameEn":"Shin Yong-bae","affiliation":"Îã•ÌÑ∞Îâ¥ÏÖÄÏùòÏõê","affiliationEn":"Dr. New Cell Clinic"},{"name":"Í∞ïÏú†ÏßÑ","nameEn":"Kang Yoo-jin","affiliation":"Ïù¥Î£¨ÏùòÏõê ÌïòÎÇ®","affiliationEn":"Irun Clinic Hanam"}]');

        // roomsÎäî ÏúÑÏóêÏÑú ÎÇ†ÏßúÎ≥ÑÎ°ú Ï†ïÏùòÎê®
        const timeSlots = [];
        let lectures = [];
        let schedule = {};
        let speakers = [...SPEAKERS_DATA]; // Í∏∞Î≥∏ Ïó∞Ïûê Îç∞Ïù¥ÌÑ∞Î°ú Ï¥àÍ∏∞Ìôî
        let sessions = []; // ÏÑ∏ÏÖò Îç∞Ïù¥ÌÑ∞
        let activeFilter = 'all';
        let pendingSpeakerInfo = null;
        let currentLanguage = 'ko'; // ÌòÑÏû¨ Ïñ∏Ïñ¥ (ko/en)

        // ============================================
        // Undo ÏãúÏä§ÌÖú (5Îã®Í≥Ñ)
        // ============================================
        let undoHistory = [];
        const MAX_UNDO = 5;

        function saveStateForUndo() {
            const state = {
                schedule: JSON.parse(JSON.stringify(schedule)),
                sessions: JSON.parse(JSON.stringify(sessions)),
                lectures: JSON.parse(JSON.stringify(lectures))
            };
            undoHistory.push(state);
            if (undoHistory.length > MAX_UNDO) {
                undoHistory.shift();
            }
            updateUndoButton();
        }

        function performUndo() {
            if (undoHistory.length === 0) {
                alert('ÎêòÎèåÎ¶¥ ÏûëÏóÖÏù¥ ÏóÜÏäµÎãàÎã§.');
                return;
            }
            
            const previousState = undoHistory.pop();
            schedule = previousState.schedule;
            sessions = previousState.sessions;
            lectures = previousState.lectures;
            
            saveAndSync();
            updateScheduleDisplay();
            updateLectureList();
            updateUndoButton();
        }

        function updateUndoButton() {
            const btn = document.getElementById('undoBtn');
            if (btn) {
                btn.textContent = `‚Ü© ÎêòÎèåÎ¶¨Í∏∞ (${undoHistory.length}/${MAX_UNDO})`;
                btn.disabled = undoHistory.length === 0;
            }
        }

        // Ctrl+Z Îã®Ï∂ïÌÇ§
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'z') {
                e.preventDefault();
                performUndo();
            }
        });

        // ============================================
        // ÌïúÍ∏Ä ‚Üí ÏòÅÎ¨∏ ÏûêÎèô Î≥ÄÌôò (ÏùòÌïô/ÎØ∏Ïö© Ïö©Ïñ¥ ÏÇ¨Ï†Ñ Í∏∞Î∞ò)
        // ============================================
        
        const medicalTermDict = {
            // ÌîºÎ∂Ä/ÎØ∏Ïö© Í¥ÄÎ†®
            'ÌîºÎ∂Ä': 'Skin',
            'Ï£ºÎ¶Ñ': 'Wrinkle',
            'Î¶¨ÌîÑÌåÖ': 'Lifting',
            'Î†àÏù¥Ï†Ä': 'Laser',
            'ÌïÑÎü¨': 'Filler',
            'Î≥¥ÌÜ°Ïä§': 'Botox',
            'ÌÜ°Ïã†': 'Toxin',
            'Ïù∏ÏΩî': 'INCO',
            'ÏΩúÎùºÍ≤ê': 'Collagen',
            'Ïû¨ÏÉù': 'Regeneration',
            'ÌöåÏ∂ò': 'Rejuvenation',
            'ÏïàÌã∞ÏóêÏù¥Ïßï': 'Anti-aging',
            'ÎÖ∏Ìôî': 'Aging',
            'ÌÉÑÎ†•': 'Elasticity',
            'Î≥¥Ïäµ': 'Moisturizing',
            'ÎØ∏Î∞±': 'Whitening',
            'ÏÉâÏÜå': 'Pigmentation',
            'Î™®Í≥µ': 'Pore',
            'Ïó¨ÎìúÎ¶Ñ': 'Acne',
            'ÌùâÌÑ∞': 'Scar',
            'Í∏∞ÎØ∏': 'Melasma',
            'Ï£ºÍ∑ºÍπ®': 'Freckles',
            'Îã§ÌÅ¨ÏÑúÌÅ¥': 'Dark Circle',
            
            // ÏãúÏà†/ÏπòÎ£å
            'ÏãúÏà†': 'Treatment',
            'ÏπòÎ£å': 'Therapy',
            'ÏàòÏà†': 'Surgery',
            'ÏÑ±Ìòï': 'Plastic Surgery',
            'ÎØ∏Ïö©': 'Aesthetic',
            'Ï£ºÏÇ¨': 'Injection',
            'Ïù¥Ïãù': 'Transplant',
            'Ï†úÍ±∞': 'Removal',
            'ÍµêÏ†ï': 'Correction',
            
            // Í∏∞Ïà†/Ïû•ÎπÑ
            'Í≥†Ï£ºÌåå': 'RF (Radiofrequency)',
            'Ï¥àÏùåÌåå': 'Ultrasound',
            'ÏßÑÎèô': 'Vibration',
            'Îã§Ï§ë': 'Multi',
            'Î≥µÌï©': 'Combined',
            'ÌòÅÏã†': 'Innovation',
            'Í∏∞Ï†Ñ': 'Mechanism',
            'ÏõêÎ¶¨': 'Principle',
            'Ï†ÅÏö©': 'Application',
            'ÏûÑÏÉÅ': 'Clinical',
            'Ìö®Í≥º': 'Effect',
            'Í≤∞Í≥º': 'Result',
            
            // Ïã†Ï≤¥ Î∂ÄÏúÑ
            'ÏñºÍµ¥': 'Face',
            'Îàà': 'Eye',
            'ÏΩî': 'Nose',
            'ÏûÖÏà†': 'Lip',
            'ÌÑ±': 'Chin',
            'Ïù¥Îßà': 'Forehead',
            'Î≥º': 'Cheek',
            'Î™©': 'Neck',
            'Î∞îÎîî': 'Body',
            'ÏßÑÌîº': 'Dermis',
            'ÌëúÌîº': 'Epidermis',
            
            // ÌòïÏö©ÏÇ¨/Î∂ÄÏÇ¨
            'ÏôÑÎ≤Ω': 'Perfect',
            'ÏµúÏã†': 'Latest',
            'ÌòÑÎåÄÏ†Å': 'Modern',
            'Î≥ÄÌòÅÏ†Å': 'Transformative',
            'Ïï°ÏÉÅÌòï': 'Liquid',
            'ÎπõÎÇòÎäî': 'Radiant',
            'ÏóÜÏù¥': 'Without',
            'Îã§ÏñëÌïú': 'Various',
            'Ï∏µÎ≥Ñ': 'Layer-by-layer',
            'Í≥µÎûµÎ≤ï': 'Strategy',
            
            // ÏùºÎ∞ò ÏùòÌïô
            'PCL': 'PCL',
            'HA': 'HA',
            'CPM': 'CPM',
            'RF': 'RF',
            'LED': 'LED',
            'PRP': 'PRP',
            'DNA': 'DNA',
            'ÏΩúÎùºÎ≥¥': 'Collaboration',
            'ÏÑ∏ÏÖò': 'Session',
            'ÏõåÌÅ¨ÏÉµ': 'Workshop',
            'Ïã¨Ìè¨ÏßÄÏóÑ': 'Symposium',
            'Í∞ïÏùò': 'Lecture',
            'Î∞úÌëú': 'Presentation',
            'ÌÜ†Î°†': 'Discussion',
            'Ìå®ÎÑê': 'Panel',
            
            // Ïó∞Í≤∞Ïñ¥
            'Ïùò': 'of',
            'ÏôÄ': 'and',
            'Î∞è': 'and',
            'ÏùÑ': '',
            'Î•º': '',
            'ÏóêÏÑú': 'in',
            'ÏúºÎ°ú': 'with',
            'Î°ú': 'with',
            'Ìïú': 'for',
            'Ï†Å': '',
            'Ïó≠Ìï†': 'Role'
        };
        
        function koreanToEnglish(koreanText) {
            if (!koreanText) return '';
            
            let result = koreanText;
            
            // ÏÇ¨Ï†ÑÏóê ÏûàÎäî Ïö©Ïñ¥ Î≥ÄÌôò
            Object.keys(medicalTermDict).forEach(korean => {
                const regex = new RegExp(korean, 'g');
                result = result.replace(regex, medicalTermDict[korean]);
            });
            
            // ÎÇ®ÏùÄ ÌïúÍ∏ÄÏù¥ ÏûàÏúºÎ©¥ Î°úÎßàÏûêÎ°ú Î≥ÄÌôò ÏãúÎèÑ
            result = result.replace(/[Í∞Ä-Ìû£]+/g, (match) => {
                return romanize(match);
            });
            
            // Ï†ïÎ¶¨: Ï§ëÎ≥µ Í≥µÎ∞± Ï†úÍ±∞, ÏïûÎí§ Í≥µÎ∞± Ï†úÍ±∞
            result = result.replace(/\s+/g, ' ').trim();
            
            // Ï≤´ Í∏ÄÏûê ÎåÄÎ¨∏Ïûê
            result = result.split(' ').map(word => {
                if (word.length > 0 && word.toLowerCase() !== 'of' && word.toLowerCase() !== 'and' && word.toLowerCase() !== 'in' && word.toLowerCase() !== 'with' && word.toLowerCase() !== 'for') {
                    return word.charAt(0).toUpperCase() + word.slice(1);
                }
                return word;
            }).join(' ');
            
            return result;
        }
        
        // Í∞ÑÎã®Ìïú ÌïúÍ∏Ä Î°úÎßàÏûê Î≥ÄÌôò (ÌëúÏ§Ä Î°úÎßàÏûê ÌëúÍ∏∞Î≤ï Í∏∞Î∞ò)
        function romanize(korean) {
            const initials = ['g', 'kk', 'n', 'd', 'tt', 'r', 'm', 'b', 'pp', 's', 'ss', '', 'j', 'jj', 'ch', 'k', 't', 'p', 'h'];
            const medials = ['a', 'ae', 'ya', 'yae', 'eo', 'e', 'yeo', 'ye', 'o', 'wa', 'wae', 'oe', 'yo', 'u', 'wo', 'we', 'wi', 'yu', 'eu', 'ui', 'i'];
            const finals = ['', 'k', 'k', 'k', 'n', 'n', 'n', 't', 'l', 'l', 'l', 'l', 'l', 'l', 'l', 'l', 'm', 'p', 'p', 't', 't', 'ng', 't', 't', 'k', 't', 'p', 't'];
            
            let result = '';
            
            for (let i = 0; i < korean.length; i++) {
                const code = korean.charCodeAt(i) - 44032;
                
                if (code >= 0 && code <= 11171) {
                    const initial = Math.floor(code / 588);
                    const medial = Math.floor((code % 588) / 28);
                    const final = code % 28;
                    
                    result += initials[initial] + medials[medial] + finals[final];
                } else {
                    result += korean[i];
                }
            }
            
            // Ï≤´ Í∏ÄÏûê ÎåÄÎ¨∏Ïûê
            return result.charAt(0).toUpperCase() + result.slice(1);
        }

        // ============================================
        // Google Drive API ÏÑ§Ï†ï
        // ============================================
        
        // API ÏÑ§Ï†ï (Google Cloud ConsoleÏóêÏÑú Î∞úÍ∏â) - ÎØ∏Î¶¨ ÏÑ§Ï†ïÎê®
        const GOOGLE_CLIENT_ID = '303515038815-n1dhp011ibvcmf3q3l1icp9vqligrrnb.apps.googleusercontent.com';
        const GOOGLE_API_KEY = 'AIzaSyBWrPHjrePBcI3198srXLmu9ZZ3rAcjBjU';
        const SCOPES = 'https://www.googleapis.com/auth/drive.file';
        const DISCOVERY_DOC = 'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest';
        const APP_FOLDER_NAME = 'ConferenceScheduler';
        
        let tokenClient;
        let gapiInited = false;
        let gisInited = false;
        let isGoogleLoggedIn = false;
        let currentDriveFileId = null;
        let autoSaveTimer = null;
        let hasUnsavedChanges = false;

        // Google API Ï¥àÍ∏∞Ìôî
        function gapiLoaded() {
            gapi.load('client', initializeGapiClient);
        }

        async function initializeGapiClient() {
            if (!GOOGLE_API_KEY) {
                console.log('API ÌÇ§Í∞Ä ÏÑ§Ï†ïÎêòÏßÄ ÏïäÏùå');
                return;
            }
            
            try {
                await gapi.client.init({
                    apiKey: GOOGLE_API_KEY,
                    discoveryDocs: [DISCOVERY_DOC],
                });
                gapiInited = true;
                console.log('GAPI client initialized');
                maybeEnableButtons();
            } catch (error) {
                console.error('GAPI Ï¥àÍ∏∞Ìôî Ïò§Î•ò:', error);
            }
        }

        function gisLoaded() {
            if (!GOOGLE_CLIENT_ID) {
                console.log('Client IDÍ∞Ä ÏÑ§Ï†ïÎêòÏßÄ ÏïäÏùå');
                return;
            }
            
            try {
                tokenClient = google.accounts.oauth2.initTokenClient({
                    client_id: GOOGLE_CLIENT_ID,
                    scope: SCOPES,
                    callback: '', // ÎÇòÏ§ëÏóê ÏÑ§Ï†ï
                });
                gisInited = true;
                console.log('GIS client initialized');
                maybeEnableButtons();
            } catch (error) {
                console.error('GIS Ï¥àÍ∏∞Ìôî Ïò§Î•ò:', error);
            }
        }

        function maybeEnableButtons() {
            if (gapiInited && gisInited) {
                // Ïù¥Ï†ÑÏóê Ï†ÄÏû•Îêú ÌÜ†ÌÅ∞ ÌôïÏù∏
                const savedToken = localStorage.getItem('google_access_token');
                if (savedToken) {
                    gapi.client.setToken({ access_token: savedToken });
                    validateToken(savedToken);
                }
            }
        }

        async function validateToken(token) {
            try {
                const response = await fetch(`https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=${token}`);
                if (response.ok) {
                    isGoogleLoggedIn = true;
                    updateGoogleAuthUI(true);
                    getUserInfo();
                } else {
                    localStorage.removeItem('google_access_token');
                }
            } catch (error) {
                console.error('ÌÜ†ÌÅ∞ Í≤ÄÏ¶ù Ïò§Î•ò:', error);
                localStorage.removeItem('google_access_token');
            }
        }

        // Google Î°úÍ∑∏Ïù∏/Î°úÍ∑∏ÏïÑÏõÉ
        function handleGoogleAuth() {
            if (isGoogleLoggedIn) {
                // Î°úÍ∑∏ÏïÑÏõÉ
                const token = gapi.client.getToken();
                if (token !== null) {
                    google.accounts.oauth2.revoke(token.access_token);
                    gapi.client.setToken('');
                    localStorage.removeItem('google_access_token');
                }
                isGoogleLoggedIn = false;
                updateGoogleAuthUI(false);
                updateSyncStatus('offline', 'Î°úÏª¨Ïóê Ï†ÄÏû•Îê®');
            } else {
                // Î°úÍ∑∏Ïù∏
                tokenClient.callback = async (resp) => {
                    if (resp.error !== undefined) {
                        console.error('Î°úÍ∑∏Ïù∏ Ïò§Î•ò:', resp);
                        return;
                    }
                    isGoogleLoggedIn = true;
                    localStorage.setItem('google_access_token', resp.access_token);
                    updateGoogleAuthUI(true);
                    getUserInfo();
                    updateSyncStatus('synced', 'Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞Í≤∞Îê®');
                };

                if (gapi.client.getToken() === null) {
                    tokenClient.requestAccessToken({ prompt: 'consent' });
                } else {
                    tokenClient.requestAccessToken({ prompt: '' });
                }
            }
        }

        async function getUserInfo() {
            try {
                const response = await fetch('https://www.googleapis.com/oauth2/v2/userinfo', {
                    headers: {
                        'Authorization': `Bearer ${gapi.client.getToken().access_token}`
                    }
                });
                const userInfo = await response.json();
                
                document.getElementById('googleUserAvatar').src = userInfo.picture || '';
                document.getElementById('googleUserName').textContent = userInfo.name || userInfo.email;
                document.getElementById('googleUserInfo').style.display = 'flex';
            } catch (error) {
                console.error('ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥ Ïò§Î•ò:', error);
            }
        }

        function updateGoogleAuthUI(loggedIn) {
            const btn = document.getElementById('googleAuthBtn');
            const userInfo = document.getElementById('googleUserInfo');
            
            if (loggedIn) {
                btn.textContent = 'üîì Î°úÍ∑∏ÏïÑÏõÉ';
                btn.style.background = '#f8f8f8';
            } else {
                btn.textContent = 'üîê Google Î°úÍ∑∏Ïù∏';
                btn.style.background = '';
                userInfo.style.display = 'none';
            }
        }

        // Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏åÏóê Ï†ÄÏû•
        async function saveToGoogleDrive() {
            if (!isGoogleLoggedIn) {
                // Î°úÍ∑∏Ïù∏ ÏïàÎê® - Î°úÏª¨ Îã§Ïö¥Î°úÎìúÎ°ú ÎåÄÏ≤¥
                saveToLocalFile();
                return;
            }

            updateSyncStatus('syncing', 'Ï†ÄÏû• Ï§ë...');

            try {
                const data = {
                    lectures: lectures,
                    schedule: schedule,
                    speakers: speakers,
                    categories: categories,
                    categoryColors: categoryColors,
                    sessions: sessions,
                    savedAt: new Date().toISOString(),
                    version: '2.1'
                };

                const jsonStr = JSON.stringify(data, null, 2);
                const blob = new Blob([jsonStr], { type: 'application/json' });

                // Ïï± Ï†ÑÏö© Ìè¥Îçî Ï∞æÍ∏∞/ÏÉùÏÑ±
                let folderId = await getOrCreateAppFolder();

                // ÌååÏùºÎ™Ö ÏÉùÏÑ±
                const date = new Date();
                const filename = `conference_schedule_${date.getFullYear()}${(date.getMonth()+1).toString().padStart(2,'0')}${date.getDate().toString().padStart(2,'0')}_${date.getHours().toString().padStart(2,'0')}${date.getMinutes().toString().padStart(2,'0')}.json`;

                // ÌååÏùº ÏóÖÎ°úÎìú
                const metadata = {
                    name: filename,
                    mimeType: 'application/json',
                    parents: [folderId]
                };

                const form = new FormData();
                form.append('metadata', new Blob([JSON.stringify(metadata)], { type: 'application/json' }));
                form.append('file', blob);

                const response = await fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', {
                    method: 'POST',
                    headers: new Headers({ 'Authorization': 'Bearer ' + gapi.client.getToken().access_token }),
                    body: form
                });

                const result = await response.json();
                
                if (result.id) {
                    currentDriveFileId = result.id;
                    hasUnsavedChanges = false;
                    const now = new Date().toLocaleTimeString('ko-KR');
                    updateSyncStatus('synced', `ÎìúÎùºÏù¥Î∏åÏóê Ï†ÄÏû•Îê® (${now})`);
                    console.log('Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ï†ÄÏû• ÏôÑÎ£å:', result.name);
                } else {
                    throw new Error('ÌååÏùº Ï†ÄÏû• Ïã§Ìå®');
                }
            } catch (error) {
                console.error('Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ï†ÄÏû• Ïò§Î•ò:', error);
                updateSyncStatus('offline', 'Ï†ÄÏû• Ïã§Ìå®');
                alert('‚ùå Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ï†ÄÏû• Ïã§Ìå®\n\n' + error.message);
            }
        }

        // Î°úÏª¨ ÌååÏùºÎ°ú Ï†ÄÏû• (Î∞±ÏóÖÏö©)
        function saveToLocalFile() {
            const data = {
                lectures: lectures,
                schedule: schedule,
                speakers: speakers,
                categories: categories,
                categoryColors: categoryColors,
                sessions: sessions,
                savedAt: new Date().toISOString(),
                version: '2.1'
            };

            const jsonStr = JSON.stringify(data, null, 2);
            const blob = new Blob([jsonStr], { type: 'application/json' });
            
            const date = new Date();
            const filename = `conference_schedule_${date.getFullYear()}${(date.getMonth()+1).toString().padStart(2,'0')}${date.getDate().toString().padStart(2,'0')}_${date.getHours().toString().padStart(2,'0')}${date.getMinutes().toString().padStart(2,'0')}.json`;
            
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            link.click();
            URL.revokeObjectURL(url);
            
            alert('‚úÖ ÌååÏùºÏù¥ Îã§Ïö¥Î°úÎìúÎêòÏóàÏäµÎãàÎã§!\n\nüìÅ ÌååÏùºÎ™Ö: ' + filename + '\n\nÍµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞ÎèôÏùÑ ÏõêÌïòÏãúÎ©¥\n"üîê Google Î°úÍ∑∏Ïù∏" Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌïòÏÑ∏Ïöî.');
        }

        // Ïï± Ï†ÑÏö© Ìè¥Îçî Ï∞æÍ∏∞/ÏÉùÏÑ±
        async function getOrCreateAppFolder() {
            try {
                // Í∏∞Ï°¥ Ìè¥Îçî Ï∞æÍ∏∞
                const response = await gapi.client.drive.files.list({
                    q: `name='${APP_FOLDER_NAME}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,
                    fields: 'files(id, name)'
                });

                if (response.result.files && response.result.files.length > 0) {
                    return response.result.files[0].id;
                }

                // Ìè¥Îçî ÏÉùÏÑ±
                const createResponse = await gapi.client.drive.files.create({
                    resource: {
                        name: APP_FOLDER_NAME,
                        mimeType: 'application/vnd.google-apps.folder'
                    },
                    fields: 'id'
                });

                return createResponse.result.id;
            } catch (error) {
                console.error('Ìè¥Îçî ÏÉùÏÑ± Ïò§Î•ò:', error);
                throw error;
            }
        }

        // Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏åÏóêÏÑú Î∂àÎü¨Ïò§Í∏∞
        async function loadFromGoogleDrive() {
            if (!isGoogleLoggedIn) {
                alert('‚ùå Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞ÎèôÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.\n\n"üîê Google Î°úÍ∑∏Ïù∏" Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            try {
                updateSyncStatus('syncing', 'ÌååÏùº Î™©Î°ù Î∂àÎü¨Ïò§Îäî Ï§ë...');
                
                // Ïï± Ìè¥Îçî Ï∞æÍ∏∞
                let folderId = await getOrCreateAppFolder();
                
                // ÌååÏùº Î™©Î°ù Ï°∞Ìöå
                const response = await gapi.client.drive.files.list({
                    q: `'${folderId}' in parents and mimeType='application/json' and trashed=false`,
                    fields: 'files(id, name, modifiedTime, size)',
                    orderBy: 'modifiedTime desc',
                    pageSize: 20
                });

                const files = response.result.files;
                
                if (!files || files.length === 0) {
                    updateSyncStatus('synced', 'Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞Í≤∞Îê®');
                    alert('üìÇ Ï†ÄÏû•Îêú ÌååÏùºÏù¥ ÏóÜÏäµÎãàÎã§.\n\n"üíæ ÎìúÎùºÏù¥Î∏åÏóê Ï†ÄÏû•" Î≤ÑÌäºÏúºÎ°ú Î®ºÏ†Ä Ï†ÄÏû•Ìï¥Ï£ºÏÑ∏Ïöî.');
                    return;
                }

                // ÌååÏùº Î™©Î°ù Î™®Îã¨ ÌëúÏãú
                showDriveFilesModal(files);
                updateSyncStatus('synced', 'Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞Í≤∞Îê®');
                
            } catch (error) {
                console.error('ÌååÏùº Î™©Î°ù Ï°∞Ìöå Ïò§Î•ò:', error);
                updateSyncStatus('offline', 'Ïò§Î•ò Î∞úÏÉù');
                alert('‚ùå ÌååÏùº Î™©Î°ùÏùÑ Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§.\n\n' + error.message);
            }
        }

        // ÌååÏùº Î™©Î°ù Î™®Îã¨ ÌëúÏãú
        function showDriveFilesModal(files) {
            const container = document.getElementById('driveFilesList');
            
            container.innerHTML = files.map(file => {
                const modifiedDate = new Date(file.modifiedTime).toLocaleString('ko-KR');
                const fileSize = file.size ? (parseInt(file.size) / 1024).toFixed(1) + ' KB' : '';
                
                return `
                    <div class="speaker-item" style="cursor: pointer;" onclick="loadDriveFile('${file.id}', '${file.name}')">
                        <div class="speaker-info">
                            <strong>üìÑ ${file.name}</strong>
                            <small>üìÖ ${modifiedDate} ${fileSize ? '¬∑ ' + fileSize : ''}</small>
                        </div>
                        <div class="speaker-actions">
                            <button class="btn btn-primary btn-small" onclick="event.stopPropagation(); loadDriveFile('${file.id}', '${file.name}')">Î∂àÎü¨Ïò§Í∏∞</button>
                            <button class="btn btn-secondary btn-small" onclick="event.stopPropagation(); deleteDriveFile('${file.id}', '${file.name}')">ÏÇ≠Ï†ú</button>
                        </div>
                    </div>
                `;
            }).join('');

            document.getElementById('driveFilesModal').classList.add('active');
        }

        // ÎìúÎùºÏù¥Î∏å ÌååÏùº Î∂àÎü¨Ïò§Í∏∞
        async function loadDriveFile(fileId, fileName) {
            try {
                updateSyncStatus('syncing', 'ÌååÏùº Î∂àÎü¨Ïò§Îäî Ï§ë...');
                closeDriveFilesModal();

                const response = await gapi.client.drive.files.get({
                    fileId: fileId,
                    alt: 'media'
                });

                const data = JSON.parse(response.body);

                // Îç∞Ïù¥ÌÑ∞ Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨
                if (!data.lectures || !data.schedule || !data.speakers) {
                    throw new Error('Ïò¨Î∞îÎ•∏ ÌòïÏãùÏùò ÌååÏùºÏù¥ ÏïÑÎãôÎãàÎã§.');
                }

                // Îç∞Ïù¥ÌÑ∞ Î°úÎìú
                lectures = data.lectures;
                schedule = data.schedule;
                speakers = data.speakers;
                
                // Ïπ¥ÌÖåÍ≥†Î¶¨ Î∂àÎü¨Ïò§Í∏∞ (ÏûàÏúºÎ©¥)
                if (data.categories) {
                    categories = data.categories;
                }
                if (data.categoryColors) {
                    Object.assign(categoryColors, data.categoryColors);
                }
                // ÏÑ∏ÏÖò Î∂àÎü¨Ïò§Í∏∞ (ÏûàÏúºÎ©¥)
                if (data.sessions) {
                    sessions = data.sessions;
                }
                currentDriveFileId = fileId;

                // Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄÏóêÎèÑ Ï†ÄÏû•
                saveToLocalStorage();

                // UI ÏóÖÎç∞Ïù¥Ìä∏
                updateCategoryDropdowns();
                createCategoryFilters();
                updateLectureList();
                updateScheduleDisplay();
                renderSessionBars();

                hasUnsavedChanges = false;
                const now = new Date().toLocaleTimeString('ko-KR');
                updateSyncStatus('synced', `ÎìúÎùºÏù¥Î∏åÏóêÏÑú Î∂àÎü¨Ïò¥ (${now})`);
                
                alert(`‚úÖ "${fileName}" ÌååÏùºÏùÑ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Î∂àÎü¨ÏôîÏäµÎãàÎã§!\n\nüìö Í∞ïÏùò: ${lectures.length}Í∞ú\nüë• Ïó∞Ïûê: ${speakers.length}Î™Ö\nüìä ÏãúÍ∞ÑÌëú: ${Object.keys(schedule).length}Í∞ú Î∞∞Ïπò`);

            } catch (error) {
                console.error('ÌååÏùº Î∂àÎü¨Ïò§Í∏∞ Ïò§Î•ò:', error);
                updateSyncStatus('offline', 'Î∂àÎü¨Ïò§Í∏∞ Ïã§Ìå®');
                alert('‚ùå ÌååÏùºÏùÑ Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§.\n\n' + error.message);
            }
        }

        // ÎìúÎùºÏù¥Î∏å ÌååÏùº ÏÇ≠Ï†ú
        async function deleteDriveFile(fileId, fileName) {
            if (!confirm(`"${fileName}" ÌååÏùºÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?\n\nÏù¥ ÏûëÏóÖÏùÄ ÎêòÎèåÎ¶¥ Ïàò ÏóÜÏäµÎãàÎã§.`)) {
                return;
            }

            try {
                await gapi.client.drive.files.delete({
                    fileId: fileId
                });

                alert(`‚úÖ "${fileName}" ÌååÏùºÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.`);
                
                // Î™©Î°ù ÏÉàÎ°úÍ≥†Ïπ®
                loadFromGoogleDrive();
                
            } catch (error) {
                console.error('ÌååÏùº ÏÇ≠Ï†ú Ïò§Î•ò:', error);
                alert('‚ùå ÌååÏùº ÏÇ≠Ï†ú Ïã§Ìå®\n\n' + error.message);
            }
        }

        function closeDriveFilesModal() {
            document.getElementById('driveFilesModal').classList.remove('active');
        }

        // ÏûêÎèô Ï†ÄÏû• (Î≥ÄÍ≤Ω Í∞êÏßÄ)
        function markAsChanged() {
            hasUnsavedChanges = true;
            saveToLocalStorage();
            
            if (isGoogleLoggedIn) {
                updateSyncStatus('syncing', 'Ï†ÄÏû•ÎêòÏßÄ ÏïäÏùÄ Î≥ÄÍ≤ΩÏÇ¨Ìï≠');
                
                // 30Ï¥à ÌõÑ ÏûêÎèô Ï†ÄÏû•
                if (autoSaveTimer) clearTimeout(autoSaveTimer);
                autoSaveTimer = setTimeout(() => {
                    if (hasUnsavedChanges && isGoogleLoggedIn) {
                        saveToGoogleDrive();
                    }
                }, 30000);
            }
        }

        // API ÏÑ§Ï†ï Î™®Îã¨
        function openApiSetupModal() {
            document.getElementById('apiClientId').value = GOOGLE_CLIENT_ID;
            document.getElementById('apiKey').value = GOOGLE_API_KEY;
            document.getElementById('apiSetupModal').classList.add('active');
        }

        function closeApiSetupModal() {
            document.getElementById('apiSetupModal').classList.remove('active');
        }

        function saveApiSettings() {
            const clientId = document.getElementById('apiClientId').value.trim();
            const apiKey = document.getElementById('apiKey').value.trim();

            if (!clientId || !apiKey) {
                alert('Client IDÏôÄ API KeyÎ•º Î™®Îëê ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            localStorage.setItem('google_client_id', clientId);
            localStorage.setItem('google_api_key', apiKey);
            
            GOOGLE_CLIENT_ID = clientId;
            GOOGLE_API_KEY = apiKey;

            closeApiSetupModal();
            alert('‚úÖ API ÏÑ§Ï†ïÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.\n\nÌéòÏù¥ÏßÄÎ•º ÏÉàÎ°úÍ≥†Ïπ®Ìï©ÎãàÎã§.');
            location.reload();
        }

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Google API Ï¥àÍ∏∞Ìôî
        window.onload = function() {
            if (typeof gapi !== 'undefined') {
                gapiLoaded();
            }
            if (typeof google !== 'undefined' && google.accounts) {
                gisLoaded();
            }
        };

        // Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄÏóêÏÑú Îç∞Ïù¥ÌÑ∞ Î∂àÎü¨Ïò§Í∏∞
        function loadFromLocalStorage() {
            try {
                const savedLectures = localStorage.getItem('conference_lectures');
                const savedSchedule = localStorage.getItem('conference_schedule');
                const savedSpeakers = localStorage.getItem('conference_speakers');
                const savedCategories = localStorage.getItem('conference_categories');
                const savedSessions = localStorage.getItem('conference_sessions');

                if (savedLectures) {
                    lectures = JSON.parse(savedLectures);
                    console.log('Í∞ïÏùò Î™©Î°ù Î∂àÎü¨Ïò¥:', lectures.length + 'Í∞ú');
                }

                if (savedSchedule) {
                    schedule = JSON.parse(savedSchedule);
                    console.log('ÏãúÍ∞ÑÌëú Î∂àÎü¨Ïò¥');
                }

                if (savedSpeakers) {
                    speakers = JSON.parse(savedSpeakers);
                    console.log('Ïó∞Ïûê Î™©Î°ù Î∂àÎü¨Ïò¥:', speakers.length + 'Î™Ö');
                } else {
                    // Ï≤òÏùå Ïã§Ìñâ Ïãú Í∏∞Î≥∏ Ïó∞Ïûê Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©
                    speakers = [...SPEAKERS_DATA];
                    saveToLocalStorage(); // Í∏∞Î≥∏ Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                }

                if (savedCategories) {
                    categories = JSON.parse(savedCategories);
                    console.log('Î∂ÑÎ•ò Î™©Î°ù Î∂àÎü¨Ïò¥:', categories.length + 'Í∞ú');
                }

                if (savedSessions) {
                    sessions = JSON.parse(savedSessions);
                    console.log('ÏÑ∏ÏÖò Î™©Î°ù Î∂àÎü¨Ïò¥:', sessions.length + 'Í∞ú');
                }
            } catch (error) {
                console.error('Îç∞Ïù¥ÌÑ∞ Î∂àÎü¨Ïò§Í∏∞ Ïò§Î•ò:', error);
                speakers = [...SPEAKERS_DATA];
            }
        }

        // Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄÏóê Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
        function saveToLocalStorage() {
            try {
                localStorage.setItem('conference_lectures', JSON.stringify(lectures));
                localStorage.setItem('conference_schedule', JSON.stringify(schedule));
                localStorage.setItem('conference_speakers', JSON.stringify(speakers));
                localStorage.setItem('conference_categories', JSON.stringify(categories));
                localStorage.setItem('conference_sessions', JSON.stringify(sessions));
                console.log('Î°úÏª¨ Ï†ÄÏû• ÏôÑÎ£å');
            } catch (error) {
                console.error('Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• Ïò§Î•ò:', error);
                alert('Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
            }
        }
        
        // saveAndSyncÎäî ÏúÑÏóêÏÑú Ï†ïÏùòÎê® - Ï§ëÎ≥µ Ï†úÍ±∞

        // Î™®Îì† Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî
        function resetAllData() {
            // Í¥ÄÎ¶¨ÏûêÎßå Ï¥àÍ∏∞Ìôî Í∞ÄÎä•
            if (currentUserRole !== 'admin') {
                alert('‚õî Ï¥àÍ∏∞ÌôîÎäî Í¥ÄÎ¶¨ÏûêÎßå ÏàòÌñâÌï† Ïàò ÏûàÏäµÎãàÎã§.');
                return;
            }
            
            if (!confirm('‚ö†Ô∏è Ï†ïÎßêÎ°ú Î™®Îì† Îç∞Ïù¥ÌÑ∞Î•º Ï¥àÍ∏∞ÌôîÌïòÏãúÍ≤†ÏäµÎãàÍπå?\n\n‚Ä¢ Î™®Îì† Í∞ïÏùò\n‚Ä¢ Î™®Îì† ÏãúÍ∞ÑÌëú Î∞∞Ïπò\n‚Ä¢ Î™®Îì† ÏÑ∏ÏÖò\n‚Ä¢ Î™®Îì† Ïó∞Ïûê\n\nÏù¥ ÏûëÏóÖÏùÄ ÎêòÎèåÎ¶¥ Ïàò ÏóÜÏäµÎãàÎã§!')) {
                return;
            }
            
            // 2Ï∞® ÌôïÏù∏
            const confirmText = prompt('Ï¥àÍ∏∞ÌôîÎ•º ÏßÑÌñâÌïòÎ†§Î©¥ "Ï¥àÍ∏∞Ìôî"Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî:');
            if (confirmText !== 'Ï¥àÍ∏∞Ìôî') {
                alert('Ï¥àÍ∏∞ÌôîÍ∞Ä Ï∑®ÏÜåÎêòÏóàÏäµÎãàÎã§.');
                return;
            }
            
            // Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄ ÏÇ≠Ï†ú
            localStorage.removeItem('conference_data_by_date');
            localStorage.removeItem('conference_current_date');
            localStorage.removeItem('conference_speakers');
            localStorage.removeItem('conference_categories');
            
            // Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî
            dataByDate = {
                '2026-04-11': { lectures: [], schedule: {}, sessions: [] },
                '2026-04-12': { lectures: [], schedule: {}, sessions: [] }
            };
            lectures = [];
            schedule = {};
            sessions = [];
            speakers = [...SPEAKERS_DATA];
            currentDate = '2026-04-11';
            rooms = ROOMS_BY_DATE[currentDate];
            
            // FirebaseÏóêÎèÑ Ï¥àÍ∏∞ÌôîÎêú Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
            saveToFirebase();
            
            saveAllDataToStorage();
            updateLectureList();
            createScheduleTable();
            
            alert('‚úÖ Î™®Îì† Îç∞Ïù¥ÌÑ∞Í∞Ä Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§.');
            location.reload();
        }

        const categoryColors = {
            'Aesthetic Devices': '#3498DB',
            'AI & CRM': '#00BCD4',
            'Anatomy': '#9C27B0',
            'ASLS': '#03A9F4',
            'Bio-Stimulators': '#9B59B6',
            'Body Contouring': '#FF5722',
            'Consumables': '#607D8B',
            'Cosmeceuticals': '#F39C12',
            'Dermatology': '#E91E63',
            'Diagnostic Devices': '#1ABC9C',
            'Digital Solutions': '#00ACC1',
            'Hair': '#795548',
            'Injectables': '#FF9500',
            'International Faculty & Global Trends': '#673AB7',
            'Laser & EBDs': '#FF6B9D',
            'Lifting Devices': '#56CCF2',
            'Management & Marketing': '#8BC34A',
            'Medical Supplies': '#26A69A',
            'Other Solutions': '#8D6E63',
            'Others': '#78909C',
            'Regeneratives': '#2ECC71',
            'Safety Equipment': '#4CAF50',
            'Sedation & Analgesia Devices': '#FFC107',
            'Stem Cell & Functional': '#7E57C2',
            'Threads': '#E74C3C'
        };
        
        // Ïπ¥ÌÖåÍ≥†Î¶¨ Î™©Î°ù (ÏàòÏ†ï Í∞ÄÎä•)
        let categories = Object.keys(categoryColors).sort();

        // ÏãúÍ∞Ñ ÏÑ§Ï†ï (5Î∂Ñ Îã®ÏúÑ, 08:30~17:00)
        const START_HOUR = 8;
        const START_MIN = 30;
        const END_HOUR = 17;
        const END_MIN = 0;
        const TIME_UNIT = 5; // 5Î∂Ñ Îã®ÏúÑ
        
        // Í∞ïÏùò ÏãúÍ∞Ñ ÏòµÏÖò (Î∂Ñ)
        let durationOptions = [10, 15, 20, 30, 40, 50, 60];

        for (let hour = START_HOUR; hour <= END_HOUR; hour++) {
            const startMin = (hour === START_HOUR) ? START_MIN : 0;
            const endMin = (hour === END_HOUR) ? END_MIN : 60;
            for (let min = startMin; min < endMin; min += TIME_UNIT) {
                const time = `${hour.toString().padStart(2, '0')}:${min.toString().padStart(2, '0')}`;
                timeSlots.push(time);
            }
        }

        function createCategoryFilters() {
            const container = document.getElementById('categoryFilters');
            container.innerHTML = '';
            
            // Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ Í∞ïÏùò Í∞úÏàò Í≥ÑÏÇ∞
            const categoryCounts = {};
            lectures.forEach(lecture => {
                const cat = lecture.category || 'Others';
                categoryCounts[cat] = (categoryCounts[cat] || 0) + 1;
            });
            const totalCount = lectures.length;

            const allBtn = document.createElement('button');
            allBtn.className = 'category-filter-btn active';
            allBtn.style.borderColor = '#2E1A47';
            allBtn.style.background = '#2E1A47';
            allBtn.style.color = '#FFFFFF';
            allBtn.innerHTML = `Ï†ÑÏ≤¥<span class="category-count">${totalCount}</span>`;
            allBtn.onclick = () => filterLectures('all');
            container.appendChild(allBtn);

            Object.keys(categoryColors).forEach(category => {
                const count = categoryCounts[category] || 0;
                const btn = document.createElement('button');
                btn.className = 'category-filter-btn';
                const color = categoryColors[category];
                btn.style.borderColor = color;
                btn.style.color = color;
                btn.innerHTML = `${category}${count > 0 ? `<span class="category-count" style="background:${color};">${count}</span>` : ''}`;
                btn.onclick = () => filterLectures(category);
                btn.dataset.category = category;
                container.appendChild(btn);
            });
        }

        function filterLectures(category) {
            activeFilter = category;
            
            document.querySelectorAll('.category-filter-btn').forEach(btn => {
                btn.classList.remove('active');
                const isAllBtn = btn.innerHTML.includes('Ï†ÑÏ≤¥');
                
                if (category === 'all' && isAllBtn) {
                    btn.classList.add('active');
                    btn.style.background = '#2E1A47';
                    btn.style.color = '#FFFFFF';
                } else if (btn.dataset.category === category) {
                    btn.classList.add('active');
                    const color = categoryColors[category];
                    btn.style.background = color;
                    btn.style.color = '#FFFFFF';
                } else {
                    btn.style.background = '#FFFFFF';
                    const cat = btn.dataset.category;
                    if (cat && categoryColors[cat]) {
                        btn.style.color = categoryColors[cat];
                    } else if (isAllBtn) {
                        btn.style.color = '#2E1A47';
                    }
                }
            });

            updateLectureList();
        }

        const speakerInput = document.getElementById('speakerKo');
        const autocompleteList = document.getElementById('autocompleteList');
        let autocompleteIndex = -1;
        let currentMatches = [];
        
        function updateAutocomplete() {
            const value = speakerInput.value.trim();
            autocompleteIndex = -1;
            
            if (!value) {
                autocompleteList.classList.remove('active');
                autocompleteList.innerHTML = '';
                currentMatches = [];
                return;
            }

            currentMatches = speakers.filter(s => {
                const searchValue = value.toLowerCase();
                return s.name.toLowerCase().includes(searchValue) || 
                       s.affiliation.toLowerCase().includes(searchValue);
            });

            if (currentMatches.length > 0) {
                renderAutocompleteList();
                autocompleteList.classList.add('active');
            } else {
                autocompleteList.classList.remove('active');
                autocompleteList.innerHTML = '';
            }
        }

        function renderAutocompleteList() {
            autocompleteList.innerHTML = currentMatches.map((s, idx) => {
                const isSelected = idx === autocompleteIndex;
                return `<div class="autocomplete-item ${isSelected ? 'selected' : ''}" 
                            onclick="selectSpeaker(${speakers.indexOf(s)})"
                            data-index="${idx}">
                    <strong>${s.name}</strong>
                    <small>${s.affiliation}</small>
                </div>`;
            }).join('');
        }

        speakerInput.addEventListener('input', updateAutocomplete);
        speakerInput.addEventListener('compositionend', updateAutocomplete);

        // ÌÇ§Î≥¥Îìú ÌôîÏÇ¥Ìëú Î∞è Enter ÏßÄÏõê
        speakerInput.addEventListener('keydown', function(e) {
            if (!autocompleteList.classList.contains('active')) return;
            
            if (e.key === 'ArrowDown') {
                e.preventDefault();
                autocompleteIndex = Math.min(autocompleteIndex + 1, currentMatches.length - 1);
                renderAutocompleteList();
                scrollToSelected();
            } else if (e.key === 'ArrowUp') {
                e.preventDefault();
                autocompleteIndex = Math.max(autocompleteIndex - 1, 0);
                renderAutocompleteList();
                scrollToSelected();
            } else if (e.key === 'Enter') {
                e.preventDefault();
                if (autocompleteIndex >= 0 && autocompleteIndex < currentMatches.length) {
                    const selectedSpeaker = currentMatches[autocompleteIndex];
                    selectSpeaker(speakers.indexOf(selectedSpeaker));
                }
            } else if (e.key === 'Escape') {
                autocompleteList.classList.remove('active');
                autocompleteList.innerHTML = '';
                autocompleteIndex = -1;
            }
        });

        function scrollToSelected() {
            const selectedItem = autocompleteList.querySelector('.autocomplete-item.selected');
            if (selectedItem) {
                selectedItem.scrollIntoView({ block: 'nearest' });
            }
        }

        document.addEventListener('click', function(e) {
            if (!e.target.closest('.autocomplete-container')) {
                autocompleteList.classList.remove('active');
                autocompleteIndex = -1;
            }
        });

        function selectSpeaker(index) {
            const speaker = speakers[index];
            document.getElementById('speakerKo').value = speaker.name;
            document.getElementById('speakerEn').value = speaker.nameEn || '';
            document.getElementById('affiliation').value = speaker.affiliation;
            autocompleteList.classList.remove('active');
            autocompleteList.innerHTML = '';
            autocompleteIndex = -1;
            currentMatches = [];
        }

        function createScheduleTable() {
            const container = document.getElementById('scheduleTable');
            container.innerHTML = '';
            
            // HTML ÌÖåÏù¥Î∏î ÏÉùÏÑ±
            const table = document.createElement('table');
            table.className = 'schedule-table';
            
            // Ìó§Îçî Ìñâ (thead)
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            
            // ÏãúÍ∞Ñ Ìó§Îçî
            const timeHeader = document.createElement('th');
            timeHeader.textContent = 'ÏãúÍ∞Ñ';
            headerRow.appendChild(timeHeader);
            
            // Î£∏ Ìó§ÎçîÎì§
            rooms.forEach((room, roomIndex) => {
                const roomHeader = document.createElement('th');
                roomHeader.style.position = 'relative';
                
                // ÏàòÏ†ï Í∞ÄÎä•Ìïú input
                const roomInput = document.createElement('input');
                roomInput.type = 'text';
                roomInput.value = room;
                roomInput.title = 'ÌÅ¥Î¶≠ÌïòÏó¨ Î£∏ Ïù¥Î¶Ñ ÏàòÏ†ï';
                roomInput.style.cssText = 'background:transparent;border:none;color:white;font-weight:700;text-align:center;width:100%;font-size:0.8rem;';
                
                roomInput.addEventListener('change', function() {
                    const oldName = rooms[roomIndex];
                    const newName = this.value.trim();
                    if (newName && newName !== oldName) {
                        updateRoomNameInData(oldName, newName);
                        rooms[roomIndex] = newName;
                        saveRoomsToStorage();
                        updateScheduleDisplay();
                    } else {
                        this.value = oldName;
                    }
                });
                
                // ÏÇ≠Ï†ú Î≤ÑÌäº (2Í∞ú Ïù¥ÏÉÅÏùº ÎïåÎßå)
                if (rooms.length > 1) {
                    const deleteBtn = document.createElement('button');
                    deleteBtn.textContent = '√ó';
                    deleteBtn.style.cssText = 'position:absolute;top:2px;right:2px;background:rgba(255,255,255,0.3);border:none;color:white;width:18px;height:18px;border-radius:50%;cursor:pointer;font-size:0.7rem;';
                    deleteBtn.onclick = (e) => {
                        e.stopPropagation();
                        if (confirm(`"${room}" Î£∏ÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?\nÌï¥Îãπ Î£∏Ïùò Î™®Îì† Í∞ïÏùòÏôÄ ÏÑ∏ÏÖòÏù¥ ÏÇ≠Ï†úÎê©ÎãàÎã§.`)) {
                            deleteRoom(roomIndex);
                        }
                    };
                    roomHeader.appendChild(deleteBtn);
                }
                
                roomHeader.appendChild(roomInput);
                headerRow.appendChild(roomHeader);
            });
            
            thead.appendChild(headerRow);
            table.appendChild(thead);
            
            // Î≥∏Î¨∏ (tbody)
            const tbody = document.createElement('tbody');
            
            timeSlots.forEach((time, timeIndex) => {
                const [hour, min] = time.split(':').map(Number);
                const row = document.createElement('tr');
                
                // ÏãúÍ∞Ñ ÏÖÄ
                const timeCell = document.createElement('td');
                let timeCellClass = '';
                let showTime = false;
                
                if (min === 0 || min === 30) {
                    timeCellClass = 'hour-mark';
                    showTime = true;
                } else if (min === 15 || min === 45) {
                    timeCellClass = 'quarter-mark';
                    showTime = true;
                } else {
                    timeCellClass = 'five-min';
                }
                
                timeCell.className = timeCellClass;
                timeCell.innerHTML = `<span class="time-label">${showTime ? time : ''}</span>`;
                row.appendChild(timeCell);
                
                // Í∞Å Î£∏ ÏÖÄ
                rooms.forEach(room => {
                    const cell = document.createElement('td');
                    let cellClass = 'schedule-cell';
                    
                    if (min === 0 || min === 30) {
                        cellClass += ' hour-mark';
                    } else if (min === 15 || min === 45) {
                        cellClass += ' quarter-mark';
                    } else {
                        cellClass += ' five-min';
                    }
                    
                    cell.className = cellClass;
                    cell.dataset.time = time;
                    cell.dataset.room = room;
                    cell.dataset.timeIndex = timeIndex;
                    
                    // 30Î∂Ñ Îã®ÏúÑÏóêÎßå ÏÑ∏ÏÖò Ï∂îÍ∞Ä Î≤ÑÌäº
                    if (min === 0 || min === 30) {
                        const addSessionBtn = document.createElement('button');
                        addSessionBtn.className = 'add-session-btn';
                        addSessionBtn.textContent = '+ ÏÑ∏ÏÖò';
                        addSessionBtn.onclick = (e) => {
                            e.stopPropagation();
                            openCellSessionModal(time, room);
                        };
                        cell.appendChild(addSessionBtn);
                    }
                    
                    cell.addEventListener('dragover', handleDragOver);
                    cell.addEventListener('dragleave', handleDragLeave);
                    cell.addEventListener('drop', handleDrop);
                    
                    row.appendChild(cell);
                });
                
                tbody.appendChild(row);
            });
            
            table.appendChild(tbody);
            container.appendChild(table);

            updateScheduleDisplay();
        }
        
        // Î£∏ Í¥ÄÎ¶¨ Ìï®ÏàòÎì§
        function addRoom() {
            const newRoomName = prompt('ÏÉà Î£∏ Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî:', `Î£∏${rooms.length + 1}`);
            if (newRoomName && newRoomName.trim()) {
                rooms.push(newRoomName.trim());
                saveRoomsToStorage();
                createScheduleTable();
            }
        }
        
        function deleteRoom(roomIndex) {
            const roomName = rooms[roomIndex];
            
            // Ìï¥Îãπ Î£∏Ïùò Í∞ïÏùòÏôÄ ÏÑ∏ÏÖò ÏÇ≠Ï†ú
            Object.keys(schedule).forEach(key => {
                if (key.includes(`-${roomName}`)) {
                    delete schedule[key];
                }
            });
            sessions = sessions.filter(s => s.room !== roomName);
            
            rooms.splice(roomIndex, 1);
            saveRoomsToStorage();
            saveAndSync();
            createScheduleTable();
        }
        
        function updateRoomNameInData(oldName, newName) {
            // Ïä§ÏºÄÏ§Ñ ÏóÖÎç∞Ïù¥Ìä∏
            const newSchedule = {};
            Object.entries(schedule).forEach(([key, value]) => {
                const newKey = key.replace(`-${oldName}`, `-${newName}`);
                newSchedule[newKey] = value;
            });
            schedule = newSchedule;
            
            // ÏÑ∏ÏÖò ÏóÖÎç∞Ïù¥Ìä∏
            sessions.forEach(s => {
                if (s.room === oldName) {
                    s.room = newName;
                }
            });
            
            saveAndSync();
        }
        
        function saveRoomsToStorage() {
            localStorage.setItem('conference_rooms', JSON.stringify(rooms));
        }
        
        function loadRoomsFromStorage() {
            const saved = localStorage.getItem('conference_rooms');
            if (saved) {
                const parsedRooms = JSON.parse(saved);
                if (parsedRooms && parsedRooms.length > 0) {
                    rooms = parsedRooms;
                }
            }
            // Ï†ÄÏû•Îêú Î£∏Ïù¥ ÏóÜÏúºÎ©¥ Í∏∞Î≥∏Í∞í Ïú†ÏßÄ
        }
        
        // Í∏∞Î≥∏ Î£∏ Î™©Î°ù
        const DEFAULT_ROOMS = ['Í∏∞Ï¥à', 'Ïã¨ÌôîÎ†àÏù¥Ï†Ä', 'Ïã¨ÌôîÏÅòÎù†', 'ÏàòÏà†', 'Í∞úÏõê', 'Î£∏A', 'Î£∏B', 'Î£∏C', 'Î©îÏù∏ÌôÄ'];
        
        // ÎìúÎûòÍ∑∏ Ìà¥ÌåÅ ÏÉùÏÑ±/ÏóÖÎç∞Ïù¥Ìä∏
        let dragTooltip = null;
        
        function createDragTooltip() {
            if (!dragTooltip) {
                dragTooltip = document.createElement('div');
                dragTooltip.className = 'drag-tooltip';
                dragTooltip.style.display = 'none';
                document.body.appendChild(dragTooltip);
            }
            return dragTooltip;
        }
        
        function updateDragTooltip(e, startTime, duration) {
            const tooltip = createDragTooltip();
            const endTime = addMinutesToTime(startTime, duration);
            tooltip.innerHTML = `
                <div class="time-info">üìç ${startTime} ~ ${endTime}</div>
                <div>(${duration}Î∂Ñ)</div>
            `;
            tooltip.style.display = 'block';
            tooltip.style.left = (e.clientX + 15) + 'px';
            tooltip.style.top = (e.clientY + 15) + 'px';
        }
        
        function hideDragTooltip() {
            if (dragTooltip) {
                dragTooltip.style.display = 'none';
            }
        }
        
        function addMinutesToTime(timeStr, minutes) {
            const [hour, min] = timeStr.split(':').map(Number);
            const totalMin = hour * 60 + min + minutes;
            const newHour = Math.floor(totalMin / 60);
            const newMin = totalMin % 60;
            return `${newHour.toString().padStart(2, '0')}:${newMin.toString().padStart(2, '0')}`;
        }

        document.getElementById('addLectureBtn').addEventListener('click', async function() {
            const form = document.getElementById('lectureForm');
            
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            const speakerKoValue = document.getElementById('speakerKo').value.trim();
            
            // Ïó∞Ïûê Ïù¥Î¶ÑÏù¥ ÎπÑÏñ¥ÏûàÏúºÎ©¥ Î∞îÎ°ú Ï∂îÍ∞Ä
            if (!speakerKoValue) {
                addLectureToList();
                return;
            }
            
            const speakerExists = speakers.find(s => s.name.toLowerCase() === speakerKoValue.toLowerCase());

            if (!speakerExists) {
                // Ïó∞ÏûêÍ∞Ä Î™©Î°ùÏóê ÏóÜÏùÑ Îïå
                pendingSpeakerInfo = {
                    name: speakerKoValue,
                    nameEn: document.getElementById('speakerEn').value.trim() || '',
                    affiliation: document.getElementById('affiliation').value.trim() || '',
                    affiliationEn: ''
                };

                document.getElementById('confirmMessage').textContent = 
                    `"${speakerKoValue}" Ïó∞ÏûêÍ∞Ä Î™©Î°ùÏóê ÏóÜÏäµÎãàÎã§. Ïó∞Ïûê Î™©Î°ùÏóê Ï∂îÍ∞ÄÌïòÏãúÍ≤†ÏäµÎãàÍπå?`;
                document.getElementById('confirmAddSpeakerModal').classList.add('active');
                return;
            }

            addLectureToList();
        });

        function closeConfirmAddSpeaker() {
            document.getElementById('confirmAddSpeakerModal').classList.remove('active');
            // Ïó∞Ïûê Î™©Î°ùÏóê Ï∂îÍ∞ÄÌïòÏßÄ ÏïäÎçîÎùºÎèÑ Í∞ïÏùòÎäî Ï∂îÍ∞Ä
            if (pendingSpeakerInfo) {
                addLectureToList();
            }
            pendingSpeakerInfo = null;
        }

        function confirmAddNewSpeaker() {
            if (pendingSpeakerInfo) {
                speakers.push(pendingSpeakerInfo);
                saveAndSync(); // Ï†ÄÏû• Î∞è ÎèôÍ∏∞Ìôî
                updateSpeakerList();
                
                document.getElementById('speakerEn').value = pendingSpeakerInfo.nameEn;
                document.getElementById('confirmAddSpeakerModal').classList.remove('active');
                pendingSpeakerInfo = null;
                
                addLectureToList();
            }
        }

        function addLectureToList() {
            // Í∂åÌïú Ï≤¥ÌÅ¨
            if (!checkEditPermission()) return;
            
            const speakerKo = document.getElementById('speakerKo').value.trim();
            const speakerEn = document.getElementById('speakerEn').value.trim();
            const affiliation = document.getElementById('affiliation').value.trim();
            
            // Ïó∞Ïûê Î™©Î°ùÏóêÏÑú Ìï¥Îãπ Ïó∞Ïûê Ï∞æÍ∏∞
            const existingSpeaker = speakers.find(s => s.name === speakerKo);
            
            if (existingSpeaker) {
                // ÏòÅÎ¨∏Î™ÖÏù¥ÎÇò ÏÜåÏÜçÏù¥ Î≥ÄÍ≤ΩÎêòÏóàÎäîÏßÄ ÌôïÏù∏
                const isEnChanged = speakerEn && existingSpeaker.nameEn !== speakerEn;
                const isAffChanged = affiliation && existingSpeaker.affiliation !== affiliation;
                
                if (isEnChanged || isAffChanged) {
                    let changeDetails = [];
                    if (isEnChanged) changeDetails.push(`ÏòÅÎ¨∏Î™Ö: ${existingSpeaker.nameEn || '(ÏóÜÏùå)'} ‚Üí ${speakerEn}`);
                    if (isAffChanged) changeDetails.push(`ÏÜåÏÜç: ${existingSpeaker.affiliation || '(ÏóÜÏùå)'} ‚Üí ${affiliation}`);
                    
                    const updateSpeaker = confirm(`Ïó∞Ïûê Ï†ïÎ≥¥Í∞Ä Î≥ÄÍ≤ΩÎêòÏóàÏäµÎãàÎã§.\n\n${changeDetails.join('\n')}\n\nÏó∞Ïûê Î™©Î°ùÎèÑ ÏóÖÎç∞Ïù¥Ìä∏ÌïòÏãúÍ≤†ÏäµÎãàÍπå?`);
                    
                    if (updateSpeaker) {
                        if (isEnChanged) existingSpeaker.nameEn = speakerEn;
                        if (isAffChanged) existingSpeaker.affiliation = affiliation;
                        saveSpeakersToStorage();
                        console.log('Ïó∞Ïûê Ï†ïÎ≥¥Í∞Ä ÏóÖÎç∞Ïù¥Ìä∏ÎêòÏóàÏäµÎãàÎã§.');
                    }
                }
            }
            
            const lecture = {
                id: Date.now(),
                category: document.getElementById('category').value,
                titleKo: document.getElementById('titleKo').value,
                titleEn: document.getElementById('titleEn').value,
                speakerKo: speakerKo,
                speakerEn: speakerEn,
                affiliation: affiliation,
                duration: parseInt(document.getElementById('lectureDuration').value) || 15,
                // Ïä§Ìè∞ÏÑú/Ï†úÌíà Ï†ïÎ≥¥
                companyName: document.getElementById('companyName').value.trim(),
                productName: document.getElementById('productName').value.trim(),
                productDescription: document.getElementById('productDescription').value.trim()
            };
            
            lectures.push(lecture);
            saveCurrentDateData(); // ÌòÑÏû¨ ÎÇ†Ïßú Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
            updateLectureList();
            
            document.getElementById('category').value = '';
            document.getElementById('titleKo').value = '';
            document.getElementById('titleEn').value = '';
            document.getElementById('speakerKo').value = '';
            document.getElementById('speakerEn').value = '';
            document.getElementById('affiliation').value = '';
            document.getElementById('lectureDuration').value = '15';
            document.getElementById('companyName').value = '';
            document.getElementById('productName').value = '';
            document.getElementById('productDescription').value = '';
            
            autocompleteList.classList.remove('active');
            autocompleteList.innerHTML = '';
            
            console.log('Í∞ïÏùòÍ∞Ä Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§. Î≥ÄÍ≤ΩÏÇ¨Ìï≠Ïù¥ ÏûêÎèôÏúºÎ°ú Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.');
        }

        // Î∂ÑÎ•ò ÌïÑÌÑ∞ Ï†ëÍ∏∞/ÌéºÏπòÍ∏∞
        let categoryFiltersCollapsed = false;
        
        function toggleCategoryFilters() {
            const wrapper = document.getElementById('categoryFiltersWrapper');
            const btn = document.getElementById('toggleFiltersBtn');
            categoryFiltersCollapsed = !categoryFiltersCollapsed;
            
            if (categoryFiltersCollapsed) {
                wrapper.classList.add('collapsed');
                btn.textContent = 'üìÇ Î∂ÑÎ•ò ÌéºÏπòÍ∏∞';
            } else {
                wrapper.classList.remove('collapsed');
                btn.textContent = 'üìÇ Î∂ÑÎ•ò Ï†ëÍ∏∞';
            }
        }
        
        // Í≤ÄÏÉâÏñ¥ Ï†ÄÏû• Î≥ÄÏàò
        let lectureSearchTerm = '';
        
        function filterLecturesBySearch() {
            const input = document.getElementById('lectureSearchInput');
            lectureSearchTerm = input.value.trim().toLowerCase();
            updateLectureList();
        }
        
        function clearLectureSearch() {
            document.getElementById('lectureSearchInput').value = '';
            lectureSearchTerm = '';
            updateLectureList();
        }
        
        function updateLectureList() {
            const list = document.getElementById('lectureList');
            list.innerHTML = '';

            // Ïπ¥ÌÖåÍ≥†Î¶¨ ÌïÑÌÑ∞ Ï†ÅÏö©
            let filteredLectures = activeFilter === 'all' 
                ? lectures 
                : lectures.filter(l => l.category === activeFilter);
            
            // Í≤ÄÏÉâÏñ¥ ÌïÑÌÑ∞ Ï†ÅÏö©
            if (lectureSearchTerm) {
                filteredLectures = filteredLectures.filter(l => {
                    const titleMatch = (l.titleKo || '').toLowerCase().includes(lectureSearchTerm) ||
                                       (l.titleEn || '').toLowerCase().includes(lectureSearchTerm);
                    const speakerMatch = (l.speakerKo || '').toLowerCase().includes(lectureSearchTerm) ||
                                         (l.speakerEn || '').toLowerCase().includes(lectureSearchTerm);
                    const affiliationMatch = (l.affiliation || '').toLowerCase().includes(lectureSearchTerm);
                    return titleMatch || speakerMatch || affiliationMatch;
                });
            }

            if (filteredLectures.length === 0) {
                const message = lectureSearchTerm 
                    ? `"${lectureSearchTerm}" Í≤ÄÏÉâ Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§`
                    : 'Í∞ïÏùòÍ∞Ä ÏóÜÏäµÎãàÎã§';
                list.innerHTML = `<p style="text-align: center; color: var(--text-light); padding: 2rem;">${message}</p>`;
                return;
            }

            // ÏãúÍ∞ÑÌëúÏóê Î∞∞ÏπòÎêú Í∞ïÏùò ID Î™©Î°ù
            const scheduledLectureIds = Object.values(schedule).map(s => s.id);

            filteredLectures.forEach(lecture => {
                const color = categoryColors[lecture.category] || '#9B59B6';
                const isScheduled = scheduledLectureIds.includes(lecture.id);
                const item = document.createElement('div');
                item.className = 'lecture-item' + (isScheduled ? ' scheduled' : '');
                item.draggable = true;
                item.dataset.lectureId = lecture.id;
                item.style.borderLeft = `4px solid ${color}`;

                const duration = lecture.duration || 15;
                
                // Í≤ÄÏÉâÏñ¥ ÌïòÏù¥ÎùºÏù¥Ìä∏
                let titleDisplay = lecture.titleKo;
                let speakerDisplay = lecture.speakerKo;
                
                if (lectureSearchTerm) {
                    titleDisplay = highlightSearchTerm(lecture.titleKo, lectureSearchTerm);
                    speakerDisplay = highlightSearchTerm(lecture.speakerKo, lectureSearchTerm);
                }
                
                item.innerHTML = `
                    <div class="lecture-title">
                        <span class="category-color" style="background: ${color}"></span>
                        ${titleDisplay}
                    </div>
                    <div class="lecture-meta">
                        <span class="tag tag-speaker">${speakerDisplay}</span>
                        <span class="tag" style="background: #E3F2FD; color: #1976D2;">‚è±Ô∏è ${duration}Î∂Ñ</span>
                        ${isScheduled ? '<span class="tag" style="background: #E8F5E9; color: #4CAF50;">Î∞∞ÏπòÎê®</span>' : ''}
                    </div>
                `;

                item.addEventListener('dragstart', handleDragStart);
                item.addEventListener('dragend', handleDragEnd);
                item.addEventListener('dblclick', () => openEditModal(lecture.id));

                list.appendChild(item);
            });
        }
        
        // Í≤ÄÏÉâÏñ¥ ÌïòÏù¥ÎùºÏù¥Ìä∏ Ìï®Ïàò
        function highlightSearchTerm(text, term) {
            if (!text || !term) return text || '';
            const regex = new RegExp(`(${term.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
            return text.replace(regex, '<mark style="background:#FFEB3B; padding:0 2px; border-radius:2px;">$1</mark>');
        }

        let draggedLecture = null;
        let draggedSession = null;
        let draggedScheduleKey = null;

        function handleDragStart(e) {
            draggedLecture = lectures.find(l => l.id == this.dataset.lectureId);
            this.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/plain', this.dataset.lectureId);
            
            // ÎìúÎûòÍ∑∏ ÏãúÏûë Ïãú ÏãúÍ∞ÑÌëúÏóê dragging ÌÅ¥ÎûòÏä§ Ï∂îÍ∞Ä (5Î∂Ñ ÎààÍ∏à ÌëúÏãú)
            document.querySelector('.schedule-grid').classList.add('dragging');
            
            // Ìà¥ÌåÅ Ï¥àÍ∏∞Ìôî
            const tooltip = document.getElementById('dragTooltip');
            if (tooltip && draggedLecture) {
                document.getElementById('tooltipTitle').textContent = draggedLecture.titleKo;
                document.getElementById('tooltipDuration').textContent = `‚è±Ô∏è ${draggedLecture.duration || 15}Î∂Ñ`;
            }
        }

        function handleDragEnd(e) {
            this.classList.remove('dragging');
            
            // ÎìúÎûòÍ∑∏ Ï¢ÖÎ£å Ïãú dragging ÌÅ¥ÎûòÏä§ Ï†úÍ±∞
            document.querySelector('.schedule-grid').classList.remove('dragging');
            
            // Ìà¥ÌåÅ Ïà®Í∏∞Í∏∞
            const tooltip = document.getElementById('dragTooltip');
            if (tooltip) {
                tooltip.classList.remove('active');
            }
            
            // Î™®Îì† ÏÖÄÏóêÏÑú drag-target ÌÅ¥ÎûòÏä§ Ï†úÍ±∞
            document.querySelectorAll('.schedule-cell').forEach(cell => {
                cell.classList.remove('drag-target');
                cell.classList.remove('drag-over');
            });
        }

        // ÎìúÎûòÍ∑∏ Ï§ë ÏûêÎèô Ïä§ÌÅ¨Î°§ÏùÑ ÏúÑÌïú Î≥ÄÏàò
        let autoScrollInterval = null;
        const SCROLL_SPEED = 10;
        const SCROLL_ZONE = 80; // ÌôîÎ©¥ Í∞ÄÏû•ÏûêÎ¶¨ÏóêÏÑú Ïä§ÌÅ¨Î°§ ÏãúÏûëÌïòÎäî Í±∞Î¶¨

        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            
            // ÏûêÎèô Ïä§ÌÅ¨Î°§ Ï≤òÎ¶¨
            const scheduleContainer = document.querySelector('.schedule-table-wrapper');
            if (scheduleContainer) {
                const rect = scheduleContainer.getBoundingClientRect();
                const mouseY = e.clientY;
                
                // ÏúÑÏ™Ω Í∞ÄÏû•ÏûêÎ¶¨ Í∑ºÏ≤òÎ©¥ ÏúÑÎ°ú Ïä§ÌÅ¨Î°§
                if (mouseY < rect.top + SCROLL_ZONE) {
                    scheduleContainer.scrollTop -= SCROLL_SPEED;
                }
                // ÏïÑÎûòÏ™Ω Í∞ÄÏû•ÏûêÎ¶¨ Í∑ºÏ≤òÎ©¥ ÏïÑÎûòÎ°ú Ïä§ÌÅ¨Î°§
                else if (mouseY > rect.bottom - SCROLL_ZONE) {
                    scheduleContainer.scrollTop += SCROLL_SPEED;
                }
            }
            
            // ÌòÑÏû¨ ÏÖÄ ÌïòÏù¥ÎùºÏù¥Ìä∏
            document.querySelectorAll('.schedule-cell').forEach(cell => {
                cell.classList.remove('drag-target');
            });
            this.classList.add('drag-target');
            
            // ÎìúÎûòÍ∑∏ Ìà¥ÌåÅ ÏóÖÎç∞Ïù¥Ìä∏
            if (draggedLecture) {
                const time = this.dataset.time;
                const duration = draggedLecture.duration || 15;
                const endTime = addMinutesToTime(time, duration);
                
                const tooltip = document.getElementById('dragTooltip');
                if (tooltip) {
                    document.getElementById('tooltipTime').textContent = `üìç ${time} ‚Üí ${endTime}`;
                    tooltip.classList.add('active');
                    tooltip.style.left = (e.clientX + 20) + 'px';
                    tooltip.style.top = (e.clientY + 20) + 'px';
                }
            }
        }

        function handleDragLeave(e) {
            this.classList.remove('drag-target');
        }

        // Ïó∞Ïûê Ï§ëÎ≥µ Ï≤¥ÌÅ¨ Ìï®Ïàò
        const ROOM_TRANSFER_TIME = 10; // Î£∏ Ïù¥Îèô ÏãúÍ∞Ñ (Î∂Ñ)
        
        function timeToMinutes(timeStr) {
            const [hours, minutes] = timeStr.split(':').map(Number);
            return hours * 60 + minutes;
        }
        
        function checkSpeakerConflict(speakerKo, targetTime, targetRoom, targetDuration = 15, excludeKey = null) {
            const targetStart = timeToMinutes(targetTime);
            const targetEnd = targetStart + targetDuration;
            
            for (const [scheduleKey, lecture] of Object.entries(schedule)) {
                if (excludeKey && scheduleKey === excludeKey) continue;
                if (lecture.speakerKo !== speakerKo) continue;
                
                // key ÌòïÏãù: "14:15-Í∏∞Ï¥à"
                const existingTime = scheduleKey.substring(0, 5);
                const existingRoom = scheduleKey.substring(6);
                
                if (existingRoom === targetRoom) continue;
                
                const lectureStart = timeToMinutes(existingTime);
                const lectureDuration = lecture.duration || 15;
                const lectureEnd = lectureStart + lectureDuration;
                
                // Ïù¥Îèô ÏãúÍ∞Ñ Í≥†Î†§ (10Î∂Ñ)
                const safeEnd = lectureEnd + ROOM_TRANSFER_TIME;
                const safeStart = lectureStart - ROOM_TRANSFER_TIME;
                
                if (targetStart < safeEnd && targetEnd > safeStart) {
                    return {
                        conflictRoom: existingRoom,
                        conflictTime: existingTime
                    };
                }
            }
            return null;
        }

        function handleDrop(e) {
            e.preventDefault();
            this.classList.remove('drag-over');
            this.classList.remove('drag-target');
            
            // ÎìúÎûòÍ∑∏ ÌÅ¥ÎûòÏä§ Ï†úÍ±∞
            document.querySelector('.schedule-grid').classList.remove('dragging');
            
            // Ìà¥ÌåÅ Ïà®Í∏∞Í∏∞
            const tooltip = document.getElementById('dragTooltip');
            if (tooltip) {
                tooltip.classList.remove('active');
            }
            
            // Î™®Îì† ÏÖÄÏóêÏÑú ÌÅ¥ÎûòÏä§ Ï†úÍ±∞
            document.querySelectorAll('.schedule-cell').forEach(cell => {
                cell.classList.remove('dragging-over');
                cell.classList.remove('drag-target');
            });
            
            // Í∂åÌïú Ï≤¥ÌÅ¨
            if (!checkEditPermission()) {
                draggedLecture = null;
                draggedScheduleKey = null;
                return;
            }

            console.log('üéØ Drop event - draggedLecture:', draggedLecture);
            
            if (draggedLecture) {
                const time = this.dataset.time;
                const room = this.dataset.room;
                const key = `${time}-${room}`;
                
                console.log('üìç Drop location:', { time, room, key });
                
                // Í∞ïÏùò Î™©Î°ùÏóêÏÑú ÎìúÎûòÍ∑∏Ìïú Í≤ΩÏö∞ (ÏãúÍ∞ÑÌëú ÎÇ¥ Ïù¥ÎèôÏù¥ ÏïÑÎãå Í≤ΩÏö∞)
                // Ïù¥ÎØ∏ Î∞∞ÏπòÎêú Í∞ïÏùòÏù∏ÏßÄ ÌôïÏù∏
                if (!draggedScheduleKey) {
                    const existingPlacement = Object.entries(schedule).find(([k, v]) => v.id === draggedLecture.id);
                    if (existingPlacement) {
                        const [existingKey] = existingPlacement;
                        // key ÌòïÏãù: "14:15-Í∏∞Ï¥à"
                        const existingTime = existingKey.substring(0, 5);
                        const existingRoom = existingKey.substring(6);
                        
                        showAlreadyPlacedDialog(existingKey, existingTime, existingRoom, key, time, room, draggedLecture);
                        return;
                    }
                }
                
                // Ïù¥ÎØ∏ Í∞ïÏùòÍ∞Ä ÏûàÎäî ÏÖÄÏù∏ÏßÄ ÌôïÏù∏
                if (schedule[key]) {
                    if (!draggedScheduleKey || draggedScheduleKey !== key) {
                        showSwapDialog(key, time, room, draggedLecture, draggedScheduleKey);
                        return;
                    }
                }
                
                // UndoÎ•º ÏúÑÌï¥ ÏÉÅÌÉú Ï†ÄÏû•
                saveStateForUndo();
                
                // ÏãúÍ∞ÑÌëú ÎÇ¥ Ïù¥ÎèôÏù∏ Í≤ΩÏö∞ Í∏∞Ï°¥ ÏúÑÏπòÏóêÏÑú ÏÇ≠Ï†ú
                if (draggedScheduleKey && draggedScheduleKey !== key) {
                    delete schedule[draggedScheduleKey];
                }

                // Í∞ïÏùò Î≥µÏÇ¨
                const newLecture = { ...draggedLecture };
                
                // Ìï¥Îãπ ÏÖÄÏóê ÏÑ∏ÏÖòÏù¥ ÏûàÏúºÎ©¥ ÏûêÎèôÏúºÎ°ú ÏÑ∏ÏÖò ÏÜåÏÜç ÏÑ§Ï†ï
                const sessionAtCell = sessions.find(s => s.time === time && s.room === room);
                if (sessionAtCell) {
                    newLecture.sessionId = sessionAtCell.id;
                } else {
                    // Í∞ôÏùÄ Î£∏Ïùò ÏúÑÏ™Ω ÏãúÍ∞ÑÎåÄÏóê ÏÑ∏ÏÖòÏù¥ ÏûàÎäîÏßÄ ÌôïÏù∏
                    const timeIndex = timeSlots.indexOf(time);
                    for (let i = timeIndex - 1; i >= 0; i--) {
                        const upperSession = sessions.find(s => s.time === timeSlots[i] && s.room === room);
                        if (upperSession) {
                            newLecture.sessionId = upperSession.id;
                            break;
                        }
                    }
                }

                schedule[key] = newLecture;
                saveAndSync();
                updateScheduleDisplay();
                
                draggedScheduleKey = null;
                draggedLecture = null;
            }
            
            // ÏÑ∏ÏÖò ÎìúÎ°≠ Ï≤òÎ¶¨
            if (draggedSession) {
                const time = this.dataset.time;
                const room = this.dataset.room;
                
                if (draggedSession.time === time && draggedSession.room === room) {
                    draggedSession = null;
                    return;
                }
                
                const existingSession = sessions.find(s => s.time === time && s.room === room);
                if (existingSession) {
                    alert('Ïù¥ ÏúÑÏπòÏóê Ïù¥ÎØ∏ ÏÑ∏ÏÖòÏù¥ ÏûàÏäµÎãàÎã§.');
                    draggedSession = null;
                    return;
                }
                
                saveStateForUndo();
                draggedSession.time = time;
                draggedSession.room = room;
                
                saveAndSync();
                updateScheduleDisplay();
                draggedSession = null;
            }
        }
        
        // Ïù¥ÎØ∏ Î∞∞ÏπòÎêú Í∞ïÏùò ÌôïÏù∏ Îã§Ïù¥ÏñºÎ°úÍ∑∏
        function showAlreadyPlacedDialog(existingKey, existingTime, existingRoom, newKey, newTime, newRoom, lecture) {
            const dialog = document.createElement('div');
            dialog.className = 'swap-dialog-overlay';
            dialog.innerHTML = `
                <div class="swap-dialog">
                    <h3>‚ö†Ô∏è Ïù¥ÎØ∏ Î∞∞ÏπòÎêú Í∞ïÏùòÏûÖÎãàÎã§</h3>
                    <p style="margin-bottom: 0.5rem;"><strong>Í∞ïÏùò:</strong> ${lecture.titleKo}</p>
                    <p style="margin-bottom: 1rem; color: var(--accent);"><strong>ÌòÑÏû¨ ÏúÑÏπò:</strong> ${existingRoom} ${existingTime}</p>
                    <div class="swap-options">
                        <button class="swap-option" data-action="move" autofocus>
                            <span class="option-key">1</span> Í∏∞Ï°¥ Î∞∞Ïπò ÏÇ≠Ï†ú ÌõÑ ÏÉà ÏúÑÏπòÏóê Î∞∞Ïπò
                        </button>
                        <button class="swap-option cancel" data-action="cancel">
                            <span class="option-key">ESC</span> Ï∑®ÏÜå
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(dialog);
            
            const handleAction = (action) => {
                dialog.remove();
                document.removeEventListener('keydown', handleKeydown);
                
                if (action === 'cancel') {
                    draggedScheduleKey = null;
                    draggedLecture = null;
                    return;
                }
                
                if (action === 'move') {
                    saveStateForUndo();
                    
                    // Í∏∞Ï°¥ ÏúÑÏπòÏóêÏÑú ÏÇ≠Ï†ú
                    delete schedule[existingKey];
                    
                    // ÏÉà ÏúÑÏπòÏóê Í∞ïÏùòÍ∞Ä ÏûàÏúºÎ©¥ Ï≤òÎ¶¨
                    if (schedule[newKey]) {
                        // ÏÉà ÏúÑÏπòÏóê Ïù¥ÎØ∏ Í∞ïÏùòÍ∞Ä ÏûàÏúºÎ©¥ ÌôïÏù∏
                        const targetLecture = schedule[newKey];
                        if (confirm(`ÏÉà ÏúÑÏπò(${newRoom} ${newTime})Ïóê Ïù¥ÎØ∏ "${targetLecture.titleKo}" Í∞ïÏùòÍ∞Ä ÏûàÏäµÎãàÎã§.\nÎåÄÏ≤¥ÌïòÏãúÍ≤†ÏäµÎãàÍπå?`)) {
                            schedule[newKey] = { ...lecture };
                        }
                    } else {
                        // ÏÉà ÏúÑÏπòÏóê Î∞∞Ïπò
                        const newLecture = { ...lecture };
                        
                        // ÏÑ∏ÏÖò ÏûêÎèô Ìï†Îãπ
                        const sessionAtCell = sessions.find(s => s.time === newTime && s.room === newRoom);
                        if (sessionAtCell) {
                            newLecture.sessionId = sessionAtCell.id;
                        }
                        
                        schedule[newKey] = newLecture;
                    }
                    
                    saveAndSync();
                    updateScheduleDisplay();
                }
                
                draggedScheduleKey = null;
                draggedLecture = null;
            };
            
            dialog.querySelectorAll('.swap-option').forEach(btn => {
                btn.onclick = () => handleAction(btn.dataset.action);
            });
            
            const handleKeydown = (e) => {
                if (e.key === '1') handleAction('move');
                else if (e.key === 'Escape') handleAction('cancel');
                else if (e.key === 'Enter') {
                    const focused = dialog.querySelector('.swap-option:focus');
                    if (focused) handleAction(focused.dataset.action);
                }
            };
            document.addEventListener('keydown', handleKeydown);
            
            dialog.querySelector('.swap-option[autofocus]').focus();
        }

        // ÎßûÎ∞îÍæ∏Í∏∞ Îã§Ïù¥ÏñºÎ°úÍ∑∏
        function showSwapDialog(targetKey, time, room, newLecture, sourceKey) {
            const existingLecture = schedule[targetKey];
            
            const dialog = document.createElement('div');
            dialog.className = 'swap-dialog-overlay';
            dialog.innerHTML = `
                <div class="swap-dialog">
                    <h3>‚ö†Ô∏è Í∞ïÏùòÍ∞Ä Ïù¥ÎØ∏ ÏûàÏäµÎãàÎã§</h3>
                    <p><strong>Í∏∞Ï°¥:</strong> ${existingLecture.titleKo} (${existingLecture.speakerKo})</p>
                    <p><strong>ÏÉàÎ°úÏö¥:</strong> ${newLecture.titleKo} (${newLecture.speakerKo})</p>
                    <div class="swap-options">
                        <button class="swap-option" data-action="replace" autofocus>
                            <span class="option-key">1</span> ÎåÄÏ≤¥ (Í∏∞Ï°¥ Í∞ïÏùò ÏÇ≠Ï†ú)
                        </button>
                        <button class="swap-option" data-action="swap">
                            <span class="option-key">2</span> ÎßûÎ∞îÍæ∏Í∏∞ (ÏúÑÏπò ÍµêÌôò)
                        </button>
                        <button class="swap-option cancel" data-action="cancel">
                            <span class="option-key">ESC</span> Ï∑®ÏÜå
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(dialog);
            
            const handleAction = (action) => {
                dialog.remove();
                document.removeEventListener('keydown', handleKeydown);
                
                if (action === 'cancel') {
                    draggedScheduleKey = null;
                    draggedLecture = null;
                    return;
                }
                
                saveStateForUndo();
                
                if (action === 'replace') {
                    if (sourceKey) {
                        delete schedule[sourceKey];
                    }
                    schedule[targetKey] = { ...newLecture };
                } else if (action === 'swap') {
                    if (sourceKey) {
                        schedule[sourceKey] = { ...existingLecture };
                        schedule[targetKey] = { ...newLecture };
                    } else {
                        // ÏôºÏ™Ω Î™©Î°ùÏóêÏÑú ÎìúÎûòÍ∑∏Ìïú Í≤ΩÏö∞ - ÍµêÌôò Î∂àÍ∞Ä, ÎåÄÏ≤¥Îßå Í∞ÄÎä•
                        schedule[targetKey] = { ...newLecture };
                    }
                }
                
                saveAndSync();
                updateScheduleDisplay();
                draggedScheduleKey = null;
                draggedLecture = null;
            };
            
            dialog.querySelectorAll('.swap-option').forEach(btn => {
                btn.onclick = () => handleAction(btn.dataset.action);
            });
            
            const handleKeydown = (e) => {
                if (e.key === '1') handleAction('replace');
                else if (e.key === '2') handleAction('swap');
                else if (e.key === 'Escape') handleAction('cancel');
                else if (e.key === 'Enter') {
                    const focused = dialog.querySelector('.swap-option:focus');
                    if (focused) handleAction(focused.dataset.action);
                }
            };
            document.addEventListener('keydown', handleKeydown);
            
            dialog.querySelector('.swap-option[autofocus]').focus();
        }

        function updateScheduleDisplay() {
            // Í∏∞Ï°¥ Í∞ïÏùò Î∏îÎ°ùÎì§ Ï†úÍ±∞
            document.querySelectorAll('.scheduled-lecture').forEach(el => el.remove());
            document.querySelectorAll('.session-header-cell').forEach(el => el.remove());
            
            // Í∞Å ÏÖÄÏùò ÏÑ∏ÏÖò Ï∂îÍ∞Ä Î≤ÑÌäº Ïû¨ÏÑ§Ï†ï
            document.querySelectorAll('.schedule-cell').forEach(cell => {
                const time = cell.dataset.time;
                const room = cell.dataset.room;
                const [hour, min] = time.split(':').map(Number);
                
                // ÏÑ∏ÏÖò Ï∂îÍ∞Ä Î≤ÑÌäº Ï≤òÎ¶¨ (30Î∂Ñ Îã®ÏúÑÏóêÎßå)
                let addSessionBtn = cell.querySelector('.add-session-btn');
                if (!addSessionBtn && (min === 0 || min === 30)) {
                    addSessionBtn = document.createElement('button');
                    addSessionBtn.className = 'add-session-btn';
                    addSessionBtn.textContent = '+ ÏÑ∏ÏÖò';
                    addSessionBtn.onclick = (e) => {
                        e.stopPropagation();
                        openCellSessionModal(time, room);
                    };
                    cell.appendChild(addSessionBtn);
                }
                
                // ÏÑ∏ÏÖòÏù¥ ÏûàÏúºÎ©¥ ÏÑ∏ÏÖò Ìó§Îçî ÌëúÏãú
                const session = sessions.find(s => s.time === time && s.room === room);
                if (session) {
                    cell.classList.add('has-session');
                    if (addSessionBtn) addSessionBtn.style.display = 'none';
                    
                    const sessionName = currentLanguage === 'en' && session.nameEn ? session.nameEn : session.name;
                    const moderatorLabel = currentLanguage === 'en' ? 'Chair: ' : 'Ï¢åÏû•: ';
                    const moderatorName = currentLanguage === 'en' && session.moderatorEn ? session.moderatorEn : session.moderator;
                    
                    const sessionHeader = document.createElement('div');
                    sessionHeader.className = 'session-header-cell';
                    sessionHeader.draggable = true;
                    sessionHeader.dataset.sessionId = session.id;
                    sessionHeader.style.background = `linear-gradient(135deg, ${session.color} 0%, ${adjustColor(session.color, -20)} 100%)`;
                    sessionHeader.innerHTML = `
                        <span class="session-name" title="${sessionName}">${sessionName}</span>
                        ${moderatorName ? `<span class="session-moderator">${moderatorLabel}${moderatorName}</span>` : ''}
                        <button class="session-remove" onclick="event.stopPropagation(); removeSession('${time}', '${room}')">√ó</button>
                    `;
                    // ÎçîÎ∏îÌÅ¥Î¶≠ÏúºÎ°ú ÏÑ∏ÏÖò ÏàòÏ†ï
                    sessionHeader.addEventListener('dblclick', (e) => {
                        if (!e.target.classList.contains('session-remove')) {
                            editCellSession(time, room);
                        }
                    });
                    
                    sessionHeader.addEventListener('dragstart', (e) => {
                        e.stopPropagation();
                        draggedSession = session;
                        sessionHeader.style.opacity = '0.5';
                        e.dataTransfer.effectAllowed = 'move';
                    });
                    sessionHeader.addEventListener('dragend', () => {
                        sessionHeader.style.opacity = '1';
                        draggedSession = null;
                    });
                    
                    cell.appendChild(sessionHeader);
                } else {
                    cell.classList.remove('has-session');
                    if (addSessionBtn) addSessionBtn.style.display = '';
                }
            });

            // Í∞ïÏùòÎì§ÏùÑ ÏãúÍ∞Ñ ÎπÑÎ°Ä ÎÜíÏù¥Î°ú ÌëúÏãú
            console.log('üìã Schedule entries:', Object.keys(schedule).length);
            
            Object.entries(schedule).forEach(([key, lecture]) => {
                // key ÌòïÏãù: "14:15-Í∏∞Ï¥à" ÎòêÎäî "14:15-Ïã¨ÌôîÎ†àÏù¥Ï†Ä"
                // ÏãúÍ∞ÑÏùÄ HH:MM ÌòïÏãùÏù¥ÎØÄÎ°ú Ï≤´ 5Í∏ÄÏûêÍ∞Ä ÏãúÍ∞Ñ
                const startTime = key.substring(0, 5); // "14:15"
                const room = key.substring(6); // "Í∏∞Ï¥à" (6Î≤àÏß∏Î∂ÄÌÑ∞ ÎÅùÍπåÏßÄ)
                
                console.log('üîç Rendering lecture:', { key, startTime, room, title: lecture.titleKo });
                
                const startIndex = timeSlots.indexOf(startTime);
                if (startIndex === -1) {
                    console.log('‚ùå Time not found in timeSlots:', startTime, room);
                    return;
                }
                
                const duration = lecture.duration || 15;
                const slotsSpan = Math.ceil(duration / TIME_UNIT); // 5Î∂Ñ Îã®ÏúÑÎ°ú Î™á Ïä¨Î°Ø Ï∞®ÏßÄÌïòÎäîÏßÄ
                
                // ÏãúÏûë ÏÖÄ Ï∞æÍ∏∞ (data-room ÏÜçÏÑ±ÏúºÎ°ú Ï∞æÍ∏∞)
                let startCell = null;
                document.querySelectorAll('.schedule-cell').forEach(cell => {
                    if (cell.dataset.time === startTime && cell.dataset.room === room) {
                        startCell = cell;
                    }
                });
                
                if (!startCell) {
                    console.log('‚ùå Cell not found:', { startTime, room });
                    return;
                }
                
                console.log('‚úÖ Cell found, creating lecture block');
                
                const color = categoryColors[lecture.category] || '#9B59B6';
                const lightColor = adjustColor(color, 40);
                const lectureDiv = document.createElement('div');
                
                const session = sessions.find(s => s.time === startTime && s.room === room);
                const isInSession = lecture.sessionId || session;
                lectureDiv.className = 'scheduled-lecture' + (isInSession ? ' in-session' : '');
                lectureDiv.draggable = true;
                lectureDiv.dataset.scheduleKey = key;
                lectureDiv.tabIndex = 0;
                lectureDiv.style.background = `linear-gradient(135deg, ${lightColor} 0%, ${color} 100%)`;
                
                // ÎÜíÏù¥ Í≥ÑÏÇ∞ (5Î∂ÑÎãπ 20px, ÏÖÄ ÎÜíÏù¥ÏôÄ ÎèôÏùºÌïòÍ≤å)
                const cellHeight = 20; // Í∏∞Î≥∏ ÏÖÄ ÎÜíÏù¥ (CSS min-heightÏôÄ ÏùºÏπò)
                const totalHeight = slotsSpan * cellHeight; // Ïó¨Î∞± ÏóÜÏù¥ Ï†ïÌôïÌûà ÎßûÏ∂§
                lectureDiv.style.height = `${totalHeight}px`;
                lectureDiv.style.top = '0px';
                
                const title = currentLanguage === 'en' && lecture.titleEn ? lecture.titleEn : lecture.titleKo;
                const speaker = currentLanguage === 'en' && lecture.speakerEn ? lecture.speakerEn : lecture.speakerKo;
                
                lectureDiv.innerHTML = `
                    <button class="remove-btn" onclick="event.stopPropagation(); removeLecture('${key}')">√ó</button>
                    <div class="lecture-title-display">${title}</div>
                    <div class="lecture-meta-display">
                        <span class="speaker-name">${speaker}</span>
                        <span class="duration-badge">‚è±Ô∏è ${duration}Î∂Ñ</span>
                    </div>
                `;
                
                lectureDiv.addEventListener('dragstart', handleScheduleDragStart);
                lectureDiv.addEventListener('dragend', handleScheduleDragEnd);
                
                // ÎçîÎ∏îÌÅ¥Î¶≠ÏúºÎ°ú Í∞ïÏùò ÏàòÏ†ï
                lectureDiv.addEventListener('dblclick', (e) => {
                    e.stopPropagation();
                    openEditModal(lecture.id);
                });
                
                lectureDiv.addEventListener('keydown', (e) => {
                    if (e.key === 'Tab') {
                        e.preventDefault();
                        toggleSessionMembership(key, startTime, room);
                    }
                });
                
                startCell.appendChild(lectureDiv);
            });
        }
        
        // ÏÑ∏ÏÖò ÏÜåÏÜç ÌÜ†Í∏Ä Ìï®Ïàò
        function toggleSessionMembership(key, time, room) {
            const lecture = schedule[key];
            if (!lecture) return;
            
            // Ìï¥Îãπ Î£∏ÏóêÏÑú ÏÑ∏ÏÖò Ï∞æÍ∏∞ (ÌòÑÏû¨ ÏãúÍ∞Ñ ÎòêÎäî Í∑∏ ÏúÑ ÏãúÍ∞ÑÎåÄ)
            const timeIndex = timeSlots.indexOf(time);
            let foundSession = null;
            
            for (let i = timeIndex; i >= 0; i--) {
                const sessionAtTime = sessions.find(s => s.time === timeSlots[i] && s.room === room);
                if (sessionAtTime) {
                    foundSession = sessionAtTime;
                    break;
                }
            }
            
            if (lecture.sessionId) {
                // ÏÑ∏ÏÖò ÏÜåÏÜç Ìï¥Ï†ú
                delete lecture.sessionId;
            } else if (foundSession) {
                // ÏÑ∏ÏÖò ÏÜåÏÜç ÏÑ§Ï†ï
                lecture.sessionId = foundSession.id;
            } else {
                alert('Ïù¥ Î£∏Ïóê ÏÑ∏ÏÖòÏù¥ ÏóÜÏäµÎãàÎã§. Î®ºÏ†Ä ÏÑ∏ÏÖòÏùÑ Ï∂îÍ∞ÄÌï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            
            saveAndSync();
            updateScheduleDisplay();
        }
        
        // ÏãúÍ∞ÑÌëú ÎÇ¥ ÎìúÎûòÍ∑∏ Ìï®Ïàò
        function handleScheduleDragStart(e) {
            draggedScheduleKey = this.dataset.scheduleKey;
            draggedLecture = schedule[draggedScheduleKey];
            this.style.opacity = '0.5';
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/plain', draggedScheduleKey);
            
            // ÎìúÎûòÍ∑∏ ÏãúÏûë Ïãú ÏãúÍ∞ÑÌëúÏóê dragging ÌÅ¥ÎûòÏä§ Ï∂îÍ∞Ä
            document.querySelector('.schedule-grid').classList.add('dragging');
            
            // Ìà¥ÌåÅ Ï¥àÍ∏∞Ìôî
            const tooltip = document.getElementById('dragTooltip');
            if (tooltip && draggedLecture) {
                document.getElementById('tooltipTitle').textContent = draggedLecture.titleKo;
                document.getElementById('tooltipDuration').textContent = `‚è±Ô∏è ${draggedLecture.duration || 15}Î∂Ñ`;
            }
        }
        
        function handleScheduleDragEnd(e) {
            this.style.opacity = '1';
            draggedScheduleKey = null;
            
            // ÎìúÎûòÍ∑∏ Ï¢ÖÎ£å Ïãú dragging ÌÅ¥ÎûòÏä§ Ï†úÍ±∞
            document.querySelector('.schedule-grid').classList.remove('dragging');
            
            // Ìà¥ÌåÅ Ïà®Í∏∞Í∏∞
            const tooltip = document.getElementById('dragTooltip');
            if (tooltip) {
                tooltip.classList.remove('active');
            }
            
            // Î™®Îì† ÏÖÄÏóêÏÑú drag-target ÌÅ¥ÎûòÏä§ Ï†úÍ±∞
            document.querySelectorAll('.schedule-cell').forEach(cell => {
                cell.classList.remove('drag-target');
            });
        }

        function adjustColor(color, percent) {
            const num = parseInt(color.replace("#",""), 16);
            const amt = Math.round(2.55 * percent);
            const R = (num >> 16) + amt;
            const G = (num >> 8 & 0x00FF) + amt;
            const B = (num & 0x0000FF) + amt;
            return "#" + (0x1000000 + (R<255?R<1?0:R:255)*0x10000 + 
                    (G<255?G<1?0:G:255)*0x100 + (B<255?B<1?0:B:255))
                    .toString(16).slice(1);
        }

        function removeLecture(key) {
            saveStateForUndo();
            delete schedule[key];
            saveAndSync(); // Ï†ÄÏû• Î∞è ÎèôÍ∏∞Ìôî
            updateScheduleDisplay();
            updateLectureList(); // Î∞∞ÏπòÎê® ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
        }

        function openEditModal(lectureId) {
            const lecture = lectures.find(l => l.id === lectureId);
            if (!lecture) return;

            document.getElementById('editLectureId').value = lecture.id;
            document.getElementById('editCategory').value = lecture.category;
            document.getElementById('editTitleKo').value = lecture.titleKo;
            document.getElementById('editTitleEn').value = lecture.titleEn || '';
            document.getElementById('editSpeakerKo').value = lecture.speakerKo;
            document.getElementById('editSpeakerEn').value = lecture.speakerEn || '';
            document.getElementById('editAffiliation').value = lecture.affiliation || '';
            document.getElementById('editDuration').value = lecture.duration || 15;

            document.getElementById('editModal').classList.add('active');
        }

        function closeEditModal() {
            document.getElementById('editModal').classList.remove('active');
        }
        
        function deleteLectureFromModal() {
            const lectureId = parseInt(document.getElementById('editLectureId').value);
            const lecture = lectures.find(l => l.id === lectureId);
            
            if (!lecture) return;
            
            if (confirm(`"${lecture.titleKo}" Í∞ïÏùòÎ•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?\n\nÏãúÍ∞ÑÌëúÏóêÏÑúÎèÑ ÏÇ≠Ï†úÎê©ÎãàÎã§.`)) {
                // Í∞ïÏùò Î™©Î°ùÏóêÏÑú ÏÇ≠Ï†ú
                lectures = lectures.filter(l => l.id !== lectureId);
                
                // ÏãúÍ∞ÑÌëúÏóêÏÑúÎèÑ ÏÇ≠Ï†ú
                Object.keys(schedule).forEach(key => {
                    if (schedule[key].id === lectureId) {
                        delete schedule[key];
                    }
                });
                
                saveAndSync();
                updateLectureList();
                updateScheduleDisplay();
                closeEditModal();
            }
        }

        document.getElementById('saveEditBtn').addEventListener('click', function() {
            const lectureId = parseInt(document.getElementById('editLectureId').value);
            const lectureIndex = lectures.findIndex(l => l.id === lectureId);

            if (lectureIndex !== -1) {
                const updatedLecture = {
                    id: lectureId,
                    category: document.getElementById('editCategory').value,
                    titleKo: document.getElementById('editTitleKo').value,
                    titleEn: document.getElementById('editTitleEn').value,
                    speakerKo: document.getElementById('editSpeakerKo').value,
                    speakerEn: document.getElementById('editSpeakerEn').value,
                    affiliation: document.getElementById('editAffiliation').value,
                    duration: parseInt(document.getElementById('editDuration').value) || 15
                };
                
                lectures[lectureIndex] = updatedLecture;

                // ÏãúÍ∞ÑÌëúÏùò Í∞ïÏùòÎèÑ ÏóÖÎç∞Ïù¥Ìä∏
                Object.keys(schedule).forEach(key => {
                    if (schedule[key].id === lectureId) {
                        schedule[key] = { ...updatedLecture };
                    }
                });

                saveAndSync();
                updateLectureList();
                updateScheduleDisplay();
                closeEditModal();
            }
        });

        function openSpeakerModal() {
            updateSpeakerList();
            document.getElementById('speakerModal').classList.add('active');
        }

        function closeSpeakerModal() {
            document.getElementById('speakerModal').classList.remove('active');
            document.getElementById('speakerSearch').value = '';
        }

        function searchSpeakers() {
            updateSpeakerList();
        }

        function getSortedAndFilteredSpeakers() {
            const searchTerm = document.getElementById('speakerSearch').value.toLowerCase().trim();
            const sortType = document.getElementById('speakerSort').value;

            // Í≤ÄÏÉâ ÌïÑÌÑ∞ÎßÅ
            let filtered = speakers.filter(speaker => {
                if (!searchTerm) return true;
                
                const nameMatch = speaker.name.toLowerCase().includes(searchTerm);
                const nameEnMatch = (speaker.nameEn || '').toLowerCase().includes(searchTerm);
                const affiliationMatch = speaker.affiliation.toLowerCase().includes(searchTerm);
                const affiliationEnMatch = (speaker.affiliationEn || '').toLowerCase().includes(searchTerm);
                
                return nameMatch || nameEnMatch || affiliationMatch || affiliationEnMatch;
            });

            // Ï†ïÎ†¨
            const sorted = [...filtered];
            
            switch(sortType) {
                case 'name-ko':
                    sorted.sort((a, b) => a.name.localeCompare(b.name, 'ko'));
                    break;
                case 'name-en':
                    sorted.sort((a, b) => {
                        const aName = (a.nameEn || a.name).toLowerCase();
                        const bName = (b.nameEn || b.name).toLowerCase();
                        return aName.localeCompare(bName, 'en');
                    });
                    break;
                case 'affiliation':
                    sorted.sort((a, b) => a.affiliation.localeCompare(b.affiliation, 'ko'));
                    break;
                case 'recent':
                    // Î∞∞Ïó¥ ÏàúÏÑú Í∑∏ÎåÄÎ°ú (ÏµúÍ∑º Ï∂îÍ∞ÄÍ∞Ä Îí§Ïóê)
                    sorted.reverse();
                    break;
            }

            return sorted;
        }

        function updateSpeakerList() {
            const list = document.getElementById('speakerList');
            const displaySpeakers = getSortedAndFilteredSpeakers();
            
            if (displaySpeakers.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: var(--text-light); padding: 2rem;">Í≤ÄÏÉâ Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§</p>';
                return;
            }

            list.innerHTML = displaySpeakers.map(speaker => {
                const originalIndex = speakers.indexOf(speaker);
                return `
                    <div class="speaker-item">
                        <div class="speaker-info">
                            <strong>${speaker.name}${speaker.nameEn ? ' / ' + speaker.nameEn : ''}</strong>
                            <small>${speaker.affiliation}${speaker.affiliationEn ? ' / ' + speaker.affiliationEn : ''}</small>
                        </div>
                        <div class="speaker-actions">
                            <button class="btn btn-secondary btn-small" onclick="editSpeaker(event, ${originalIndex})">ÏàòÏ†ï</button>
                            <button class="btn btn-secondary btn-small" onclick="deleteSpeaker(event, ${originalIndex})">ÏÇ≠Ï†ú</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function addSpeaker() {
            const name = document.getElementById('newSpeakerName').value.trim();
            const nameEn = document.getElementById('newSpeakerNameEn').value.trim();
            const affiliation = document.getElementById('newSpeakerAffiliation').value.trim();
            const affiliationEn = document.getElementById('newSpeakerAffiliationEn').value.trim();

            if (name && affiliation) {
                speakers.push({ name, nameEn, affiliation, affiliationEn });
                document.getElementById('newSpeakerName').value = '';
                document.getElementById('newSpeakerNameEn').value = '';
                document.getElementById('newSpeakerAffiliation').value = '';
                document.getElementById('newSpeakerAffiliationEn').value = '';
                saveAndSync(); // Ï†ÄÏû• Î∞è ÎèôÍ∏∞Ìôî
                updateSpeakerList();
            } else {
                alert('Ïó∞ÏûêÎ™Ö(ÌïúÍ∏Ä)Í≥º ÏÜåÏÜç(ÌïúÍ∏Ä)ÏùÄ ÌïÑÏàò ÏûÖÎ†• Ìï≠Î™©ÏûÖÎãàÎã§.');
            }
        }

        function deleteSpeaker(event, index) {
            event.stopPropagation();
            if (confirm('Ïù¥ Ïó∞ÏûêÎ•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                speakers.splice(index, 1);
                saveAndSync(); // Ï†ÄÏû• Î∞è ÎèôÍ∏∞Ìôî
                updateSpeakerList();
            }
        }
        
        function editSpeaker(event, index) {
            event.stopPropagation();
            const speaker = speakers[index];
            
            document.getElementById('editSpeakerIndex').value = index;
            document.getElementById('editSpeakerNameField').value = speaker.name;
            document.getElementById('editSpeakerNameEnField').value = speaker.nameEn || '';
            document.getElementById('editSpeakerAffiliationField').value = speaker.affiliation;
            document.getElementById('editSpeakerAffiliationEnField').value = speaker.affiliationEn || '';
            
            document.getElementById('editSpeakerModal').classList.add('active');
        }
        
        function closeEditSpeakerModal() {
            document.getElementById('editSpeakerModal').classList.remove('active');
        }
        
        function openHelpModal() {
            document.getElementById('helpModal').classList.add('active');
        }
        
        function closeHelpModal() {
            document.getElementById('helpModal').classList.remove('active');
        }
        
        function saveEditedSpeaker() {
            const index = parseInt(document.getElementById('editSpeakerIndex').value);
            
            speakers[index] = {
                name: document.getElementById('editSpeakerNameField').value.trim(),
                nameEn: document.getElementById('editSpeakerNameEnField').value.trim(),
                affiliation: document.getElementById('editSpeakerAffiliationField').value.trim(),
                affiliationEn: document.getElementById('editSpeakerAffiliationEnField').value.trim()
            };
            
            saveAndSync(); // Ï†ÄÏû• Î∞è ÎèôÍ∏∞Ìôî
            updateSpeakerList();
            closeEditSpeakerModal();
        }

        function loadFromFile(event) {
            const file = event.target.files[0];
            if (!file) return;

            // JSON ÌååÏùºÏù∏ÏßÄ ÌôïÏù∏
            if (!file.name.endsWith('.json')) {
                alert('‚ùå JSON ÌååÏùºÎßå Î∂àÎü¨Ïò¨ Ïàò ÏûàÏäµÎãàÎã§.');
                return;
            }

            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    // Îç∞Ïù¥ÌÑ∞ Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨
                    if (!data.lectures || !data.schedule || !data.speakers) {
                        throw new Error('Ïò¨Î∞îÎ•∏ ÌòïÏãùÏùò ÌååÏùºÏù¥ ÏïÑÎãôÎãàÎã§.');
                    }

                    // ÌôïÏù∏ Î©îÏãúÏßÄ
                    const savedDate = data.savedAt ? new Date(data.savedAt).toLocaleString('ko-KR') : 'Ïïå Ïàò ÏóÜÏùå';
                    const message = `üìÇ ÌååÏùº Ï†ïÎ≥¥:\n\n` +
                                  `üìÖ Ï†ÄÏû• ÏãúÍ∞Å: ${savedDate}\n` +
                                  `üìö Í∞ïÏùò Ïàò: ${data.lectures.length}Í∞ú\n` +
                                  `üë• Ïó∞Ïûê Ïàò: ${data.speakers.length}Î™Ö\n` +
                                  `üìä ÏãúÍ∞ÑÌëú: ${Object.keys(data.schedule).length}Í∞ú Î∞∞Ïπò\n\n` +
                                  `ÌòÑÏû¨ Îç∞Ïù¥ÌÑ∞Î•º ÎçÆÏñ¥Ïì∞ÏãúÍ≤†ÏäµÎãàÍπå?\n` +
                                  `(ÌòÑÏû¨ Îç∞Ïù¥ÌÑ∞Îäî ÏÇ¨ÎùºÏßëÎãàÎã§)`;

                    if (confirm(message)) {
                        // Îç∞Ïù¥ÌÑ∞ ÎçÆÏñ¥Ïì∞Í∏∞
                        lectures = data.lectures;
                        schedule = data.schedule;
                        speakers = data.speakers;

                        // Ïπ¥ÌÖåÍ≥†Î¶¨ Î∂àÎü¨Ïò§Í∏∞ (ÏûàÏúºÎ©¥)
                        if (data.categories) {
                            categories = data.categories;
                        }
                        if (data.categoryColors) {
                            Object.assign(categoryColors, data.categoryColors);
                        }
                        // ÏÑ∏ÏÖò Î∂àÎü¨Ïò§Í∏∞ (ÏûàÏúºÎ©¥)
                        if (data.sessions) {
                            sessions = data.sessions;
                        }

                        // Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄÏóê Ï†ÄÏû•
                        saveToLocalStorage();

                        // UI ÏóÖÎç∞Ïù¥Ìä∏
                        updateCategoryDropdowns();
                        createCategoryFilters();
                        updateLectureList();
                        updateScheduleDisplay();
                        renderSessionBars();

                        alert('‚úÖ ÌååÏùºÏùÑ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Î∂àÎü¨ÏôîÏäµÎãàÎã§!\n\nÎ™®Îì† Îç∞Ïù¥ÌÑ∞Í∞Ä Î≥µÏõêÎêòÏóàÏäµÎãàÎã§.');
                        
                        // ÏûÖÎ†• ÌïÑÎìú Ï¥àÍ∏∞Ìôî
                        event.target.value = '';
                    } else {
                        // Ï∑®ÏÜå Ïãú ÏûÖÎ†• ÌïÑÎìú Ï¥àÍ∏∞Ìôî
                        event.target.value = '';
                    }
                    
                } catch (error) {
                    console.error('ÌååÏùº Î∂àÎü¨Ïò§Í∏∞ Ïò§Î•ò:', error);
                    alert('‚ùå ÌååÏùºÏùÑ Î∂àÎü¨Ïò§Îäî Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.\n\n' + error.message);
                    event.target.value = '';
                }
            };

            reader.onerror = function() {
                alert('‚ùå ÌååÏùºÏùÑ ÏùΩÎäî Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
                event.target.value = '';
            };

            reader.readAsText(file);
        }

        function exportToExcel() {
            let csv = 'ÏãúÍ∞Ñ,Î£∏A,Î£∏B,Î£∏C,Î£∏D,Î©îÏù∏ÌôÄ\n';

            timeSlots.forEach(time => {
                let row = [time];
                rooms.forEach(room => {
                    const key = `${time}-${room}`;
                    const lecture = schedule[key];
                    row.push(lecture ? `${lecture.titleKo} (${lecture.speakerKo})` : '');
                });
                csv += row.join(',') + '\n';
            });

            const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'schedule.csv';
            link.click();
        }

        function printSchedule() {
            window.print();
        }

        // Î∂ÑÎ•ò Í¥ÄÎ¶¨ Ìï®ÏàòÎì§
        function openCategoryModal() {
            updateCategoryList();
            document.getElementById('categoryModal').classList.add('active');
        }

        function closeCategoryModal() {
            document.getElementById('categoryModal').classList.remove('active');
        }

        function updateCategoryList() {
            const list = document.getElementById('categoryList');
            const sortedCategories = [...categories].sort();
            
            list.innerHTML = sortedCategories.map(cat => {
                const color = categoryColors[cat] || '#9B59B6';
                return `
                    <div class="speaker-item">
                        <div class="speaker-info" style="display: flex; align-items: center; gap: 0.75rem;">
                            <div style="width: 24px; height: 24px; border-radius: 50%; background: ${color};"></div>
                            <strong>${cat}</strong>
                        </div>
                        <div class="speaker-actions">
                            <input type="color" value="${color}" onchange="updateCategoryColor('${cat}', this.value)" style="width: 40px; height: 32px; border: none; cursor: pointer;">
                            <button class="btn btn-secondary btn-small" onclick="deleteCategory('${cat}')">ÏÇ≠Ï†ú</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function addCategory() {
            const name = document.getElementById('newCategoryName').value.trim();
            const color = document.getElementById('newCategoryColor').value;

            if (!name) {
                alert('Î∂ÑÎ•òÎ™ÖÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            if (categories.includes(name)) {
                alert('Ïù¥ÎØ∏ Ï°¥Ïû¨ÌïòÎäî Î∂ÑÎ•òÏûÖÎãàÎã§.');
                return;
            }

            categories.push(name);
            categories.sort();
            categoryColors[name] = color;
            
            document.getElementById('newCategoryName').value = '';
            
            updateCategoryDropdowns();
            updateCategoryList();
            createCategoryFilters();
            saveAndSync();
        }

        function updateCategoryColor(cat, color) {
            categoryColors[cat] = color;
            updateCategoryList();
            createCategoryFilters();
            updateLectureList();
            updateScheduleDisplay();
            saveAndSync();
        }

        function deleteCategory(cat) {
            if (cat === 'Others') {
                alert('"Others" Î∂ÑÎ•òÎäî ÏÇ≠Ï†úÌï† Ïàò ÏóÜÏäµÎãàÎã§.');
                return;
            }

            if (!confirm(`"${cat}" Î∂ÑÎ•òÎ•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?\n\nÌï¥Îãπ Î∂ÑÎ•òÏùò Í∞ïÏùòÎäî "Others"Î°ú Î≥ÄÍ≤ΩÎê©ÎãàÎã§.`)) {
                return;
            }

            // Ìï¥Îãπ Î∂ÑÎ•òÏùò Í∞ïÏùòÎì§ÏùÑ OthersÎ°ú Î≥ÄÍ≤Ω
            lectures.forEach(lecture => {
                if (lecture.category === cat) {
                    lecture.category = 'Others';
                }
            });

            Object.keys(schedule).forEach(key => {
                if (schedule[key].category === cat) {
                    schedule[key].category = 'Others';
                }
            });

            // Î∂ÑÎ•ò ÏÇ≠Ï†ú
            categories = categories.filter(c => c !== cat);
            delete categoryColors[cat];

            updateCategoryDropdowns();
            updateCategoryList();
            createCategoryFilters();
            updateLectureList();
            updateScheduleDisplay();
            saveAndSync();
        }

        function updateCategoryDropdowns() {
            const sortedCategories = [...categories].sort();
            
            // Í∞ïÏùò Ï∂îÍ∞Ä ÌèºÏùò ÎìúÎ°≠Îã§Ïö¥
            const categorySelect = document.getElementById('category');
            const currentValue = categorySelect.value;
            categorySelect.innerHTML = '<option value="">ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>' + 
                sortedCategories.map(cat => `<option value="${cat}">${cat}</option>`).join('');
            if (currentValue && sortedCategories.includes(currentValue)) {
                categorySelect.value = currentValue;
            }

            // Í∞ïÏùò ÏàòÏ†ï Î™®Îã¨Ïùò ÎìúÎ°≠Îã§Ïö¥
            const editCategorySelect = document.getElementById('editCategory');
            if (editCategorySelect) {
                const editCurrentValue = editCategorySelect.value;
                editCategorySelect.innerHTML = sortedCategories.map(cat => `<option value="${cat}">${cat}</option>`).join('');
                if (editCurrentValue && sortedCategories.includes(editCurrentValue)) {
                    editCategorySelect.value = editCurrentValue;
                }
            }
        }

        // ============================================
        // ÏÑ∏ÏÖò Í¥ÄÎ¶¨ Ìï®ÏàòÎì§ (ÏÖÄ Í∏∞Î∞ò Î∞©Ïãù)
        // ============================================

        function openSessionModal() {
            updateSessionListInModal();
            document.getElementById('sessionModal').classList.add('active');
        }

        function closeSessionModal() {
            document.getElementById('sessionModal').classList.remove('active');
        }
        
        // ÏÖÄ ÌÅ¥Î¶≠Ïãú ÏÑ∏ÏÖò Ï∂îÍ∞Ä Î™®Îã¨
        function openCellSessionModal(time, room) {
            const existingSession = sessions.find(s => s.time === time && s.room === room);
            
            // Î™®Îã¨ Ï†úÎ™© ÏÑ§Ï†ï
            document.getElementById('cellSessionModalTitle').textContent = existingSession ? 'üìã ÏÑ∏ÏÖò ÏàòÏ†ï' : 'üìã ÏÑ∏ÏÖò Ï∂îÍ∞Ä';
            
            // ÌïÑÎìú Ï¥àÍ∏∞Ìôî/Ï±ÑÏö∞Í∏∞
            document.getElementById('cellSessionTime').value = time;
            document.getElementById('cellSessionRoom').value = room;
            document.getElementById('cellSessionId').value = existingSession ? existingSession.id : '';
            document.getElementById('cellSessionName').value = existingSession ? existingSession.name : '';
            document.getElementById('cellSessionNameEn').value = existingSession ? existingSession.nameEn : '';
            document.getElementById('cellSessionModerator').value = existingSession ? existingSession.moderator : '';
            document.getElementById('cellSessionModeratorEn').value = existingSession ? existingSession.moderatorEn : '';
            
            // ÏÉâÏÉÅ ÏÑ†ÌÉù
            const colors = ['#3498DB', '#E74C3C', '#2ECC71', '#9B59B6', '#F39C12', '#1ABC9C', '#E91E63', '#00BCD4'];
            const defaultColor = existingSession ? existingSession.color : colors[sessions.length % colors.length];
            document.getElementById('cellSessionColor').value = defaultColor;
            
            // ÏÉâÏÉÅ Î≤ÑÌäº ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
            document.querySelectorAll('#sessionColorPicker .color-btn').forEach(btn => {
                btn.classList.toggle('selected', btn.dataset.color === defaultColor);
            });
            
            // Ï¢åÏû• Ï∂îÏ≤ú Î™©Î°ù Ï±ÑÏö∞Í∏∞ (Ïó∞Ïûê Î™©Î°ù Í∏∞Î∞ò)
            const datalist = document.getElementById('moderatorSuggestions');
            datalist.innerHTML = speakers.map(s => `<option value="${s.name}">`).join('');
            
            // Î™®Îã¨ Ïó¥Í∏∞
            document.getElementById('cellSessionModal').classList.add('active');
            document.getElementById('cellSessionName').focus();
        }
        
        function closeCellSessionModal() {
            document.getElementById('cellSessionModal').classList.remove('active');
        }
        
        function saveCellSession() {
            const time = document.getElementById('cellSessionTime').value;
            const room = document.getElementById('cellSessionRoom').value;
            const sessionId = document.getElementById('cellSessionId').value;
            const name = document.getElementById('cellSessionName').value.trim();
            const nameEn = document.getElementById('cellSessionNameEn').value.trim();
            const moderator = document.getElementById('cellSessionModerator').value.trim();
            const moderatorEn = document.getElementById('cellSessionModeratorEn').value.trim();
            const color = document.getElementById('cellSessionColor').value;
            
            if (!name) {
                alert('ÏÑ∏ÏÖòÎ™ÖÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                document.getElementById('cellSessionName').focus();
                return;
            }
            
            // Ï¢åÏû•Ïù¥ ÏûÖÎ†•Îêú Í≤ΩÏö∞ Ïó∞Ïûê Î™©Î°ùÏóêÏÑú ÏòÅÎ¨∏Î™Ö Ï∞æÍ∏∞
            let finalModeratorEn = moderatorEn;
            if (moderator && !moderatorEn) {
                const foundSpeaker = speakers.find(s => s.name === moderator);
                if (foundSpeaker && foundSpeaker.nameEn) {
                    finalModeratorEn = foundSpeaker.nameEn;
                }
            }
            
            saveStateForUndo();
            
            const existingSession = sessionId ? sessions.find(s => s.id == sessionId) : null;
            
            if (existingSession) {
                // Í∏∞Ï°¥ ÏÑ∏ÏÖò ÏàòÏ†ï
                existingSession.name = name;
                existingSession.nameEn = nameEn;
                existingSession.moderator = moderator;
                existingSession.moderatorEn = finalModeratorEn;
                existingSession.color = color;
            } else {
                // ÏÉà ÏÑ∏ÏÖò Ï∂îÍ∞Ä
                const newSession = {
                    id: Date.now(),
                    name: name,
                    nameEn: nameEn,
                    moderator: moderator,
                    moderatorEn: finalModeratorEn,
                    time: time,
                    room: room,
                    color: color
                };
                sessions.push(newSession);
            }
            
            saveAndSync();
            updateScheduleDisplay();
            closeCellSessionModal();
        }
        
        // ÏÉâÏÉÅ ÏÑ†ÌÉù Ïù¥Î≤§Ìä∏
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('#sessionColorPicker .color-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('#sessionColorPicker .color-btn').forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                    document.getElementById('cellSessionColor').value = this.dataset.color;
                });
            });
            
            // Ï¢åÏû• ÏûÖÎ†• Ïãú Ïó∞Ïûê Î™©Î°ùÏóêÏÑú ÏòÅÎ¨∏Î™Ö ÏûêÎèô Ï±ÑÏö∞Í∏∞
            document.getElementById('cellSessionModerator').addEventListener('change', function() {
                const moderator = this.value.trim();
                const foundSpeaker = speakers.find(s => s.name === moderator);
                if (foundSpeaker && foundSpeaker.nameEn) {
                    document.getElementById('cellSessionModeratorEn').value = foundSpeaker.nameEn;
                }
            });
        });
        
        function editCellSession(time, room) {
            // ÏÑ∏ÏÖò ÏàòÏ†ïÏùÄ Í∞ôÏùÄ Î™®Îã¨ ÏÇ¨Ïö©
            openCellSessionModal(time, room);
        }
        
        function removeSession(time, room) {
            if (!confirm('Ïù¥ ÏÑ∏ÏÖòÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) return;
            
            saveStateForUndo();
            sessions = sessions.filter(s => !(s.time === time && s.room === room));
            saveAndSync();
            updateScheduleDisplay();
        }

        function updateSessionListInModal() {
            const list = document.getElementById('sessionList');
            
            if (sessions.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: var(--text-light); padding: 2rem;">ÏÑ∏ÏÖòÏù¥ ÏóÜÏäµÎãàÎã§. ÏãúÍ∞ÑÌëúÏóêÏÑú "+ ÏÑ∏ÏÖò" Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌïòÏó¨ Ï∂îÍ∞ÄÌïòÏÑ∏Ïöî.</p>';
                return;
            }

            // Î£∏Î≥ÑÎ°ú Í∑∏Î£πÌôî
            const sessionsByRoom = {};
            rooms.forEach(room => {
                sessionsByRoom[room] = sessions.filter(s => s.room === room);
            });

            let html = '';
            rooms.forEach(room => {
                const roomSessions = sessionsByRoom[room];
                if (roomSessions.length > 0) {
                    html += `<div style="margin-bottom: 1rem;">
                        <h4 style="color: var(--primary); margin-bottom: 0.5rem; padding-bottom: 0.25rem; border-bottom: 2px solid var(--border);">üìç ${room}</h4>`;
                    
                    roomSessions.forEach(session => {
                        html += `
                            <div class="speaker-item" style="border-left: 4px solid ${session.color}; margin-bottom: 0.5rem;">
                                <div class="speaker-info">
                                    <strong>${session.name}</strong>
                                    <small>üë§ Ï¢åÏû•: ${session.moderator || 'ÎØ∏Ï†ï'} | üïê ${session.time}</small>
                                </div>
                                <div class="speaker-actions">
                                    <button class="btn btn-secondary btn-small" onclick="editCellSession('${session.time}', '${session.room}'); updateSessionListInModal();">ÏàòÏ†ï</button>
                                    <button class="btn btn-secondary btn-small" onclick="removeSession('${session.time}', '${session.room}'); updateSessionListInModal();">ÏÇ≠Ï†ú</button>
                                </div>
                            </div>
                        `;
                    });
                    
                    html += '</div>';
                }
            });

            list.innerHTML = html;
        }

        // ============================================
        // Ïñ∏Ïñ¥ Ï†ÑÌôò Ìï®Ïàò
        // ============================================
        
        function setLanguage(lang) {
            currentLanguage = lang;
            
            // Î≤ÑÌäº Ïä§ÌÉÄÏùº ÏóÖÎç∞Ïù¥Ìä∏
            const koBtn = document.getElementById('langKoBtn');
            const enBtn = document.getElementById('langEnBtn');
            
            if (lang === 'ko') {
                koBtn.style.background = 'var(--accent)';
                koBtn.style.color = 'white';
                enBtn.style.background = 'rgba(255,255,255,0.2)';
                enBtn.style.color = 'white';
            } else {
                enBtn.style.background = 'var(--accent)';
                enBtn.style.color = 'white';
                koBtn.style.background = 'rgba(255,255,255,0.2)';
                koBtn.style.color = 'white';
            }
            
            // ÏãúÍ∞ÑÌëú ÏóÖÎç∞Ïù¥Ìä∏
            updateScheduleDisplay();
            
            console.log(`Ïñ∏Ïñ¥ Î≥ÄÍ≤Ω: ${lang === 'ko' ? 'ÌïúÍ∏Ä' : 'English'}`);
        }
        
        // ============================================
        // ÎÇ†Ïßú Ï†ÑÌôò Ìï®Ïàò
        // ============================================
        
        function switchDate(date) {
            // ÌòÑÏû¨ ÎÇ†Ïßú Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
            saveToFirebase(); // FirebaseÏóê ÌòÑÏû¨ Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
            
            // ÎÇ†Ïßú Î≥ÄÍ≤Ω
            currentDate = date;
            rooms = ROOMS_BY_DATE[date] || [];
            
            // Ìï¥Îãπ ÎÇ†Ïßú Îç∞Ïù¥ÌÑ∞ Î°úÎìú
            loadDateData(date);
            
            // UI ÏóÖÎç∞Ïù¥Ìä∏
            document.querySelectorAll('.date-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.date === date);
            });
            
            // ÏãúÍ∞ÑÌëú Îã§Ïãú ÏÉùÏÑ±
            createScheduleTable();
            updateLectureList();
            
            console.log(`ÎÇ†Ïßú Î≥ÄÍ≤Ω: ${date}`);
        }
        
        // ÎÇ†ÏßúÎ≥Ñ Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ìï®Ïàò
        function loadDateData(date) {
            const dateData = dataByDate[date];
            if (dateData) {
                lectures = dateData.lectures || [];
                schedule = dateData.schedule || {};
                sessions = dateData.sessions || [];
            } else {
                // Ìï¥Îãπ ÎÇ†Ïßú Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏúºÎ©¥ Ï¥àÍ∏∞Ìôî
                lectures = [];
                schedule = {};
                sessions = [];
                dataByDate[date] = { lectures: [], schedule: {}, sessions: [] };
            }
            console.log(`ÎÇ†Ïßú Îç∞Ïù¥ÌÑ∞ Î°úÎìú: ${date} - Í∞ïÏùò ${lectures.length}Í∞ú, ÏÑ∏ÏÖò ${sessions.length}Í∞ú`);
        }
        
        function saveAllDataToStorage() {
            // Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄ Î∞±ÏóÖ (Ïò§ÌîÑÎùºÏù∏Ïö©)
            try {
                localStorage.setItem('conference_data_by_date', JSON.stringify(dataByDate));
                localStorage.setItem('conference_current_date', currentDate);
                localStorage.setItem('conference_speakers', JSON.stringify(speakers));
                localStorage.setItem('conference_categories', JSON.stringify(categories));
            } catch (error) {
                console.error('Î°úÏª¨ Ï†ÄÏû• Ïò§Î•ò:', error);
            }
        }
        
        function loadAllDataFromStorage() {
            try {
                const savedDataByDate = localStorage.getItem('conference_data_by_date');
                const savedCurrentDate = localStorage.getItem('conference_current_date');
                const savedSpeakers = localStorage.getItem('conference_speakers');
                const savedCategories = localStorage.getItem('conference_categories');
                
                if (savedDataByDate) {
                    dataByDate = JSON.parse(savedDataByDate);
                }
                
                if (savedCurrentDate && CONFERENCE_DATES.some(d => d.date === savedCurrentDate)) {
                    currentDate = savedCurrentDate;
                }
                
                // speakersÎäî Ï†ÄÏû•Îêú Í≤å ÏûàÍ≥† ÎπÑÏñ¥ÏûàÏßÄ ÏïäÏùÑ ÎïåÎßå Î°úÎìú
                if (savedSpeakers) {
                    const parsed = JSON.parse(savedSpeakers);
                    if (parsed && parsed.length > 0) {
                        speakers = parsed;
                    }
                }
                // speakersÍ∞Ä ÎπÑÏñ¥ÏûàÏúºÎ©¥ Í∏∞Î≥∏Í∞í(SPEAKERS_DATA) Ïú†ÏßÄ
                
                if (savedCategories) {
                    const parsed = JSON.parse(savedCategories);
                    if (parsed && parsed.length > 0) {
                        categories = parsed;
                    }
                }
                
                // ÌòÑÏû¨ ÎÇ†Ïßú Îç∞Ïù¥ÌÑ∞ Î°úÎìú
                rooms = ROOMS_BY_DATE[currentDate] || [];
                loadDateData(currentDate);
                
                // UI ÏóÖÎç∞Ïù¥Ìä∏
                document.querySelectorAll('.date-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.date === currentDate);
                });
                
                console.log('Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄ Î°úÎìú ÏôÑÎ£å - speakers:', speakers.length, 'Î™Ö');
                
            } catch (error) {
                console.error('Îç∞Ïù¥ÌÑ∞ Î∂àÎü¨Ïò§Í∏∞ Ïò§Î•ò:', error);
            }
        }
        
        // ============================================
        // Ïπ¥Îìú Ï†ëÍ∏∞/ÌéºÏπòÍ∏∞
        // ============================================
        
        function toggleCard(cardId) {
            const card = document.getElementById(cardId);
            if (card) {
                card.classList.toggle('collapsed');
                // ÏÉÅÌÉú Ï†ÄÏû•
                const collapsed = card.classList.contains('collapsed');
                localStorage.setItem(`card_${cardId}_collapsed`, collapsed);
            }
        }
        
        function loadCardStates() {
            ['addLectureCard', 'lectureListCard'].forEach(cardId => {
                const collapsed = localStorage.getItem(`card_${cardId}_collapsed`) === 'true';
                const card = document.getElementById(cardId);
                if (card && collapsed) {
                    card.classList.add('collapsed');
                }
            });
        }

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Îç∞Ïù¥ÌÑ∞ Î∂àÎü¨Ïò§Í∏∞ Î∞è Ï¥àÍ∏∞Ìôî
        console.log('=== Ï¥àÍ∏∞Ìôî ÏãúÏûë ===');
        console.log('SPEAKERS_DATA Ïàò:', SPEAKERS_DATA.length);
        console.log('speakers Ï¥àÍ∏∞Í∞í:', speakers.length);
        
        // renderSessionBarsÎäî updateScheduleDisplayÏóêÏÑú Ï≤òÎ¶¨ÎêòÎØÄÎ°ú Îπà Ìï®ÏàòÎ°ú Ïú†ÏßÄ
        function renderSessionBars() {
            // ÏÑ∏ÏÖò Î†åÎçîÎßÅÏùÄ updateScheduleDisplayÏóêÏÑú Ï≤òÎ¶¨Îê®
        }
        
        loadAllDataFromStorage();
        loadCardStates();
        
        console.log('Î°úÎìú ÌõÑ speakers:', speakers.length);
        
        updateCategoryDropdowns();
        createCategoryFilters();
        createScheduleTable();
        updateLectureList();
        console.log('=== Ï¥àÍ∏∞Ìôî ÏôÑÎ£å ===');

        window.onclick = function(event) {
            if (event.target.className === 'modal active') {
                event.target.classList.remove('active');
            }
        }
    </script>
</body>
</html>
