<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•™ìˆ ëŒ€íšŒ ìŠ¤ì¼€ì¤„ëŸ¬</title>
    <!-- Google API -->
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="https://accounts.google.com/gsi/client"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&family=Playfair+Display:wght@700;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #2E1A47;
            --primary-light: #4A2E6C;
            --accent: #FF6B9D;
            --accent-light: #FFB3D1;
            --bg: #F8F7FC;
            --white: #FFFFFF;
            --text: #1A1A1A;
            --text-light: #666666;
            --border: #E0DDE8;
            --shadow: rgba(46, 26, 71, 0.1);
        }
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #F8F7FC 0%, #EDE9F5 100%);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: var(--white);
            padding: 2rem 3rem;
            box-shadow: 0 4px 20px var(--shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            font-weight: 900;
            letter-spacing: -0.5px;
        }
        
        .header-actions {
            display: flex;
            gap: 1rem;
        }
        
        .container {
            display: flex;
            gap: 2rem;
            padding: 2rem 3rem;
            max-width: 1800px;
            margin: 0 auto;
        }
        
        .sidebar {
            width: 420px;
            flex-shrink: 0;
        }
        
        .card {
            background: var(--white);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 12px var(--shadow);
            border: 1px solid var(--border);
        }
        
        .card-title {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            user-select: none;
        }
        
        .card-title .toggle-icon {
            margin-left: auto;
            transition: transform 0.3s;
            font-size: 1rem;
        }
        
        .card.collapsed .card-title .toggle-icon {
            transform: rotate(-90deg);
        }
        
        .card-content {
            transition: all 0.3s ease;
            overflow: hidden;
        }
        
        .card.collapsed .card-content {
            max-height: 0;
            opacity: 0;
            margin: 0;
            padding: 0;
        }
        
        .lecture-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.4rem;
        }
        
        .form-group label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-light);
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 0.75rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 0.95rem;
            font-family: 'Noto Sans KR', sans-serif;
            transition: all 0.2s;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(255, 107, 157, 0.1);
        }
        
        .form-row {
            display: flex;
            gap: 0.75rem;
        }
        
        .form-row .form-group {
            flex: 1;
            min-width: 0;
        }
        
        .form-row .form-group input,
        .form-row .form-group select {
            width: 100%;
            box-sizing: border-box;
        }
        
        .btn {
            padding: 0.875rem 1.5rem;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Noto Sans KR', sans-serif;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--accent) 0%, #FF8CB4 100%);
            color: var(--white);
            box-shadow: 0 4px 12px rgba(255, 107, 157, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 157, 0.4);
        }
        
        .btn-secondary {
            background: var(--white);
            color: var(--primary);
            border: 2px solid var(--primary);
        }
        
        .btn-secondary:hover {
            background: var(--primary);
            color: var(--white);
        }

        .btn-small {
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
        }
        
        .category-filters {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        
        .category-filter-btn {
            padding: 0.25rem 0.5rem;
            border: 2px solid;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            background: var(--white);
        }
        
        .category-filter-btn.active {
            color: var(--white) !important;
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        
        .lecture-list {
            max-height: calc(100vh - 400px);
            min-height: 200px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .card.collapsed + .card .lecture-list {
            max-height: calc(100vh - 180px);
        }
        
        .lecture-item {
            background: linear-gradient(135deg, #FFFFFF 0%, #F8F7FC 100%);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
            cursor: grab;
            transition: all 0.2s;
            position: relative;
        }
        
        .lecture-item.scheduled {
            background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);
            border-color: #4CAF50;
        }
        
        .lecture-item:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transform: translateY(-2px);
        }
        
        .lecture-item.dragging {
            opacity: 0.5;
            cursor: grabbing;
        }
        
        .lecture-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--primary);
            font-size: 0.95rem;
        }
        
        .lecture-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            font-size: 0.8rem;
        }
        
        .tag {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .tag-speaker {
            background: #E3F2FD;
            color: #1565C0;
        }
        
        .schedule-grid {
            flex: 1;
            background: var(--white);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 2px 12px var(--shadow);
            border: 1px solid var(--border);
            overflow-x: auto;
        }
        
        .grid-header {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            align-items: center;
        }
        
        .grid-header h2 {
            font-family: 'Playfair Display', serif;
            color: var(--primary);
            font-size: 1.75rem;
        }
        
        .date-selector {
            margin-left: auto;
            padding: 0.5rem 1rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-family: 'Noto Sans KR', sans-serif;
        }
        
        /* ì‹œê°„í‘œ ì»¨í…Œì´ë„ˆ - ê°€ë¡œ ìŠ¤í¬ë¡¤ */
        .schedule-table-wrapper {
            overflow-x: auto;
            overflow-y: visible;
            padding-bottom: 1rem;
            position: relative;
        }
        
        .schedule-table {
            display: grid;
            gap: 1px;
            background: var(--border);
            border: 2px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
            min-width: max-content;
        }
        
        /* ì‹œê°„ì—´ ê³ ì • */
        .time-header,
        .time-cell {
            position: sticky;
            left: 0;
            z-index: 10;
            background: var(--bg);
        }
        
        .time-header {
            background: var(--primary);
            z-index: 11;
        }
        
        .room-header {
            background: var(--primary);
            color: var(--white);
            padding: 0.75rem 0.5rem;
            font-weight: 700;
            text-align: center;
            font-size: 0.85rem;
            min-width: 140px;
        }
        
        .time-header {
            min-width: 55px;
            padding: 0.75rem 0.25rem;
            color: var(--white);
        }
        
        /* ë£¸ í—¤ë” ìˆ˜ì • ê°€ëŠ¥ */
        .room-header {
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .room-header:hover {
            background: var(--primary-light);
        }
        
        .room-header input {
            background: transparent;
            border: none;
            color: white;
            font-weight: 700;
            text-align: center;
            font-size: 0.85rem;
            width: 100%;
            padding: 0;
        }
        
        .room-header input:focus {
            outline: 2px solid var(--accent);
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
        }
        
        .time-cell {
            background: var(--bg);
            padding: 0.25rem 0.15rem;
            font-size: 0.7rem;
            font-weight: 600;
            text-align: right;
            color: var(--text-light);
            position: relative;
            min-width: 55px;
        }
        
        /* 30ë¶„ ë‹¨ìœ„ ì§„í•œ ì„  */
        .time-cell.hour-mark {
            border-top: 2px solid var(--primary);
            font-weight: 700;
            color: var(--primary);
        }
        
        /* 15ë¶„ ë‹¨ìœ„ ì—°í•œ ì„  */
        .time-cell.quarter-mark {
            border-top: 1px solid #e0e0e0;
        }
        
        /* 5ë¶„ ë‹¨ìœ„ - êµ¬ë¶„ì„  ì—†ìŒ */
        .time-cell.five-min {
            font-size: 0.65rem;
            color: #ccc;
            padding: 0.25rem;
            border-top: none;
        }
        
        /* ì‹œê°„ ì—´ - 30ë¶„ë§ˆë‹¤ë§Œ ì‹œê°„ í‘œì‹œ */
        .time-cell .time-label {
            display: block;
        }
        
        .time-cell.five-min .time-label {
            visibility: hidden;
        }
        
        /* ë£¸ ì»¬ëŸ¼ ì»¨í…Œì´ë„ˆ */
        .room-column {
            position: relative;
            background: var(--white);
            min-height: 20px;
        }
        
        /* ë“œë˜ê·¸ ì¤‘ 5ë¶„ ëˆˆê¸ˆ í‘œì‹œ */
        .room-column.dragging-over::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: repeating-linear-gradient(
                to bottom,
                transparent 0px,
                transparent 19px,
                rgba(46, 26, 71, 0.1) 19px,
                rgba(46, 26, 71, 0.1) 20px
            );
            pointer-events: none;
            z-index: 1;
        }
        
        /* ë“œë˜ê·¸ íˆ´íŒ */
        .drag-tooltip {
            position: fixed;
            background: var(--primary);
            color: white;
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            font-size: 0.8rem;
            pointer-events: none;
            z-index: 10000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            white-space: nowrap;
        }
        
        .drag-tooltip .time-info {
            font-weight: 700;
        }
        
        /* ìƒˆë¡œìš´ ìŠ¤ì¼€ì¤„ ì…€ (5ë¶„ ë‹¨ìœ„) */
        .schedule-row {
            display: contents;
        }
        
        .schedule-cell {
            background: var(--white);
            min-height: 20px;
            position: relative;
            transition: all 0.2s;
            padding: 0;
        }
        
        /* 30ë¶„ ë‹¨ìœ„ êµ¬ë¶„ì„  */
        .schedule-cell.hour-mark {
            border-top: 2px solid var(--primary-light);
        }
        
        /* 15ë¶„ ë‹¨ìœ„ êµ¬ë¶„ì„  */
        .schedule-cell.quarter-mark {
            border-top: 1px solid #e0e0e0;
        }
        
        /* 5ë¶„ ë‹¨ìœ„ëŠ” êµ¬ë¶„ì„  ì—†ìŒ (ê¹”ë”í•˜ê²Œ) */
        .schedule-cell.five-min {
            border-top: none;
        }
        
        .schedule-cell.drag-over,
        .schedule-cell.drag-target {
            background: rgba(255, 107, 157, 0.15) !important;
            box-shadow: inset 0 0 0 2px var(--accent);
        }
        
        .schedule-cell.has-session {
            padding-top: 0;
        }
        
        /* ì„¸ì…˜ í—¤ë” (ì…€ ë‚´ë¶€) */
        .session-header-cell {
            background: linear-gradient(135deg, #3498DB 0%, #2980B9 100%);
            color: white;
            padding: 0.35rem 0.5rem;
            font-size: 0.75rem;
            font-weight: 600;
            margin: -0.25rem -0.25rem 0.25rem -0.25rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }
        
        .session-header-cell:hover {
            filter: brightness(1.1);
        }
        
        .session-header-cell .session-name {
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .session-header-cell .session-moderator {
            font-size: 0.65rem;
            opacity: 0.9;
            margin-left: 0.5rem;
        }
        
        .session-header-cell .session-remove {
            background: rgba(255,255,255,0.3);
            border: none;
            color: white;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0.7rem;
            margin-left: 0.25rem;
        }
        
        /* ì„¸ì…˜ ì¶”ê°€ ë²„íŠ¼ */
        .add-session-btn {
            position: absolute;
            top: 2px;
            left: 2px;
            background: rgba(52, 152, 219, 0.1);
            border: 1px dashed #3498DB;
            color: #3498DB;
            padding: 0.15rem 0.35rem;
            border-radius: 4px;
            font-size: 0.65rem;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 5;
        }
        
        .schedule-cell:hover .add-session-btn {
            opacity: 1;
        }
        
        .add-session-btn:hover {
            background: #3498DB;
            color: white;
        }
        
        /* ì„¸ì…˜ ë‚´ ê°•ì˜ (ë“¤ì—¬ì“°ê¸°) */
        .scheduled-lecture.in-session {
            margin-left: 0.5rem;
            border-left: 3px solid rgba(255,255,255,0.5);
        }
        
        .scheduled-lecture {
            color: var(--white);
            padding: 0.5rem;
            border-radius: 6px;
            font-size: 0.8rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            position: absolute;
            left: 2px;
            right: 2px;
            z-index: 10;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .scheduled-lecture:hover {
            z-index: 20;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
        }
        
        .scheduled-lecture .lecture-title-display {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            font-weight: 600;
            font-size: 0.8rem;
            line-height: 1.3;
            margin-bottom: 0.25rem;
        }
        
        .scheduled-lecture .lecture-meta-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.7rem;
            opacity: 0.9;
            margin-top: auto;
        }
        
        .scheduled-lecture .speaker-name {
            font-weight: 500;
        }
        
        .scheduled-lecture .duration-badge {
            background: rgba(255,255,255,0.2);
            padding: 0.1rem 0.3rem;
            border-radius: 3px;
            font-size: 0.65rem;
        }
        
        .scheduled-lecture small {
            opacity: 0.9;
            font-size: 0.7rem;
        }
        
        .remove-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: rgba(255, 255, 255, 0.3);
            color: var(--white);
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            font-size: 1rem;
            line-height: 1;
            transition: all 0.2s;
        }
        
        .remove-btn:hover {
            background: rgba(255, 255, 255, 0.5);
            transform: scale(1.1);
        }
        
        .export-section {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--bg);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--accent);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.2s;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--white);
            padding: 2rem;
            border-radius: 16px;
            max-width: 700px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-header h2 {
            font-size: 1.5rem;
            color: var(--primary);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: var(--text-light);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s;
        }

        .modal-close:hover {
            background: var(--bg);
            color: var(--primary);
        }

        .speaker-list {
            max-height: 400px;
            overflow-y: auto;
            border: 2px solid var(--border);
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .speaker-item {
            padding: 1rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s;
        }

        .speaker-item:hover {
            background: var(--bg);
        }

        .speaker-item:last-child {
            border-bottom: none;
        }

        .speaker-info strong {
            display: block;
            margin-bottom: 0.25rem;
            color: var(--primary);
        }

        .speaker-info small {
            color: var(--text-light);
            display: block;
            margin-top: 0.25rem;
        }

        .speaker-actions {
            display: flex;
            gap: 0.5rem;
        }

        .search-sort-container {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            align-items: center;
        }

        .search-input {
            flex: 1;
            padding: 0.75rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 0.95rem;
            font-family: 'Noto Sans KR', sans-serif;
            transition: all 0.2s;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(255, 107, 157, 0.1);
        }

        .sort-select {
            padding: 0.75rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 0.95rem;
            font-family: 'Noto Sans KR', sans-serif;
            background: var(--white);
            cursor: pointer;
            min-width: 150px;
        }

        .sort-select:focus {
            outline: none;
            border-color: var(--accent);
        }

        .autocomplete-container {
            position: relative;
        }

        .autocomplete-list {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--white);
            border: 2px solid var(--border);
            border-top: none;
            border-radius: 0 0 8px 8px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 100;
            box-shadow: 0 4px 12px var(--shadow);
            display: none;
        }

        .autocomplete-list.active {
            display: block;
        }

        .autocomplete-item {
            padding: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 1px solid var(--border);
        }

        .autocomplete-item:hover {
            background: var(--bg);
        }

        .autocomplete-item.selected {
            background: var(--primary);
            color: white;
        }

        .autocomplete-item.selected strong {
            color: white;
        }

        .autocomplete-item.selected small {
            color: rgba(255, 255, 255, 0.8);
        }

        .autocomplete-item:last-child {
            border-bottom: none;
        }

        .autocomplete-item strong {
            display: block;
            color: var(--primary);
        }

        .autocomplete-item small {
            color: var(--text-light);
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .category-color {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }

        /* í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ ìŠ¤íƒ€ì¼ */
        .confirm-dialog {
            background: var(--white);
            padding: 2rem;
            border-radius: 16px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }

        .confirm-dialog h3 {
            font-size: 1.25rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .confirm-dialog p {
            color: var(--text);
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .confirm-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        .form-grid-4 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        /* ë§ë°”ê¾¸ê¸° ë‹¤ì´ì–¼ë¡œê·¸ */
        .swap-dialog-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }
        
        .swap-dialog {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            max-width: 420px;
            width: 90%;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        
        .swap-dialog h3 {
            margin-bottom: 1rem;
            color: var(--primary);
        }
        
        .swap-dialog p {
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }
        
        .swap-options {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-top: 1.25rem;
        }
        
        .swap-option {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            background: white;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        
        .swap-option:hover, .swap-option:focus {
            border-color: var(--accent);
            background: rgba(255, 107, 157, 0.1);
            outline: none;
        }
        
        .swap-option.cancel {
            border-color: #ddd;
            color: #666;
        }
        
        .swap-option.cancel:hover {
            border-color: #999;
            background: #f5f5f5;
        }
        
        .option-key {
            background: var(--primary);
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
            min-width: 28px;
            text-align: center;
        }
        
        .swap-option.cancel .option-key {
            background: #999;
        }
        
        /* ìƒ‰ìƒ ì„ íƒ ë²„íŠ¼ */
        .color-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: 3px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .color-btn:hover {
            transform: scale(1.1);
        }
        
        .color-btn.selected {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px white, 0 0 0 4px var(--primary);
        }
        
        /* ë²ˆì—­ ë„ì›€ë§ ë§í¬ */
        .translation-help {
            font-size: 0.75rem;
            color: #888;
            margin-top: 4px;
        }
        
        .translation-help a {
            color: var(--accent);
            text-decoration: none;
            margin: 0 2px;
        }
        
        .translation-help a:hover {
            text-decoration: underline;
        }
        
        /* ë“œë˜ê·¸ íˆ´íŒ */
        .drag-tooltip {
            position: fixed;
            background: var(--primary);
            color: white;
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            font-size: 0.8rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            pointer-events: none;
            z-index: 10000;
            display: none;
            white-space: nowrap;
        }
        
        .drag-tooltip.active {
            display: block;
        }
        
        .drag-tooltip .tooltip-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .drag-tooltip .tooltip-time {
            font-size: 0.9rem;
            opacity: 0.95;
        }
        
        .drag-tooltip .tooltip-duration {
            font-size: 0.75rem;
            opacity: 0.8;
            margin-top: 0.15rem;
        }
        
        /* ë“œë˜ê·¸ ì¤‘ 5ë¶„ ëˆˆê¸ˆ í‘œì‹œ */
        .schedule-grid.dragging .schedule-cell::before {
            content: '';
            position: absolute;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;
            background: repeating-linear-gradient(
                to bottom,
                transparent 0px,
                transparent 19px,
                rgba(46, 26, 71, 0.08) 19px,
                rgba(46, 26, 71, 0.08) 20px
            );
            pointer-events: none;
            z-index: 1;
        }
        
        /* ë“œë˜ê·¸ ì¤‘ 30ë¶„ ë‹¨ìœ„ ê°•ì¡° */
        .schedule-grid.dragging .schedule-cell.hour-mark::after {
            content: '';
            position: absolute;
            left: 0;
            right: 0;
            top: 0;
            height: 2px;
            background: var(--primary);
            z-index: 2;
        }
        
        /* ë“œë˜ê·¸ ì˜¤ë²„ ì‹œ í˜„ì¬ ì…€ í•˜ì´ë¼ì´íŠ¸ */
        .schedule-cell.drag-target {
            background: rgba(255, 107, 157, 0.15) !important;
            box-shadow: inset 0 0 0 2px var(--accent);
        }
        
        /* 5ë¶„ ë‹¨ìœ„ ì…€ ë†’ì´ ì¡°ì • */
        .schedule-cell {
            min-height: 20px;
            height: 20px;
        }
        
        .time-cell {
            min-height: 20px;
            height: 20px;
            display: flex;
            align-items: flex-start;
            justify-content: flex-end;
            padding-right: 0.5rem;
            font-size: 0.75rem;
            color: var(--text-light);
        }
        
        .time-cell.hour-mark {
            font-weight: 600;
            color: var(--primary);
            border-top: 2px solid var(--primary-light);
        }
        
        .time-cell.quarter-mark {
            color: var(--text-light);
            border-top: 1px solid var(--border);
        }
        
        .time-cell.five-min .time-label {
            display: none;
        }
    </style>
</head>
<body>
    <!-- ë“œë˜ê·¸ íˆ´íŒ -->
    <div class="drag-tooltip" id="dragTooltip">
        <div class="tooltip-title" id="tooltipTitle"></div>
        <div class="tooltip-time" id="tooltipTime"></div>
        <div class="tooltip-duration" id="tooltipDuration"></div>
    </div>

    <div class="header">
        <div>
            <h1>ğŸ“… í•™ìˆ ëŒ€íšŒ ìŠ¤ì¼€ì¤„ëŸ¬</h1>
        </div>
        <div class="header-actions">
            <div id="googleUserInfo" style="display: none; align-items: center; gap: 0.5rem; margin-right: 1rem;">
                <img id="googleUserAvatar" src="" alt="" style="width: 32px; height: 32px; border-radius: 50%;">
                <span id="googleUserName" style="font-size: 0.9rem;"></span>
            </div>
            <!-- í•œê¸€/ì˜ë¬¸ ì „í™˜ ë²„íŠ¼ -->
            <div style="display: flex; border-radius: 6px; overflow: hidden; margin-right: 0.5rem;">
                <button class="btn btn-small" id="langKoBtn" onclick="setLanguage('ko')" style="background: var(--accent); color: white; border-radius: 6px 0 0 6px;">í•œê¸€</button>
                <button class="btn btn-small" id="langEnBtn" onclick="setLanguage('en')" style="background: rgba(255,255,255,0.2); color: white; border-radius: 0 6px 6px 0;">English</button>
            </div>
            <button class="btn btn-secondary btn-small" id="googleAuthBtn" onclick="handleGoogleAuth()">ğŸ” Google ë¡œê·¸ì¸</button>
            <button class="btn btn-secondary btn-small" id="undoBtn" onclick="performUndo()" disabled>â†© ë˜ëŒë¦¬ê¸° (0/5)</button>
            <button class="btn btn-secondary btn-small" onclick="openSessionModal()">ğŸ“‹ ì„¸ì…˜ ê´€ë¦¬</button>
            <button class="btn btn-secondary btn-small" onclick="openHelpModal()">â“ ë„ì›€ë§</button>
            <button class="btn btn-secondary btn-small" onclick="resetAllData()">ğŸ”„ ë°ì´í„° ì´ˆê¸°í™”</button>
            <button class="btn btn-secondary btn-small" onclick="openSpeakerModal()">ğŸ‘¥ ì—°ì ê´€ë¦¬</button>
        </div>
    </div>

    <div class="container">
        <div class="sidebar">
            <div class="card" id="addLectureCard">
                <div class="card-title" onclick="toggleCard('addLectureCard')">
                    â• ê°•ì˜ ì¶”ê°€
                    <span class="toggle-icon">â–¼</span>
                </div>
                <div class="card-content">
                    <form class="lecture-form" id="lectureForm" onsubmit="return false;">
                        <div class="form-group">
                            <label>ë¶„ë¥˜</label>
                            <select id="category" required>
                                <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>ì œëª© (í•œê¸€)</label>
                            <input type="text" id="titleKo" required>
                        </div>
                        
                        <div class="form-group">
                            <label>ì œëª© (ì˜ë¬¸)</label>
                            <input type="text" id="titleEn" placeholder="English title">
                            <div class="translation-help">
                                ğŸ’¡ ë²ˆì—­: 
                                <a href="https://translate.google.com/?sl=ko&tl=en" target="_blank">Google</a> | 
                                <a href="https://papago.naver.com/" target="_blank">Papago</a> | 
                                <a href="https://www.deepl.com/translator#ko/en/" target="_blank">DeepL</a>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group autocomplete-container">
                                <label>ì—°ì (í•œê¸€)</label>
                                <input type="text" id="speakerKo" autocomplete="off" required>
                                <div class="autocomplete-list" id="autocompleteList"></div>
                            </div>
                            <div class="form-group">
                                <label>ì—°ì (ì˜ë¬¸)</label>
                                <input type="text" id="speakerEn" placeholder="Speaker name">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>ì†Œì†</label>
                                <input type="text" id="affiliation">
                            </div>
                            <div class="form-group">
                                <label>ê°•ì˜ ì‹œê°„</label>
                                <select id="lectureDuration" required>
                                    <option value="10">10ë¶„</option>
                                    <option value="15" selected>15ë¶„</option>
                                    <option value="20">20ë¶„</option>
                                    <option value="30">30ë¶„</option>
                                    <option value="40">40ë¶„</option>
                                    <option value="50">50ë¶„</option>
                                    <option value="60">60ë¶„</option>
                                </select>
                            </div>
                        </div>
                        
                        <button type="button" class="btn btn-primary" id="addLectureBtn">ê°•ì˜ ì¶”ê°€</button>
                        <button type="button" class="btn btn-secondary" onclick="openCategoryModal()" style="margin-top: 0.5rem;">ğŸ“‚ ë¶„ë¥˜ ê´€ë¦¬</button>
                    </form>
                </div>
            </div>
            
            <div class="card" id="lectureListCard">
                <div class="card-title" onclick="toggleCard('lectureListCard')">
                    ğŸ“š ê°•ì˜ ëª©ë¡
                    <span class="toggle-icon">â–¼</span>
                </div>
                <div class="card-content">
                    <div class="category-filters" id="categoryFilters"></div>
                    <div class="lecture-list" id="lectureList"></div>
                </div>
            </div>
        </div>

        <div class="schedule-grid">
            <div class="grid-header">
                <h2>ì‹œê°„í‘œ</h2>
                <button class="btn btn-small btn-secondary" onclick="addRoom()" style="margin-left: 1rem;">â• ë£¸ ì¶”ê°€</button>
                <input type="date" class="date-selector" id="scheduleDate" value="2025-10-11">
            </div>

            <div class="schedule-table-wrapper">
                <div class="schedule-table" id="scheduleTable"></div>
            </div>

            <div class="export-section">
                <button class="btn btn-primary" onclick="loadFromGoogleDrive()" id="loadDriveBtn">â˜ï¸ ë“œë¼ì´ë¸Œì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°</button>
                <button class="btn btn-primary" onclick="saveToGoogleDrive()" id="saveDriveBtn">ğŸ’¾ ë“œë¼ì´ë¸Œì— ì €ì¥</button>
                <button class="btn btn-secondary" onclick="document.getElementById('loadFileInput').click()">ğŸ“‚ ë¡œì»¬ íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°</button>
                <input type="file" id="loadFileInput" accept=".json" style="display: none;" onchange="loadFromFile(event)">
                <button class="btn btn-secondary" onclick="exportToExcel()">ğŸ“Š ì—‘ì…€ë¡œ ë‚´ë³´ë‚´ê¸°</button>
                <button class="btn btn-secondary" onclick="printSchedule()">ğŸ–¨ï¸ ì¸ì‡„/PDF</button>
            </div>
            
            <!-- ìë™ì €ì¥ ìƒíƒœ í‘œì‹œ -->
            <div id="syncStatus" style="margin-top: 1rem; padding: 0.75rem; border-radius: 8px; background: var(--bg); display: flex; align-items: center; gap: 0.5rem;">
                <span id="syncIcon">ğŸ’¾</span>
                <span id="syncText">ë¡œì»¬ì— ì €ì¥ë¨</span>
                <span id="lastSyncTime" style="margin-left: auto; font-size: 0.85rem; color: var(--text-light);"></span>
            </div>
        </div>
    </div>

    <!-- ë¶„ë¥˜ ê´€ë¦¬ ëª¨ë‹¬ -->
    <div class="modal" id="categoryModal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h2>ğŸ“‚ ë¶„ë¥˜ ê´€ë¦¬</h2>
                <button class="modal-close" onclick="closeCategoryModal()">Ã—</button>
            </div>
            
            <div class="form-group">
                <label>ìƒˆ ë¶„ë¥˜ ì¶”ê°€</label>
                <div style="display: flex; gap: 0.5rem;">
                    <input type="text" id="newCategoryName" placeholder="ë¶„ë¥˜ëª… (ì˜ë¬¸)" style="flex: 1;">
                    <input type="color" id="newCategoryColor" value="#9B59B6" style="width: 60px; height: 42px; border: none; cursor: pointer;">
                    <button class="btn btn-primary" onclick="addCategory()">ì¶”ê°€</button>
                </div>
            </div>

            <div style="margin: 1rem 0; padding: 0.75rem; background: #FFF3CD; border-radius: 8px; border-left: 4px solid #FFC107;">
                <small>âš ï¸ ë¶„ë¥˜ë¥¼ ì‚­ì œí•˜ë©´ í•´ë‹¹ ë¶„ë¥˜ì˜ ê°•ì˜ëŠ” "Others"ë¡œ ë³€ê²½ë©ë‹ˆë‹¤.</small>
            </div>

            <div class="speaker-list" id="categoryList" style="max-height: 400px;"></div>
        </div>
    </div>

    <!-- ì„¸ì…˜ ê´€ë¦¬ ëª¨ë‹¬ -->
    <div class="modal" id="sessionModal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h2>ğŸ“‹ ì„¸ì…˜ ê´€ë¦¬</h2>
                <button class="modal-close" onclick="closeSessionModal()">Ã—</button>
            </div>
            
            <div style="background: #E3F2FD; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border-left: 4px solid #2196F3;">
                <p style="margin: 0; font-size: 0.9rem;">ğŸ’¡ <strong>ì‹œê°„í‘œì—ì„œ ì…€ ìœ„ì— ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦¬ë©´ "+ ì„¸ì…˜" ë²„íŠ¼ì´ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.</strong></p>
                <p style="margin: 0.5rem 0 0 0; font-size: 0.85rem; color: #666;">ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ í•´ë‹¹ ì‹œê°„/ë£¸ì— ì„¸ì…˜ì„ ì¶”ê°€í•˜ì„¸ìš”. ì„¸ì…˜ í—¤ë”ë¥¼ í´ë¦­í•˜ë©´ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            </div>

            <div class="form-group">
                <label><strong>í˜„ì¬ ì„¸ì…˜ ëª©ë¡</strong></label>
                <div id="sessionList" style="max-height: 400px; overflow-y: auto;"></div>
            </div>
        </div>
    </div>

    <!-- ì—°ì ê´€ë¦¬ ëª¨ë‹¬ -->
    <div class="modal" id="speakerModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ‘¥ ì—°ì ê´€ë¦¬</h2>
                <button class="modal-close" onclick="closeSpeakerModal()">Ã—</button>
            </div>
            
            <div class="form-group">
                <label>ìƒˆ ì—°ì ì¶”ê°€</label>
                <div class="form-grid-4">
                    <input type="text" id="newSpeakerName" placeholder="ì—°ìëª… (í•œê¸€)">
                    <input type="text" id="newSpeakerNameEn" placeholder="ì—°ìëª… (ì˜ë¬¸)">
                    <input type="text" id="newSpeakerAffiliation" placeholder="ì†Œì† (í•œê¸€)">
                    <input type="text" id="newSpeakerAffiliationEn" placeholder="ì†Œì† (ì˜ë¬¸)">
                </div>
                <button class="btn btn-primary" onclick="addSpeaker()" style="margin-top: 0.5rem; width: 100%;">ì¶”ê°€</button>
            </div>

            <div style="margin: 1.5rem 0;">
                <div class="search-sort-container">
                    <input type="text" id="speakerSearch" class="search-input" 
                           placeholder="ğŸ” ì—°ìëª… ë˜ëŠ” ì†Œì†ìœ¼ë¡œ ê²€ìƒ‰..." 
                           oninput="searchSpeakers()">
                    <select id="speakerSort" class="sort-select" onchange="updateSpeakerList()">
                        <option value="name-ko">ê°€ë‚˜ë‹¤ìˆœ (í•œê¸€)</option>
                        <option value="name-en">ABCìˆœ (ì˜ë¬¸)</option>
                        <option value="affiliation">ì†Œì†ìˆœ</option>
                        <option value="recent">ìµœê·¼ ì¶”ê°€ìˆœ</option>
                    </select>
                </div>
            </div>

            <div class="speaker-list" id="speakerList"></div>
        </div>
    </div>

    <!-- ê°•ì˜ ìˆ˜ì • ëª¨ë‹¬ -->
    <div class="modal" id="editModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>âœï¸ ê°•ì˜ ìˆ˜ì •</h2>
                <button class="modal-close" onclick="closeEditModal()">Ã—</button>
            </div>
            
            <form class="lecture-form" id="editForm" onsubmit="return false;">
                <input type="hidden" id="editLectureId">
                <div class="form-group">
                    <label>ë¶„ë¥˜</label>
                    <select id="editCategory" required>
                        <option value="Laser & EBDs">Laser & EBDs</option>
                        <option value="Injectables">Injectables</option>
                        <option value="Lifting Devices">Lifting Devices</option>
                        <option value="Bio-Stimulators">Bio-Stimulators</option>
                        <option value="Threads">Threads</option>
                        <option value="Regeneratives">Regeneratives</option>
                        <option value="Cosmeceuticals">Cosmeceuticals</option>
                        <option value="Aesthetic Devices">Aesthetic Devices</option>
                        <option value="Diagnostic Devices">Diagnostic Devices</option>
                        <option value="Dermatology">Dermatology</option>
                        <option value="Hair">Hair</option>
                        <option value="Body Contouring">Body Contouring</option>
                        <option value="Consumables">Consumables</option>
                        <option value="AI & CRM">AI & CRM</option>
                        <option value="Management & Marketing">Management & Marketing</option>
                        <option value="Sedation & Analgesia Devices">Sedation & Analgesia Devices</option>
                        <option value="Anatomy">Anatomy</option>
                        <option value="International Faculty & Global Trends">International Faculty & Global Trends</option>
                        <option value="ASLS">ASLS</option>
                        <option value="Safety Equipment">Safety Equipment</option>
                        <option value="Digital Solutions">Digital Solutions</option>
                        <option value="Medical Supplies">Medical Supplies</option>
                        <option value="Others">Others</option>
                        <option value="Other Solutions">Other Solutions</option>
                        <option value="Stem Cell & Functional">Stem Cell & Functional</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>ì œëª© (í•œê¸€)</label>
                    <input type="text" id="editTitleKo" required>
                </div>
                
                <div class="form-group">
                    <label>ì œëª© (ì˜ë¬¸)</label>
                    <input type="text" id="editTitleEn">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>ì—°ì (í•œê¸€)</label>
                        <input type="text" id="editSpeakerKo" required>
                    </div>
                    <div class="form-group">
                        <label>ì—°ì (ì˜ë¬¸)</label>
                        <input type="text" id="editSpeakerEn">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>ì†Œì†</label>
                    <input type="text" id="editAffiliation">
                </div>
                
                <div class="form-group">
                    <label>ê°•ì˜ ì‹œê°„</label>
                    <select id="editDuration">
                        <option value="10">10ë¶„</option>
                        <option value="15">15ë¶„</option>
                        <option value="20">20ë¶„</option>
                        <option value="30">30ë¶„</option>
                        <option value="40">40ë¶„</option>
                        <option value="50">50ë¶„</option>
                        <option value="60">60ë¶„</option>
                    </select>
                </div>
                
                <div style="display: flex; gap: 0.5rem;">
                    <button type="button" class="btn btn-primary" id="saveEditBtn" style="flex: 1;">ìˆ˜ì • ì™„ë£Œ</button>
                    <button type="button" class="btn btn-secondary" id="deleteEditBtn" style="background: #E74C3C; color: white;" onclick="deleteLectureFromModal()">ğŸ—‘ï¸ ì‚­ì œ</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ì—°ì ì¶”ê°€ í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ -->
    <div class="modal" id="confirmAddSpeakerModal">
        <div class="confirm-dialog">
            <h3>ğŸ“ ìƒˆë¡œìš´ ì—°ì ì¶”ê°€</h3>
            <p id="confirmMessage"></p>
            <div class="confirm-actions">
                <button class="btn btn-secondary btn-small" onclick="closeConfirmAddSpeaker()">ì•„ë‹ˆì˜¤</button>
                <button class="btn btn-primary btn-small" onclick="confirmAddNewSpeaker()">ì˜ˆ</button>
            </div>
        </div>
    </div>

    <!-- ì„¸ì…˜ ì¶”ê°€/ìˆ˜ì • ëª¨ë‹¬ -->
    <div class="modal" id="cellSessionModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 id="cellSessionModalTitle">ğŸ“‹ ì„¸ì…˜ ì¶”ê°€</h2>
                <button class="modal-close" onclick="closeCellSessionModal()">Ã—</button>
            </div>
            
            <form class="lecture-form" onsubmit="return false;">
                <input type="hidden" id="cellSessionTime">
                <input type="hidden" id="cellSessionRoom">
                <input type="hidden" id="cellSessionId">
                
                <div class="form-group">
                    <label>ì„¸ì…˜ëª… (í•œê¸€) <span style="color: #E74C3C;">*</span></label>
                    <input type="text" id="cellSessionName" required placeholder="ì˜ˆ: ë ˆì´ì € ì¹˜ë£Œì˜ ìµœì‹  ë™í–¥">
                </div>
                
                <div class="form-group">
                    <label>ì„¸ì…˜ëª… (ì˜ë¬¸)</label>
                    <input type="text" id="cellSessionNameEn" placeholder="ì˜ˆ: Latest Trends in Laser Treatment">
                    <div class="translation-help">
                        ğŸ’¡ ë²ˆì—­: 
                        <a href="https://translate.google.com/?sl=ko&tl=en" target="_blank">Google</a> | 
                        <a href="https://papago.naver.com/" target="_blank">Papago</a> | 
                        <a href="https://www.deepl.com/translator#ko/en/" target="_blank">DeepL</a>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>ì¢Œì¥ (í•œê¸€)</label>
                    <input type="text" id="cellSessionModerator" placeholder="ì—°ìëª… ì…ë ¥" list="moderatorSuggestions">
                    <datalist id="moderatorSuggestions"></datalist>
                </div>
                
                <div class="form-group">
                    <label>ì¢Œì¥ (ì˜ë¬¸)</label>
                    <input type="text" id="cellSessionModeratorEn" placeholder="Chair name in English">
                </div>
                
                <div class="form-group">
                    <label>ì„¸ì…˜ ìƒ‰ìƒ</label>
                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;" id="sessionColorPicker">
                        <button type="button" class="color-btn" data-color="#3498DB" style="background: #3498DB;"></button>
                        <button type="button" class="color-btn" data-color="#E74C3C" style="background: #E74C3C;"></button>
                        <button type="button" class="color-btn" data-color="#2ECC71" style="background: #2ECC71;"></button>
                        <button type="button" class="color-btn" data-color="#9B59B6" style="background: #9B59B6;"></button>
                        <button type="button" class="color-btn" data-color="#F39C12" style="background: #F39C12;"></button>
                        <button type="button" class="color-btn" data-color="#1ABC9C" style="background: #1ABC9C;"></button>
                        <button type="button" class="color-btn" data-color="#E91E63" style="background: #E91E63;"></button>
                        <button type="button" class="color-btn" data-color="#00BCD4" style="background: #00BCD4;"></button>
                    </div>
                    <input type="hidden" id="cellSessionColor" value="#3498DB">
                </div>
                
                <button type="button" class="btn btn-primary" onclick="saveCellSession()" style="width: 100%;">ì €ì¥</button>
            </form>
        </div>
    </div>

    <!-- ì—°ì ìˆ˜ì • ëª¨ë‹¬ -->
    <div class="modal" id="editSpeakerModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>âœï¸ ì—°ì ì •ë³´ ìˆ˜ì •</h2>
                <button class="modal-close" onclick="closeEditSpeakerModal()">Ã—</button>
            </div>
            
            <form class="lecture-form" onsubmit="return false;">
                <input type="hidden" id="editSpeakerIndex">
                <div class="form-group">
                    <label>ì—°ìëª… (í•œê¸€)</label>
                    <input type="text" id="editSpeakerNameField" required>
                </div>
                <div class="form-group">
                    <label>ì—°ìëª… (ì˜ë¬¸)</label>
                    <input type="text" id="editSpeakerNameEnField">
                </div>
                <div class="form-group">
                    <label>ì†Œì† (í•œê¸€)</label>
                    <input type="text" id="editSpeakerAffiliationField" required>
                </div>
                <div class="form-group">
                    <label>ì†Œì† (ì˜ë¬¸)</label>
                    <input type="text" id="editSpeakerAffiliationEnField">
                </div>
                <button type="button" class="btn btn-primary" onclick="saveEditedSpeaker()">ì €ì¥</button>
            </form>
        </div>
    </div>

    <!-- ë„ì›€ë§ ëª¨ë‹¬ -->
    <div class="modal" id="helpModal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2>â“ ì‚¬ìš© ë„ì›€ë§</h2>
                <button class="modal-close" onclick="closeHelpModal()">Ã—</button>
            </div>
            
            <div style="max-height: 70vh; overflow-y: auto; padding: 1rem;">
                <h3 style="color: var(--primary); margin-top: 1rem; margin-bottom: 0.5rem;">â˜ï¸ êµ¬ê¸€ ë“œë¼ì´ë¸Œ ì—°ë™</h3>
                <div style="background: #E8F5E9; padding: 1rem; border-radius: 8px; border-left: 4px solid #4CAF50; margin-bottom: 1rem;">
                    <h4 style="color: #2E7D32; margin-bottom: 0.5rem;">ğŸ” Google ë¡œê·¸ì¸</h4>
                    <p style="margin-bottom: 0.5rem;">â‘  ìš°ì¸¡ ìƒë‹¨ <strong>"ğŸ” Google ë¡œê·¸ì¸"</strong> ë²„íŠ¼ í´ë¦­</p>
                    <p style="margin-bottom: 0.5rem;">â‘¡ Google ê³„ì • ì„ íƒ ë° ë¡œê·¸ì¸</p>
                    <p style="margin-bottom: 0.5rem;">â‘¢ ë“œë¼ì´ë¸Œ ì ‘ê·¼ ê¶Œí•œ í—ˆìš©</p>
                    <p style="color: #666; font-size: 0.9rem;">âœ… ë¡œê·¸ì¸ í›„ ë“œë¼ì´ë¸Œ ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸° ê°€ëŠ¥!</p>
                </div>

                <div style="background: var(--bg); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <h4 style="color: var(--accent); margin-bottom: 0.5rem;">ğŸ’¾ ë“œë¼ì´ë¸Œì— ì €ì¥</h4>
                    <p style="margin-bottom: 0.5rem;">â‘  <strong>"ğŸ’¾ ë“œë¼ì´ë¸Œì— ì €ì¥"</strong> ë²„íŠ¼ í´ë¦­</p>
                    <p style="margin-bottom: 0.5rem;">â‘¡ ìë™ìœ¼ë¡œ êµ¬ê¸€ ë“œë¼ì´ë¸Œì— ì—…ë¡œë“œë¨</p>
                    <p style="color: var(--text-light); font-size: 0.9rem;">ğŸ’¡ ìë™ì €ì¥: ë³€ê²½ì‚¬í•­ ìˆì„ ë•Œ 30ì´ˆë§ˆë‹¤ ìë™ ì €ì¥</p>
                </div>

                <div style="background: var(--bg); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <h4 style="color: var(--accent); margin-bottom: 0.5rem;">â˜ï¸ ë“œë¼ì´ë¸Œì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°</h4>
                    <p style="margin-bottom: 0.5rem;">â‘  <strong>"â˜ï¸ ë“œë¼ì´ë¸Œì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°"</strong> ë²„íŠ¼ í´ë¦­</p>
                    <p style="margin-bottom: 0.5rem;">â‘¡ ì €ì¥ëœ íŒŒì¼ ëª©ë¡ì—ì„œ ì„ íƒ</p>
                    <p style="margin-bottom: 0.5rem;">â‘¢ ë°ì´í„° ìë™ ë¡œë“œ</p>
                </div>

                <h3 style="color: var(--primary); margin-top: 1.5rem; margin-bottom: 0.5rem;">ğŸ’¾ ë°ì´í„° ì €ì¥ ë° ë¶ˆëŸ¬ì˜¤ê¸°</h3>
                <div style="background: var(--bg); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <h4 style="color: var(--accent); margin-bottom: 0.5rem;">1ï¸âƒ£ êµ¬ê¸€ ë“œë¼ì´ë¸Œì— ì €ì¥ (í˜„ì¬ ë°©ì‹)</h4>
                    <p style="margin-bottom: 0.5rem;">â‘  í•˜ë‹¨ì˜ <strong>"ğŸ’¾ êµ¬ê¸€ ë“œë¼ì´ë¸Œì— ì €ì¥"</strong> ë²„íŠ¼ í´ë¦­</p>
                    <p style="margin-bottom: 0.5rem;">â‘¡ JSON íŒŒì¼ì´ ìë™ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œë¨</p>
                    <p style="margin-bottom: 0.5rem;">â‘¢ <a href="https://drive.google.com" target="_blank" style="color: var(--accent);">drive.google.com</a> ì ‘ì†</p>
                    <p style="margin-bottom: 0.5rem;">â‘£ ë‹¤ìš´ë¡œë“œëœ íŒŒì¼ì„ ë“œë˜ê·¸í•˜ì—¬ êµ¬ê¸€ ë“œë¼ì´ë¸Œì— ì—…ë¡œë“œ</p>
                    <p style="color: var(--text-light); font-size: 0.9rem;">ğŸ’¡ íŒŒì¼ëª… ì˜ˆì‹œ: conference_schedule_20251208_1430.json</p>
                </div>

                <div style="background: var(--bg); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <h4 style="color: var(--accent); margin-bottom: 0.5rem;">2ï¸âƒ£ íŒŒì¼ì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸° (í˜„ì¬ ë°©ì‹)</h4>
                    <p style="margin-bottom: 0.5rem;">â‘  êµ¬ê¸€ ë“œë¼ì´ë¸Œì—ì„œ JSON íŒŒì¼ ë‹¤ìš´ë¡œë“œ</p>
                    <p style="margin-bottom: 0.5rem;">â‘¡ í•˜ë‹¨ì˜ <strong>"ğŸ“‚ íŒŒì¼ì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°"</strong> ë²„íŠ¼ í´ë¦­</p>
                    <p style="margin-bottom: 0.5rem;">â‘¢ ë‹¤ìš´ë¡œë“œí•œ JSON íŒŒì¼ ì„ íƒ</p>
                    <p style="margin-bottom: 0.5rem;">â‘£ íŒŒì¼ ì •ë³´ í™•ì¸ í›„ "í™•ì¸" í´ë¦­</p>
                    <p style="color: var(--text-light); font-size: 0.9rem;">âš ï¸ í˜„ì¬ ë°ì´í„°ê°€ íŒŒì¼ì˜ ë°ì´í„°ë¡œ ë®ì–´ì”Œì›Œì§‘ë‹ˆë‹¤!</p>
                </div>

                <div style="background: #E3F2FD; padding: 1rem; border-radius: 8px; border-left: 4px solid #2196F3; margin-bottom: 1rem;">
                    <h4 style="color: #1976D2; margin-bottom: 0.5rem;">ğŸ”® êµ¬ê¸€ ë“œë¼ì´ë¸Œ ì§ì ‘ ì—°ë™ (ì¶”í›„ ê°€ëŠ¥)</h4>
                    <p style="margin-bottom: 0.5rem; color: #424242;">í˜„ì¬ëŠ” <strong>ë‹¤ìš´ë¡œë“œ í›„ ì—…ë¡œë“œ</strong> ë°©ì‹ì…ë‹ˆë‹¤.</p>
                    <p style="margin-bottom: 0.5rem; color: #424242;">êµ¬ê¸€ ë“œë¼ì´ë¸Œì—ì„œ ì§ì ‘ ë¶ˆëŸ¬ì˜¤ë ¤ë©´ <strong>Google Drive API</strong> ì—°ë™ì´ í•„ìš”í•©ë‹ˆë‹¤:</p>
                    <ul style="margin-left: 1.5rem; margin-top: 0.5rem; color: #424242;">
                        <li>Google Cloud Console í”„ë¡œì íŠ¸ ìƒì„±</li>
                        <li>Drive API í™œì„±í™”</li>
                        <li>OAuth 2.0 ì¸ì¦ ì„¤ì •</li>
                    </ul>
                    <p style="margin-top: 0.5rem; color: #666; font-size: 0.9rem;">ğŸ’¡ API ì—°ë™ ì‹œ: "êµ¬ê¸€ ë“œë¼ì´ë¸Œì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°" ë²„íŠ¼ìœ¼ë¡œ íŒŒì¼ ëª©ë¡ ì§ì ‘ ì¡°íšŒ ê°€ëŠ¥</p>
                </div>

                <h3 style="color: var(--primary); margin-top: 1.5rem; margin-bottom: 0.5rem;">ğŸ”„ ìë™ ì €ì¥</h3>
                <div style="background: var(--bg); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <p style="margin-bottom: 0.5rem;">âœ… ëª¨ë“  ë³€ê²½ì‚¬í•­ì€ <strong>ë¸Œë¼ìš°ì €ì— ìë™ìœ¼ë¡œ ì €ì¥</strong>ë©ë‹ˆë‹¤:</p>
                    <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                        <li>ê°•ì˜ ì¶”ê°€/ìˆ˜ì •/ì‚­ì œ</li>
                        <li>ì‹œê°„í‘œ ë°°ì¹˜ ë³€ê²½</li>
                        <li>ì—°ì ì¶”ê°€/ìˆ˜ì •/ì‚­ì œ</li>
                    </ul>
                    <p style="margin-top: 0.5rem; color: var(--text-light); font-size: 0.9rem;">ğŸ’¡ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ê±°ë‚˜ ë¸Œë¼ìš°ì €ë¥¼ ë‹«ì•„ë„ ë°ì´í„°ê°€ ìœ ì§€ë©ë‹ˆë‹¤!</p>
                </div>

                <h3 style="color: var(--primary); margin-top: 1.5rem; margin-bottom: 0.5rem;">ğŸ‘¥ ì—°ì ê´€ë¦¬</h3>
                <div style="background: var(--bg); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <p style="margin-bottom: 0.5rem;"><strong>ì—°ì ì¶”ê°€:</strong> ì—°ìëª…(í•œê¸€), ì—°ìëª…(ì˜ë¬¸), ì†Œì†(í•œê¸€), ì†Œì†(ì˜ë¬¸) ì…ë ¥</p>
                    <p style="margin-bottom: 0.5rem;"><strong>ì—°ì ê²€ìƒ‰:</strong> ì´ë¦„ ë˜ëŠ” ì†Œì†ìœ¼ë¡œ ì‹¤ì‹œê°„ ê²€ìƒ‰</p>
                    <p style="margin-bottom: 0.5rem;"><strong>ì •ë ¬:</strong> ê°€ë‚˜ë‹¤ìˆœ, ABCìˆœ, ì†Œì†ìˆœ, ìµœê·¼ ì¶”ê°€ìˆœ</p>
                    <p style="color: var(--text-light); font-size: 0.9rem;">ğŸ’¡ ê°•ì˜ ì…ë ¥ ì‹œ ì—°ìë¥¼ ì„ íƒí•˜ë©´ ì˜ë¬¸ëª…ê³¼ ì†Œì†ì´ ìë™ ì…ë ¥ë©ë‹ˆë‹¤!</p>
                </div>

                <h3 style="color: var(--primary); margin-top: 1.5rem; margin-bottom: 0.5rem;">ğŸ“ ê°•ì˜ ì¶”ê°€</h3>
                <div style="background: var(--bg); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <p style="margin-bottom: 0.5rem;">â‘  ë¶„ë¥˜ ì„ íƒ (25ê°œ ì¹´í…Œê³ ë¦¬)</p>
                    <p style="margin-bottom: 0.5rem;">â‘¡ ì œëª© ì…ë ¥ (í•œê¸€/ì˜ë¬¸)</p>
                    <p style="margin-bottom: 0.5rem;">â‘¢ ì—°ì ì…ë ¥ - ìë™ì™„ì„± í™œìš©</p>
                    <p style="margin-bottom: 0.5rem;">â‘£ "ê°•ì˜ ì¶”ê°€" ë²„íŠ¼ í´ë¦­</p>
                    <p style="color: var(--text-light); font-size: 0.9rem;">ğŸ’¡ ë“±ë¡ë˜ì§€ ì•Šì€ ì—°ìëŠ” ìë™ìœ¼ë¡œ ì¶”ê°€í• ì§€ ë¬¼ì–´ë´…ë‹ˆë‹¤!</p>
                </div>

                <h3 style="color: var(--primary); margin-top: 1.5rem; margin-bottom: 0.5rem;">ğŸ—“ï¸ ì‹œê°„í‘œ ë°°ì¹˜</h3>
                <div style="background: var(--bg); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <p style="margin-bottom: 0.5rem;">â‘  ê°•ì˜ ëª©ë¡ì—ì„œ ê°•ì˜ë¥¼ <strong>ë“œë˜ê·¸</strong></p>
                    <p style="margin-bottom: 0.5rem;">â‘¡ ì›í•˜ëŠ” ì‹œê°„/ë£¸ì— <strong>ë“œë¡­</strong></p>
                    <p style="margin-bottom: 0.5rem;">â‘¢ ë°°ì¹˜ëœ ê°•ì˜ë¥¼ ë”ë¸”í´ë¦­í•˜ì—¬ ìˆ˜ì •</p>
                    <p style="margin-bottom: 0.5rem;">â‘£ Ã— ë²„íŠ¼ìœ¼ë¡œ ì‹œê°„í‘œì—ì„œ ì œê±°</p>
                </div>

                <h3 style="color: var(--primary); margin-top: 1.5rem; margin-bottom: 0.5rem;">âš ï¸ ì£¼ì˜ì‚¬í•­</h3>
                <div style="background: #FFF3CD; padding: 1rem; border-radius: 8px; border-left: 4px solid #FFC107;">
                    <p style="margin-bottom: 0.5rem;"><strong>ë¸Œë¼ìš°ì € ìºì‹œë¥¼ ì‚­ì œí•˜ë©´ ë¡œì»¬ ë°ì´í„°ê°€ ì‚¬ë¼ì§‘ë‹ˆë‹¤!</strong></p>
                    <p style="margin-bottom: 0.5rem;">â†’ ì •ê¸°ì ìœ¼ë¡œ êµ¬ê¸€ ë“œë¼ì´ë¸Œì— ë°±ì—…í•˜ì„¸ìš”</p>
                    <p style="margin-top: 0.5rem;"><strong>ë‹¤ë¥¸ ì»´í“¨í„°ì—ì„œ ì‘ì—…í•˜ë ¤ë©´:</strong></p>
                    <p style="margin-left: 1rem;">â‘  êµ¬ê¸€ ë“œë¼ì´ë¸Œì— ì €ì¥</p>
                    <p style="margin-left: 1rem;">â‘¡ ë‹¤ë¥¸ ì»´í“¨í„°ì—ì„œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ</p>
                    <p style="margin-left: 1rem;">â‘¢ íŒŒì¼ì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°</p>
                </div>
            </div>
        </div>
    </div>

    <!-- êµ¬ê¸€ ë“œë¼ì´ë¸Œ íŒŒì¼ ëª©ë¡ ëª¨ë‹¬ -->
    <div class="modal" id="driveFilesModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2>â˜ï¸ êµ¬ê¸€ ë“œë¼ì´ë¸Œì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°</h2>
                <button class="modal-close" onclick="closeDriveFilesModal()">Ã—</button>
            </div>
            
            <div id="driveFilesList" style="max-height: 400px; overflow-y: auto;">
                <p style="text-align: center; padding: 2rem; color: var(--text-light);">íŒŒì¼ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
            </div>
        </div>
    </div>

    <!-- Google API ì„¤ì • ëª¨ë‹¬ -->
    <div class="modal" id="apiSetupModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2>âš™ï¸ Google API ì„¤ì •</h2>
                <button class="modal-close" onclick="closeApiSetupModal()">Ã—</button>
            </div>
            
            <div style="padding: 1rem;">
                <div style="background: #FFF3CD; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <p style="margin-bottom: 0.5rem;"><strong>âš ï¸ Google API í‚¤ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</strong></p>
                    <p style="font-size: 0.9rem;">êµ¬ê¸€ ë“œë¼ì´ë¸Œ ì—°ë™ì„ ìœ„í•´ API í‚¤ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.</p>
                </div>

                <div class="form-group" style="margin-bottom: 1rem;">
                    <label>Client ID</label>
                    <input type="text" id="apiClientId" placeholder="xxxx.apps.googleusercontent.com" style="width: 100%;">
                </div>

                <div class="form-group" style="margin-bottom: 1rem;">
                    <label>API Key</label>
                    <input type="text" id="apiKey" placeholder="AIzaSy..." style="width: 100%;">
                </div>

                <button class="btn btn-primary" onclick="saveApiSettings()" style="width: 100%;">ì €ì¥ ë° ì—°ê²°</button>

                <div style="margin-top: 1.5rem; padding: 1rem; background: var(--bg); border-radius: 8px;">
                    <h4 style="margin-bottom: 0.5rem;">ğŸ“– API í‚¤ ë°œê¸‰ ë°©ë²•:</h4>
                    <ol style="margin-left: 1.5rem; font-size: 0.9rem;">
                        <li><a href="https://console.cloud.google.com" target="_blank" style="color: var(--accent);">Google Cloud Console</a> ì ‘ì†</li>
                        <li>ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±</li>
                        <li>API ë¼ì´ë¸ŒëŸ¬ë¦¬ â†’ "Google Drive API" í™œì„±í™”</li>
                        <li>ì‚¬ìš©ì ì¸ì¦ ì •ë³´ â†’ OAuth 2.0 í´ë¼ì´ì–¸íŠ¸ ID ìƒì„±</li>
                        <li>API í‚¤ ìƒì„±</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <script src="data:text/javascript;base64,<?php echo base64_encode('
        // ì—°ì ë°ì´í„°ëŠ” ì—¬ê¸°ì— ì‚½ì…ë©ë‹ˆë‹¤
    '); ?>"></script>

    <script>
// ë°ì´í„°ê°€ ë§¤ìš° í¬ë¯€ë¡œ ì¶•ì•½ëœ í˜•íƒœë¡œë§Œ í‘œì‹œ
const SPEAKERS_DATA_JSON = '[{"name":"Yesin Lae","nameEn":"Yesin Lae","affiliation":"ì¸ë„ë„¤ì‹œì•„","affiliationEn":"Indonesia"}]';
        
const SPEAKERS_DATA = JSON.parse('[{"name":"Yesin Lae","nameEn":"Yesin Lae","affiliation":"ì¸ë„ë„¤ì‹œì•„","affiliationEn":"Indonesia"},{"name":"Ting Song Lim","nameEn":"Ting Song Lim","affiliation":"Malaysia","affiliationEn":"Malaysia"},{"name":"Thanya Techapichetvanich","nameEn":"Thanya Techapichetvanich","affiliation":"íƒœêµ­","affiliationEn":"Thailand"},{"name":"Sky Wong","nameEn":"Sky Wong","affiliation":"HongKong","affiliationEn":"HongKong"},{"name":"Rungsima Wanitphakdeedecha","nameEn":"Rungsima Wanitphakdeedecha","affiliation":"íƒœêµ­","affiliationEn":"Thailand"},{"name":"Rosario Abaya Blas","nameEn":"Rosario Abaya Blas","affiliation":"í•„ë¦¬í•€","affiliationEn":"Philippines"},{"name":"Raheleh Sarbaziha","nameEn":"Raheleh Sarbaziha","affiliation":"USA","affiliationEn":"USA"},{"name":"Prof. Beomjoon Kim","nameEn":"Prof. Beomjoon Kim","affiliation":"Japan","affiliationEn":"Japan"},{"name":"Paul Han","nameEn":"Paul Han","affiliation":"Australia","affiliationEn":"Australia"},{"name":"Nguyen Thi Thu Trang","nameEn":"Nguyen Thi Thu Trang","affiliation":"Vietnam","affiliationEn":"Vietnam"},{"name":"Joelle Lieman","nameEn":"Joelle Lieman","affiliation":"USA","affiliationEn":"USA"},{"name":"Inigo de Felipe","nameEn":"Inigo de Felipe","affiliation":"Spain","affiliationEn":"Spain"},{"name":"Glynis Ablon","nameEn":"Glynis Ablon","affiliation":"ë¯¸êµ­","affiliationEn":"USA"},{"name":"Elina Theodorakopoulou","nameEn":"Elina Theodorakopoulou","affiliation":"Greece","affiliationEn":"Greece"},{"name":"Yoshiuki Aikawa","nameEn":"Yoshiuki Aikawa","affiliation":"SBC (Shonan Beauty Clinic)","affiliationEn":"SBC (Shonan Beauty Clinic)"},{"name":"Shoko Takahashi","nameEn":"Shoko Takahashi","affiliation":"SBC (Shonan Beauty Clinic)","affiliationEn":"SBC (Shonan Beauty Clinic)"},{"name":"SAAMI KHALIFIAN","nameEn":"SAAMI KHALIFIAN","affiliation":"USA","affiliationEn":"USA"},{"name":"MARK DEUBER","nameEn":"MARK DEUBER","affiliation":"USA","affiliationEn":"USA"},{"name":"Contessa Salvador","nameEn":"Contessa Salvador","affiliation":"Philippines","affiliationEn":"Philippines"},{"name":"Ayaka Nishikawa","nameEn":"Ayaka Nishikawa","affiliation":"SBC (Shonan Beauty Clinic)","affiliationEn":"SBC (Shonan Beauty Clinic)"},{"name":"Ai Mitsui","nameEn":"Ai Mitsui","affiliation":"SBC (Shonan Beauty Clinic)","affiliationEn":"SBC (Shonan Beauty Clinic)"},{"name":"Chia Chi Kao","nameEn":"Chia Chi Kao","affiliation":"USA","affiliationEn":"USA"},{"name":"Atinuch Doungkaew","nameEn":"Atinuch Doungkaew","affiliation":"Thailand","affiliationEn":"Thailand"},{"name":"Almond Wibowo","nameEn":"Almond Wibowo","affiliation":"ì¸ë„ë„¤ì‹œì•„","affiliationEn":"Indonesia"},{"name":"í™©ì œì™„","nameEn":"Hwang Je-wan","affiliation":"ë©”ì´ë¦°ì˜ì› ë”í˜„ëŒ€ ëŒ€êµ¬","affiliationEn":"Mayline Clinic"},{"name":"í™©ìš©í˜¸","nameEn":"Hwang Yong-ho","affiliation":"ì›°ìŠ¤í‚¨ì˜ì›","affiliationEn":"Wellskin Clinic"},{"name":"í™í•œë¹›","nameEn":"Hong Han-bit","affiliation":"ë£©ìŠ¤ì›°ì˜ì›","affiliationEn":"Luxwell Clinic"},{"name":"ìµœí˜¸ì„±","nameEn":"Choi Ho-seong","affiliation":"í”¼ì–´ë‚˜ì˜ì›","affiliationEn":"Pieona Clinic"},{"name":"ìµœí˜œì„ ","nameEn":"Choi Hye-seon","affiliation":"ê¹€ì•ˆê³¼ë³‘ì›","affiliationEn":"Kim Eye Hospital"},{"name":"ìµœì›ìš°","nameEn":"Choi Won-woo","affiliation":"ì›°ìŠ¤í”¼ë¶€ê³¼","affiliationEn":"Wells Dermatology"},{"name":"ìµœì„±ë•","nameEn":"Choi Seong-deok","affiliation":"ì•„ì´ë³¸ë³‘ì›","affiliationEn":"Eyebon Hospital"},{"name":"ìµœë‚˜ì˜","nameEn":"Choi Na-young","affiliation":"ìƒˆë‚˜ì˜ì›","affiliationEn":"Saena Clinic"},{"name":"ì´ˆì²­ì—°ì(ê¹€ìƒì—½)","nameEn":"Guest Speaker (Kim Sang-yeop)","affiliation":"ì´ˆì²­ì—°ì(JFí”¼ë¶€ê³¼)","affiliationEn":"JF Dermatology"},{"name":"ì¡°ì°½í™˜","nameEn":"Cho Chang-hwan","affiliation":"ë™ì•ˆì¤‘ì‹¬ì˜ì›","affiliationEn":"Dongan Center Clinic"},{"name":"ì¡°ì˜ì§€","nameEn":"Cho Young-ji","affiliation":"ëª¨ë˜ì‹œê³„ì˜ì›","affiliationEn":"Hourglass Clinic"},{"name":"ì¡°ìŠ¹í˜„","nameEn":"Cho Seung-hyeon","affiliation":"ì²­ë‹´ì— ì—ìŠ¤ì˜ì›","affiliationEn":"Cheongdam MS Clinic"},{"name":"ì •ì¬ìœ¤","nameEn":"Jeong Jae-yoon","affiliation":"ë¯¸ì—˜ë¥´ ì¸ ì²­ë‹´","affiliationEn":"Mielr in Cheongdam"},{"name":"ì¥í˜„ì„","nameEn":"Jang Hyeon-seok","affiliation":"ì…€ëŸ¬ë¸Œì˜ì›","affiliationEn":"Celleb Clinic"},{"name":"ì„í™ì² ","nameEn":"Lim Hong-cheol","affiliation":"ê´‘ì£¼ì„±í˜•ì™¸ê³¼","affiliationEn":"Gwangju Plastic Surgery"},{"name":"ì„ì„¸í›ˆ","nameEn":"Lim Se-hoon","affiliation":"ì„ì˜ì›","affiliationEn":"Lim Clinic"},{"name":"ì´í™©í¬","nameEn":"Lee Hwang-hee","affiliation":"ì²­ë‹´ì—”ë¹„ì˜ì›","affiliationEn":"Cheongdam NB Clinic"},{"name":"ì´í™œ","nameEn":"Lee Hwal","affiliation":"ë¼ë Œì˜ì›","affiliationEn":"Laren Clinic"},{"name":"ì´í™”ì¤€","nameEn":"Lee Hwa-jun","affiliation":"ë¹ˆì„¼íŠ¸ì˜ì›","affiliationEn":"Vincent Clinic"},{"name":"ì´ì§„ì•„","nameEn":"Lee Jin-a","affiliation":"ìœ ì•ˆí´ë¦¬ë‹‰","affiliationEn":"Yuan Clinic"},{"name":"ì´ì¤€","nameEn":"Lee Jun","affiliation":"ì œì´ì—˜ì˜ì› êµ¬ë¯¸ì ","affiliationEn":"JL Clinic Gumi"},{"name":"ì´ì£¼ì˜","nameEn":"Lee Ju-young","affiliation":"ì œì´ìœ ì˜ì› ìš¸ì‚°ì ","affiliationEn":"JY Clinic Ulsan"},{"name":"ì´ì¢…í›ˆ","nameEn":"Lee Jong-hoon","affiliation":"ë¦¬ì¦ˆë²¨ì˜ì›","affiliationEn":"Rizbell Clinic"},{"name":"ì´ì¢…ì§„","nameEn":"Lee Jong-jin","affiliation":"ì„¸ë¼ë¯¸í¬ì˜ì› ê°•ë‚¨","affiliationEn":"Ceramic Clinic Gangnam"},{"name":"ì´ì •ìš°","nameEn":"Lee Jeong-woo","affiliation":"ì—˜ë ˆë¸Œì˜ì›","affiliationEn":"Elev Clinic"},{"name":"ì´ì¬ë™","nameEn":"Lee Jae-dong","affiliation":"ë¯¸ì†Œë‹´ì˜ì›","affiliationEn":"Misodam Clinic"},{"name":"ì´ì›ê¸°","nameEn":"Lee Won-gi","affiliation":"í†¡ìŠ¤ì•¤í•„ì˜ì› êµ¬ì›”ì ","affiliationEn":"Tox&Fill Clinic Guwol"},{"name":"ì´ìš©í˜„","nameEn":"Lee Yong-hyeon","affiliation":"ê²½ëŒ€sdì˜ì›","affiliationEn":"Kyungdae SD Clinic"},{"name":"ì´ìš©í–‰","nameEn":"Lee Yong-haeng","affiliation":"ì›°ê°€ì˜ì›","affiliationEn":"Wellga Clinic"},{"name":"ì´ìƒí—Œ","nameEn":"Lee Sang-heon","affiliation":"ì•±íƒ€ì´ë¡ ë°”ì´ì˜¤","affiliationEn":"Aptiron Bio"},{"name":"ì´ìƒìˆ˜","nameEn":"Lee Sang-soo","affiliation":"ë¯¸ë¼ë²¨ì˜ì›","affiliationEn":"Mirabel Clinic"},{"name":"ì´ìƒëˆ","nameEn":"Lee Sang-don","affiliation":"ëŒ€ë¯¸ë ˆ í•™ìˆ ê³ ë¬¸","affiliationEn":"Daemire Academic Advisor"},{"name":"ì´ë¯¼í˜¸","nameEn":"Lee Min-ho","affiliation":"ë² ìŠ¤íƒ‘ì˜ì›","affiliationEn":"Bestop Clinic"},{"name":"ì´ë¯¼ì£¼","nameEn":"Lee Min-ju","affiliation":"ë£¨ë¯¸ì˜ì›","affiliationEn":"Lumi Clinic"},{"name":"ì´ë€","nameEn":"Lee Ran","affiliation":"ì´ì  ì˜ì›","affiliationEn":"Ezen Clinic"},{"name":"ì´ê²½ì€","nameEn":"Lee Kyeong-eun","affiliation":"ë„¬ì˜ì›","affiliationEn":"Nel Clinic"},{"name":"ìœ¤í˜„ì² ","nameEn":"Yoon Hyeon-cheol","affiliation":"ì—”í”ŒëŸ¬ìŠ¤ì˜ì›","affiliationEn":"N Plus Clinic"},{"name":"ìœ¤ì •í˜„","nameEn":"Yoon Jeong-hyeon","affiliation":"ì—°ì„¸íŒœìŠ¤ì˜ì›","affiliationEn":"Yonsei Farms Clinic"},{"name":"ìœ¤ì„±ì€","nameEn":"Yoon Seong-eun","affiliation":"ë¸Œëœë‰´ì˜ì›","affiliationEn":"Brand New Clinic"},{"name":"ìœ ì§€í˜„","nameEn":"Yoo Ji-hyeon","affiliation":"ë£¨ë¯¸ì˜ì›","affiliationEn":"Lumi Clinic"},{"name":"ìœ ì¬ìš±","nameEn":"Yoo Jae-wook","affiliation":"ë°”ë¡œë¯¸ì˜ì›","affiliationEn":"Baromi Clinic"},{"name":"ìœ ê²½í›ˆ","nameEn":"Yoo Kyeong-hoon","affiliation":"ë£¨ë¯¸ì˜ì›","affiliationEn":"Lumi Clinic"},{"name":"ì›ëŒ€í•œ","nameEn":"Won Dae-han","affiliation":"í”„ë¦¬ë¯¸í´ë¦¬ë‹‰","affiliationEn":"Freeme Clinic"},{"name":"ìš°ì§€ì‚°","nameEn":"Woo Ji-san","affiliation":"ì½”ì´ì¦ˆ ëŒ€í‘œì´ì‚¬","affiliationEn":"COEZ CEO"},{"name":"ì˜¤ì„œì¤€","nameEn":"Oh Seo-jun","affiliation":"ë”ë§ˆìŠ¤í„°í´ë¦¬ë‹‰","affiliationEn":"The Master Clinic"},{"name":"ì•ˆí˜„ì¤€","nameEn":"Ahn Hyeon-jun","affiliation":"íŠ¸ë¼ì´ì—…","affiliationEn":"Tryup"},{"name":"ì•ˆì§„ë ¬","nameEn":"Ahn Jin-yeol","affiliation":"ì„¸ë¬´ë²•ì¸ ê¸€ë¡œë¹„","affiliationEn":"Globee Tax"},{"name":"ì•ˆì„±í™˜","nameEn":"Ahn Seong-hwan","affiliation":"ì—°ì„¸ë¼ì¸ì˜ì›","affiliationEn":"Yonsei Line Clinic"},{"name":"ì‹ ìŠ¹í˜¸","nameEn":"Shin Seung-ho","affiliation":"ì‹ ìœ ì˜ì›","affiliationEn":"Shinyu Clinic"},{"name":"ì†¡ìš°ì² ","nameEn":"Song Woo-cheol","affiliation":"ì—ë¸Œë¦¬ì—…ì˜ì›","affiliationEn":"Every Up Clinic"},{"name":"ì†ì§€í¬","nameEn":"Son Ji-hee","affiliation":"í˜ì´ë¸Œí”¼ë¶€ê³¼","affiliationEn":"Fave Dermatology"},{"name":"ì„±ìˆ˜í™˜","nameEn":"Seong Soo-hwan","affiliation":"ë¯¸ì†Œì•ˆì˜ì›","affiliationEn":"Misoan Clinic"},{"name":"ì„œí¬ì›","nameEn":"Seo Hee-won","affiliation":"ì²­ë‹´ì„œí´ì˜ì›","affiliationEn":"Cheongdam Circle Clinic"},{"name":"ì„œê²½í¬","nameEn":"Seo Kyeong-hee","affiliation":"ì•„ì´ëŸ¬ë¸Œê°•ë‚¨ì˜ì›","affiliationEn":"I Love Gangnam Clinic"},{"name":"ë°°ê²½íƒœ","nameEn":"Bae Kyeong-tae","affiliation":"ì‡ì¸ ë¯¸ì˜ì› ì„¸ì¢…ì ","affiliationEn":"It\'s Me Clinic Sejong"},{"name":"ë°•ì¤€ì˜","nameEn":"Park Jun-young","affiliation":"ì˜¤ìš´ì˜ì›","affiliationEn":"Oun Clinic"},{"name":"ë°•ì£¼ì™„","nameEn":"Park Ju-wan","affiliation":"ì•„ì´ì½˜ì•ˆê³¼","affiliationEn":"Icon Eye Clinic"},{"name":"ë°•ì¢…í›ˆ","nameEn":"Park Jong-hoon","affiliation":"ì˜¤ìš´ì˜ì›","affiliationEn":"Oun Clinic"},{"name":"ë°•ì›ê·œ","nameEn":"Park Won-gyu","affiliation":"ë¦¬ì–¼ë¯¸ì˜ì›","affiliationEn":"Real Me Clinic"},{"name":"ë°•ì˜ì§„","nameEn":"Park Young-jin","affiliation":"ì˜¤ë¸”ë¦¬ë¸Œì˜ì›","affiliationEn":"Obliv Clinic"},{"name":"ë°•ìˆ˜ì—°","nameEn":"Park Soo-yeon","affiliation":"ë©”ì´ë“œì˜ ì„±í˜•ì™¸ê³¼","affiliationEn":"Made Young Plastic Surgery"},{"name":"ë°•ì†Œìœ¤","nameEn":"Park So-yoon","affiliation":"ì²­ë‹´ ì—ëŒë¼ë“œì˜ì›","affiliationEn":"Cheongdam Eclat Clinic"},{"name":"ë°•ë¯¼í˜•","nameEn":"Park Min-hyeong","affiliation":"ë©”ì´ë¦°ì˜ì› ë”í˜„ëŒ€ ëŒ€êµ¬","affiliationEn":"Mayline Clinic Daegu"},{"name":"ë¯¼í˜¸ê· ","nameEn":"Min Ho-gyun","affiliation":"ìœ ë¯¸ë…¸ì˜ì›","affiliationEn":"Yumino Clinic"},{"name":"ë¯¼ì•„ë¦¼","nameEn":"Min A-rim","affiliation":"ë¯¼ì•¤ë¯¼ì˜ì›","affiliationEn":"Min & Min Clinic"},{"name":"ë¬¸í˜•ì§„","nameEn":"Moon Hyeong-jin","affiliation":"ëŒ€ë¯¸ë ˆ í•™ìˆ ê³ ë¬¸","affiliationEn":"Daemire Academic Advisor"},{"name":"ë‚˜ê³µì°¬","nameEn":"Na Gong-chan","affiliation":"ë¡œë¹ˆì˜ì›","affiliationEn":"Robin Clinic"},{"name":"ê¹€í¬ì§„","nameEn":"Kim Hee-jin","affiliation":"ì—°ì„¸ëŒ€í•™êµ ì¹˜ê³¼ëŒ€í•™ êµìˆ˜","affiliationEn":"Yonsei University Dental Professor"},{"name":"ê¹€í˜¸ë™","nameEn":"Kim Ho-dong","affiliation":"ìœ¤ì •í˜„ë‹´ë‹¹","affiliationEn":"Yoon Jeong-hyeon Department"},{"name":"ê¹€í˜„ìˆ˜","nameEn":"Kim Hyeon-soo","affiliation":"ê¹€í˜„ìˆ˜ë‚´ê³¼","affiliationEn":"Kim Hyeon-soo Internal Medicine"},{"name":"ê¹€í˜„ê²½","nameEn":"Kim Hyeon-kyeong","affiliation":"ëª¨ìš°ë‹¤ì˜ì›","affiliationEn":"Mouda Clinic"},{"name":"ê¹€í•™ìˆ˜","nameEn":"Kim Hak-soo","affiliation":"ë‹¥í„°ë² ì´ì§ì˜ì›","affiliationEn":"Dr. Basic Clinic"},{"name":"ê¹€ì§„ì˜¤","nameEn":"Kim Jin-o","affiliation":"ë‰´í—¤ì–´ëª¨ë°œì„±í˜•ì™¸ê³¼ì˜ì›","affiliationEn":"New Hair Clinic"},{"name":"ê¹€ì¤€","nameEn":"Kim Jun","affiliation":"ë°”ë¡œì½”ì˜ì›","affiliationEn":"Baroco Clinic"},{"name":"ê¹€ì •ì£¼","nameEn":"Kim Jeong-ju","affiliation":"ì‹ í•œì—ìŠ¤","affiliationEn":"Shinhan S"},{"name":"ê¹€ì¬í™","nameEn":"Kim Jae-hong","affiliation":"ë”ë”ë¸”ìœ ì˜ì›","affiliationEn":"The W Clinic"},{"name":"ê¹€ì¬ìš°","nameEn":"Kim Jae-woo","affiliation":"í´ë˜ìŠ¤ì›ì˜ì›","affiliationEn":"Class One Clinic"},{"name":"ê¹€ì¬ì˜","nameEn":"Kim Jae-young","affiliation":"ë“œë¦¼í—¤ì–´ë¼ì¸ì˜ì›","affiliationEn":"Dream Hairline Clinic"},{"name":"ê¹€ì˜ê¶Œ","nameEn":"Kim Young-kwon","affiliation":"ì—˜ì¸ ì˜ì›","affiliationEn":"Eltz Clinic"},{"name":"ê¹€ì†Œì€","nameEn":"Kim So-eun","affiliation":"ë‹¤ì‚° ë”ì˜¬ë¦¼ì˜ì›","affiliationEn":"Dasan The Ollim Clinic"},{"name":"ê¹€ì„±ì§„","nameEn":"Kim Seong-jin","affiliation":"ìŠ¤ì¼€ì¤„ì˜ì›","affiliationEn":"Schedule Clinic"},{"name":"ê¹€ë‘í•œ","nameEn":"Kim Doo-han","affiliation":"ê°•í•œë¯¸ì˜ì›","affiliationEn":"Ganghanmi Clinic"},{"name":"ê¹€ë‚˜ë˜ìœ„","nameEn":"Kim Na-rae-wi","affiliation":"ì•¤í‚´ì˜ì›","affiliationEn":"And Kim Clinic"},{"name":"ê¹€ê¸°í™","nameEn":"Kim Gi-hong","affiliation":"ë‰´ë‹ˆìŠ¤ì˜ì›","affiliationEn":"Newnis Clinic"},{"name":"ê¹€ê¸°ìš±B","nameEn":"Kim Gi-wook B","affiliation":"ë¸Œëœë“œìœ ì˜ì›","affiliationEn":"Brand You Clinic"},{"name":"ê¹€ê¸°ìš±A","nameEn":"Kim Gi-wook A","affiliation":"ì•„ì´ë””ì˜ì› ìœ„ë¡€ì ","affiliationEn":"ID Clinic Wirye"},{"name":"ê¹€ê¸°ë²”","nameEn":"Kim Gi-beom","affiliation":"ë¯¸ì†Œê°€ì¸í”¼ë¶€ê³¼ ê¹€í¬ì ","affiliationEn":"Misogain Dermatology Gimpo"},{"name":"ê¹€ê²½ë´‰","nameEn":"Kim Kyeong-bong","affiliation":"ë¡œí•˜ìŠ¤ì˜ì›","affiliationEn":"Lohas Clinic"},{"name":"ê¹€ê±´ìš°","nameEn":"Kim Geon-woo","affiliation":"ë¥´ë””ì•„ë§ì˜ì›","affiliationEn":"Le Diamant Clinic"},{"name":"ê¸°ë¬¸ìƒ","nameEn":"Gi Moon-sang","affiliation":"ì•ˆì‚°ì—”ë¹„ì˜ì›","affiliationEn":"Ansan NB Clinic"},{"name":"êµ­ì§€ìˆ˜","nameEn":"Kook Ji-soo","affiliation":"ì‡ì¸ ë¯¸ì˜ì› ì•ˆì‚°ì ","affiliationEn":"It\'s Me Clinic Ansan"},{"name":"êµ¬ìœ¤ìˆ˜","nameEn":"Koo Yoon-soo","affiliation":"ì„œìš¸ë‚˜ì¸ì•¤ì˜ì› ì²œì•ˆ","affiliationEn":"Seoul Nine& Clinic Cheonan"},{"name":"êµ¬ì†Œì—°","nameEn":"Koo So-yeon","affiliation":"ë™ì•ˆì¤‘ì‹¬ì˜ì›","affiliationEn":"Dongan Center Clinic"},{"name":"ê³µì˜ìˆ˜","nameEn":"Gong Young-soo","affiliation":"ë‹¥í„°ë””ìì´ë„ˆì˜ì› ë™íƒ„ì ","affiliationEn":"Dr. Designer Clinic Dongtan"},{"name":"ê³ ìµìˆ˜","nameEn":"Go Ik-soo","affiliation":"ê³ ìµìˆ˜ì„±í˜•ì™¸ê³¼","affiliationEn":"Go Ik-soo Plastic Surgery"},{"name":"ê°•í•œë³„","nameEn":"Kang Han-byeol","affiliation":"ë¹„ì—˜ì—ìŠ¤ì˜ì› ì ì‹¤ì ","affiliationEn":"BLS Clinic Jamsil"},{"name":"ê°•ì¸í˜¸","nameEn":"Kang In-ho","affiliation":"ì—°ì„¸ë¦¬ì¦ˆì˜ì›","affiliationEn":"Yonsei Leeds Clinic"},{"name":"ê°•ë¬´ì‚¼","nameEn":"Kang Moo-sam","affiliation":"ë‹¤ë¹ˆì¹˜ì˜ì›","affiliationEn":"Da Vinci Clinic"},{"name":"ê¹€ë²”ì¤€","nameEn":"Kim Beom-jun","affiliation":"ë™ê²½ëŒ€í•™êµ","affiliationEn":"Tokyo University"},{"name":"ë°°í˜•ê·œ","nameEn":"Bae Hyeong-gyu","affiliation":"ì—°ì„¸ëŒ€í•™êµ ì˜ê³¼ëŒ€í•™","affiliationEn":"Yonsei University Medical School"},{"name":"ì´í˜„ì£¼","nameEn":"Lee Hyeon-ju","affiliation":"ê³¨ë“œì œì´ì˜ì›","affiliationEn":"Gold J Clinic"},{"name":"ì´ìŠ¹í¬","nameEn":"Lee Seung-hee","affiliation":"ì¼ë¼ìŠ¤ì˜ì›","affiliationEn":"Illas Clinic"},{"name":"ì•ˆë™í˜„","nameEn":"Ahn Dong-hyeon","affiliation":"ëŒ€ì˜ì„±í˜•ì™¸ê³¼","affiliationEn":"Daeyoung Plastic Surgery"},{"name":"ì—¼ì°½í™˜","nameEn":"Yeom Chang-hwan","affiliation":"ì—¼ì°½í™˜ë³‘ì›","affiliationEn":"Yeom Chang-hwan Hospital"},{"name":"ë°•ê·œë¦¬","nameEn":"Park Gyu-ri","affiliation":"í–¥ë™ë¯¸ë¼í´ì˜ì›","affiliationEn":"Hyangdong Miracle Clinic"},{"name":"ì´ì„ ë¯¼","nameEn":"Lee Seon-min","affiliation":"ëª¨ë©˜í…€í—¤ì–´ë¼ì¸ì˜ì›","affiliationEn":"Momentum Hairline Clinic"},{"name":"ì„œë¯¼í¬","nameEn":"Seo Min-hee","affiliation":"ë¹…ì›¨ì´ë¸Œì“°ë¦¬","affiliationEn":"Big Wave Three"},{"name":"ë„ì¬ìš´","nameEn":"Do Jae-woon","affiliation":"ì´ì§€ë™ì•ˆì˜ì›","affiliationEn":"Easy Dongan Clinic"},{"name":"ì´ì¥ì›","nameEn":"Lee Jang-won","affiliation":"ë°¸ëŸ°ìŠ¤ë© ì„±í˜•ì™¸ê³¼","affiliationEn":"Balance Lab Plastic Surgery"},{"name":"ê¹€ë¯¼ìŠ¹","nameEn":"Kim Min-seung","affiliation":"ì•„ì´ë‹ˆí´ë¦¬ë‹‰","affiliationEn":"Ini Clinic"},{"name":"í™ê¸°ì›…","nameEn":"Hong Gi-woong","affiliation":"ìƒ˜ìŠ¤í‚¨ì„±í˜•ì™¸ê³¼","affiliationEn":"Sam Skin Plastic Surgery"},{"name":"ì˜¤ìš±","nameEn":"Oh Wook","affiliation":"ë©”ì´ë¦°ì˜ì› ë”í˜„ëŒ€ ì„œìš¸","affiliationEn":"Mayline Clinic Seoul"},{"name":"ê¹€í™”í‰","nameEn":"Kim Hwa-pyeong","affiliation":"ë°”ìš°ìŠ¤ì˜ì›","affiliationEn":"Baus Clinic"},{"name":"ì •ì§„ìˆ˜","nameEn":"Jeong Jin-soo","affiliation":"í¬ë¦¬ìŠ¤ë§ˆìŠ¤ì˜ì›","affiliationEn":"Christmas Clinic"},{"name":"ì´í˜„í¬","nameEn":"Lee Hyeon-hee","affiliation":"ë¥´ì›°ì˜ì›","affiliationEn":"Le Well Clinic"},{"name":"ìµœì „í•„","nameEn":"Choi Jeon-pil","affiliation":"í•˜ëŠ˜ëŠë‚Œí”¼ë¶€ê³¼","affiliationEn":"Haneul Neukkeim Dermatology"},{"name":"ì•ˆíš¨ìƒ","nameEn":"Ahn Hyo-sang","affiliation":"ë””ë¼ìš´ì§€í”¼ë¶€ê³¼","affiliationEn":"The Lounge Dermatology"},{"name":"ì˜¤ëŒ€ëª…","nameEn":"Oh Dae-myeong","affiliation":"ì…€ì—…ì„±í˜•ì™¸ê³¼","affiliationEn":"Cell Up Plastic Surgery"},{"name":"ì´ë™ì§„","nameEn":"Lee Dong-jin","affiliation":"ë¹„ì—˜ì—ìŠ¤ì˜ì›","affiliationEn":"BLS Clinic"},{"name":"ì´ìš±","nameEn":"Lee Wook","affiliation":"ë…¸ë¸”í´ë˜ì‹ì˜ì›","affiliationEn":"Noble Classic Clinic"},{"name":"ê¹€ì¢…ì„œ","nameEn":"Kim Jong-seo","affiliation":"ê¹€ì¢…ì„œì„±í˜•ì™¸ê³¼","affiliationEn":"Kim Jong-seo Plastic Surgery"},{"name":"ê°•ë¦¬ë¦¬","nameEn":"Kang Ri-ri","affiliation":"ë”ë² ì´ì§€ì˜ì›","affiliationEn":"The Beige Clinic"},{"name":"ì†¡ë™í˜","nameEn":"Song Dong-hyeok","affiliation":"ì—˜ìŠ¤íƒ€ì˜ì›","affiliationEn":"L Star Clinic"},{"name":"ê¹€í˜œì§„","nameEn":"Kim Hye-jin","affiliation":"ë”ì›°ë‹ˆìŠ¤ì˜ì›","affiliationEn":"The Wellness Clinic"},{"name":"ì´ì§€ë¯¼","nameEn":"Lee Ji-min","affiliation":"ë””ë ‰í„°í”¼ë¶€ê³¼ì˜ì›","affiliationEn":"Director Dermatology Clinic"},{"name":"ê³ ëª…ì§„","nameEn":"Go Myeong-jin","affiliation":"ì˜ˆì¨ì£¼ì˜ì¨ì˜ì› ì„œìš¸ëŒ€ì…êµ¬ì ","affiliationEn":"Yeppeum Juui Ppeum Clinic SNU"},{"name":"ê°•ì •ì¤‘","nameEn":"Kang Jeong-joong","affiliation":"ë‹¥í„°ì„ ì˜ì›","affiliationEn":"Dr. Sun Clinic"},{"name":"ì‹ ì˜ˆì§„","nameEn":"Shin Ye-jin","affiliation":"ë“œë„¤ì˜ì›","affiliationEn":"Dne Clinic"},{"name":"ì´ì°¬ì¢…","nameEn":"Lee Chan-jong","affiliation":"ë³‘ì›ëª…ì…ë ¥","affiliationEn":"Hospital Name"},{"name":"ê¶Œì˜ëŒ€","nameEn":"Kwon Young-dae","affiliation":"ì˜¤ì‚° ê°•ë‚¨ì„±í˜•ì™¸ê³¼","affiliationEn":"Osan Gangnam Plastic Surgery"},{"name":"ë°•ì¬ì›…","nameEn":"Park Jae-woong","affiliation":"í´ë¦°íƒ€íˆ¬ì˜ì›","affiliationEn":"Clean Tattoo Clinic"},{"name":"Jason Yip","nameEn":"Jason Yip","affiliation":"Astute Clinic","affiliationEn":"Astute Clinic"},{"name":"ì¡°ì˜ì¤€","nameEn":"Cho Young-jun","affiliation":"ë³‘ì›ëª… ì…ë ¥","affiliationEn":"Hospital Name"},{"name":"ìœ í˜œë¯¸","nameEn":"Yoo Hye-mi","affiliation":"ë¹„ì•„ì´ì˜¤ì„±í˜•ì™¸ê³¼","affiliationEn":"Bio Plastic Surgery"},{"name":"ìœ¤í˜„ìŠ¹","nameEn":"Yoon Hyeon-seung","affiliation":"ë¯¸ë¯¸ì¸ì˜ì›","affiliationEn":"Mimi Some Clinic"},{"name":"ë°•í˜•ìš±","nameEn":"Park Hyeong-wook","affiliation":"ëŒ„ì˜ì›","affiliationEn":"Dan Clinic"},{"name":"í™ì¢…ìš±","nameEn":"Hong Jong-wook","affiliation":"ë¬¼ë°©ìš¸ì„±í˜•ì™¸ê³¼","affiliationEn":"Waterdrop Plastic Surgery"},{"name":"ìµœê°•í›ˆ","nameEn":"Choi Gang-hoon","affiliation":"ë¹„ì˜¬ë¼ì…€ì„±í˜•ì™¸ê³¼","affiliationEn":"Viola Cell Plastic Surgery"},{"name":"ê¹€ì§€ì„ ","nameEn":"Kim Ji-seon","affiliation":"MHì˜ì›","affiliationEn":"MH Clinic"},{"name":"ê³ ì˜ìƒ","nameEn":"Go Young-sang","affiliation":"ë°”ìš°ìŠ¤ì˜ì›","affiliationEn":"Baus Clinic"},{"name":"ë‚¨í˜„ì„","nameEn":"Nam Hyeon-seok","affiliation":"ìƒ¤ì¸ë¹”ì˜ì› ì†¡ë„ì ","affiliationEn":"Shine Beam Clinic Songdo"},{"name":"ê¹€ë¯¸ì§„","nameEn":"Kim Mi-jin","affiliation":"ë©”ì´ë¦°ì˜ì› ë”í˜„ëŒ€ ì„œìš¸","affiliationEn":"Mayline Clinic Seoul"},{"name":"ì•ˆíƒœí™˜","nameEn":"Ahn Tae-hwan","affiliation":"í”„ë ˆì‰¬ì´ë¹„ì¸í›„ê³¼ì˜ì›","affiliationEn":"Fresh ENT Clinic"},{"name":"ì‹ ìš©ë°°","nameEn":"Shin Yong-bae","affiliation":"ë‹¥í„°ë‰´ì…€ì˜ì›","affiliationEn":"Dr. New Cell Clinic"},{"name":"ê°•ìœ ì§„","nameEn":"Kang Yoo-jin","affiliation":"ì´ë£¬ì˜ì› í•˜ë‚¨","affiliationEn":"Irun Clinic Hanam"}]');

        let rooms = ['ê¸°ì´ˆ', 'ì‹¬í™”ë ˆì´ì €', 'ì‹¬í™”ì˜ë ', 'ìˆ˜ìˆ ', 'ê°œì›', 'ë£¸A', 'ë£¸B', 'ë£¸C', 'ë©”ì¸í™€'];
        const timeSlots = [];
        let lectures = [];
        let schedule = {};
        let speakers = [];
        let sessions = []; // ì„¸ì…˜ ë°ì´í„°
        let activeFilter = 'all';
        let pendingSpeakerInfo = null;
        let currentLanguage = 'ko'; // í˜„ì¬ ì–¸ì–´ (ko/en)

        // ============================================
        // Undo ì‹œìŠ¤í…œ (5ë‹¨ê³„)
        // ============================================
        let undoHistory = [];
        const MAX_UNDO = 5;

        function saveStateForUndo() {
            const state = {
                schedule: JSON.parse(JSON.stringify(schedule)),
                sessions: JSON.parse(JSON.stringify(sessions)),
                lectures: JSON.parse(JSON.stringify(lectures))
            };
            undoHistory.push(state);
            if (undoHistory.length > MAX_UNDO) {
                undoHistory.shift();
            }
            updateUndoButton();
        }

        function performUndo() {
            if (undoHistory.length === 0) {
                alert('ë˜ëŒë¦´ ì‘ì—…ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const previousState = undoHistory.pop();
            schedule = previousState.schedule;
            sessions = previousState.sessions;
            lectures = previousState.lectures;
            
            saveAndSync();
            updateScheduleDisplay();
            updateLectureList();
            updateUndoButton();
        }

        function updateUndoButton() {
            const btn = document.getElementById('undoBtn');
            if (btn) {
                btn.textContent = `â†© ë˜ëŒë¦¬ê¸° (${undoHistory.length}/${MAX_UNDO})`;
                btn.disabled = undoHistory.length === 0;
            }
        }

        // Ctrl+Z ë‹¨ì¶•í‚¤
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'z') {
                e.preventDefault();
                performUndo();
            }
        });

        // ============================================
        // í•œê¸€ â†’ ì˜ë¬¸ ìë™ ë³€í™˜ (ì˜í•™/ë¯¸ìš© ìš©ì–´ ì‚¬ì „ ê¸°ë°˜)
        // ============================================
        
        const medicalTermDict = {
            // í”¼ë¶€/ë¯¸ìš© ê´€ë ¨
            'í”¼ë¶€': 'Skin',
            'ì£¼ë¦„': 'Wrinkle',
            'ë¦¬í”„íŒ…': 'Lifting',
            'ë ˆì´ì €': 'Laser',
            'í•„ëŸ¬': 'Filler',
            'ë³´í†¡ìŠ¤': 'Botox',
            'í†¡ì‹ ': 'Toxin',
            'ì¸ì½”': 'INCO',
            'ì½œë¼ê²': 'Collagen',
            'ì¬ìƒ': 'Regeneration',
            'íšŒì¶˜': 'Rejuvenation',
            'ì•ˆí‹°ì—ì´ì§•': 'Anti-aging',
            'ë…¸í™”': 'Aging',
            'íƒ„ë ¥': 'Elasticity',
            'ë³´ìŠµ': 'Moisturizing',
            'ë¯¸ë°±': 'Whitening',
            'ìƒ‰ì†Œ': 'Pigmentation',
            'ëª¨ê³µ': 'Pore',
            'ì—¬ë“œë¦„': 'Acne',
            'í‰í„°': 'Scar',
            'ê¸°ë¯¸': 'Melasma',
            'ì£¼ê·¼ê¹¨': 'Freckles',
            'ë‹¤í¬ì„œí´': 'Dark Circle',
            
            // ì‹œìˆ /ì¹˜ë£Œ
            'ì‹œìˆ ': 'Treatment',
            'ì¹˜ë£Œ': 'Therapy',
            'ìˆ˜ìˆ ': 'Surgery',
            'ì„±í˜•': 'Plastic Surgery',
            'ë¯¸ìš©': 'Aesthetic',
            'ì£¼ì‚¬': 'Injection',
            'ì´ì‹': 'Transplant',
            'ì œê±°': 'Removal',
            'êµì •': 'Correction',
            
            // ê¸°ìˆ /ì¥ë¹„
            'ê³ ì£¼íŒŒ': 'RF (Radiofrequency)',
            'ì´ˆìŒíŒŒ': 'Ultrasound',
            'ì§„ë™': 'Vibration',
            'ë‹¤ì¤‘': 'Multi',
            'ë³µí•©': 'Combined',
            'í˜ì‹ ': 'Innovation',
            'ê¸°ì „': 'Mechanism',
            'ì›ë¦¬': 'Principle',
            'ì ìš©': 'Application',
            'ì„ìƒ': 'Clinical',
            'íš¨ê³¼': 'Effect',
            'ê²°ê³¼': 'Result',
            
            // ì‹ ì²´ ë¶€ìœ„
            'ì–¼êµ´': 'Face',
            'ëˆˆ': 'Eye',
            'ì½”': 'Nose',
            'ì…ìˆ ': 'Lip',
            'í„±': 'Chin',
            'ì´ë§ˆ': 'Forehead',
            'ë³¼': 'Cheek',
            'ëª©': 'Neck',
            'ë°”ë””': 'Body',
            'ì§„í”¼': 'Dermis',
            'í‘œí”¼': 'Epidermis',
            
            // í˜•ìš©ì‚¬/ë¶€ì‚¬
            'ì™„ë²½': 'Perfect',
            'ìµœì‹ ': 'Latest',
            'í˜„ëŒ€ì ': 'Modern',
            'ë³€í˜ì ': 'Transformative',
            'ì•¡ìƒí˜•': 'Liquid',
            'ë¹›ë‚˜ëŠ”': 'Radiant',
            'ì—†ì´': 'Without',
            'ë‹¤ì–‘í•œ': 'Various',
            'ì¸µë³„': 'Layer-by-layer',
            'ê³µëµë²•': 'Strategy',
            
            // ì¼ë°˜ ì˜í•™
            'PCL': 'PCL',
            'HA': 'HA',
            'CPM': 'CPM',
            'RF': 'RF',
            'LED': 'LED',
            'PRP': 'PRP',
            'DNA': 'DNA',
            'ì½œë¼ë³´': 'Collaboration',
            'ì„¸ì…˜': 'Session',
            'ì›Œí¬ìƒµ': 'Workshop',
            'ì‹¬í¬ì§€ì—„': 'Symposium',
            'ê°•ì˜': 'Lecture',
            'ë°œí‘œ': 'Presentation',
            'í† ë¡ ': 'Discussion',
            'íŒ¨ë„': 'Panel',
            
            // ì—°ê²°ì–´
            'ì˜': 'of',
            'ì™€': 'and',
            'ë°': 'and',
            'ì„': '',
            'ë¥¼': '',
            'ì—ì„œ': 'in',
            'ìœ¼ë¡œ': 'with',
            'ë¡œ': 'with',
            'í•œ': 'for',
            'ì ': '',
            'ì—­í• ': 'Role'
        };
        
        function koreanToEnglish(koreanText) {
            if (!koreanText) return '';
            
            let result = koreanText;
            
            // ì‚¬ì „ì— ìˆëŠ” ìš©ì–´ ë³€í™˜
            Object.keys(medicalTermDict).forEach(korean => {
                const regex = new RegExp(korean, 'g');
                result = result.replace(regex, medicalTermDict[korean]);
            });
            
            // ë‚¨ì€ í•œê¸€ì´ ìˆìœ¼ë©´ ë¡œë§ˆìë¡œ ë³€í™˜ ì‹œë„
            result = result.replace(/[ê°€-í£]+/g, (match) => {
                return romanize(match);
            });
            
            // ì •ë¦¬: ì¤‘ë³µ ê³µë°± ì œê±°, ì•ë’¤ ê³µë°± ì œê±°
            result = result.replace(/\s+/g, ' ').trim();
            
            // ì²« ê¸€ì ëŒ€ë¬¸ì
            result = result.split(' ').map(word => {
                if (word.length > 0 && word.toLowerCase() !== 'of' && word.toLowerCase() !== 'and' && word.toLowerCase() !== 'in' && word.toLowerCase() !== 'with' && word.toLowerCase() !== 'for') {
                    return word.charAt(0).toUpperCase() + word.slice(1);
                }
                return word;
            }).join(' ');
            
            return result;
        }
        
        // ê°„ë‹¨í•œ í•œê¸€ ë¡œë§ˆì ë³€í™˜ (í‘œì¤€ ë¡œë§ˆì í‘œê¸°ë²• ê¸°ë°˜)
        function romanize(korean) {
            const initials = ['g', 'kk', 'n', 'd', 'tt', 'r', 'm', 'b', 'pp', 's', 'ss', '', 'j', 'jj', 'ch', 'k', 't', 'p', 'h'];
            const medials = ['a', 'ae', 'ya', 'yae', 'eo', 'e', 'yeo', 'ye', 'o', 'wa', 'wae', 'oe', 'yo', 'u', 'wo', 'we', 'wi', 'yu', 'eu', 'ui', 'i'];
            const finals = ['', 'k', 'k', 'k', 'n', 'n', 'n', 't', 'l', 'l', 'l', 'l', 'l', 'l', 'l', 'l', 'm', 'p', 'p', 't', 't', 'ng', 't', 't', 'k', 't', 'p', 't'];
            
            let result = '';
            
            for (let i = 0; i < korean.length; i++) {
                const code = korean.charCodeAt(i) - 44032;
                
                if (code >= 0 && code <= 11171) {
                    const initial = Math.floor(code / 588);
                    const medial = Math.floor((code % 588) / 28);
                    const final = code % 28;
                    
                    result += initials[initial] + medials[medial] + finals[final];
                } else {
                    result += korean[i];
                }
            }
            
            // ì²« ê¸€ì ëŒ€ë¬¸ì
            return result.charAt(0).toUpperCase() + result.slice(1);
        }

        // ============================================
        // Google Drive API ì„¤ì •
        // ============================================
        
        // API ì„¤ì • (Google Cloud Consoleì—ì„œ ë°œê¸‰) - ë¯¸ë¦¬ ì„¤ì •ë¨
        const GOOGLE_CLIENT_ID = '303515038815-n1dhp011ibvcmf3q3l1icp9vqligrrnb.apps.googleusercontent.com';
        const GOOGLE_API_KEY = 'AIzaSyBWrPHjrePBcI3198srXLmu9ZZ3rAcjBjU';
        const SCOPES = 'https://www.googleapis.com/auth/drive.file';
        const DISCOVERY_DOC = 'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest';
        const APP_FOLDER_NAME = 'ConferenceScheduler';
        
        let tokenClient;
        let gapiInited = false;
        let gisInited = false;
        let isGoogleLoggedIn = false;
        let currentDriveFileId = null;
        let autoSaveTimer = null;
        let hasUnsavedChanges = false;

        // Google API ì´ˆê¸°í™”
        function gapiLoaded() {
            gapi.load('client', initializeGapiClient);
        }

        async function initializeGapiClient() {
            if (!GOOGLE_API_KEY) {
                console.log('API í‚¤ê°€ ì„¤ì •ë˜ì§€ ì•ŠìŒ');
                return;
            }
            
            try {
                await gapi.client.init({
                    apiKey: GOOGLE_API_KEY,
                    discoveryDocs: [DISCOVERY_DOC],
                });
                gapiInited = true;
                console.log('GAPI client initialized');
                maybeEnableButtons();
            } catch (error) {
                console.error('GAPI ì´ˆê¸°í™” ì˜¤ë¥˜:', error);
            }
        }

        function gisLoaded() {
            if (!GOOGLE_CLIENT_ID) {
                console.log('Client IDê°€ ì„¤ì •ë˜ì§€ ì•ŠìŒ');
                return;
            }
            
            try {
                tokenClient = google.accounts.oauth2.initTokenClient({
                    client_id: GOOGLE_CLIENT_ID,
                    scope: SCOPES,
                    callback: '', // ë‚˜ì¤‘ì— ì„¤ì •
                });
                gisInited = true;
                console.log('GIS client initialized');
                maybeEnableButtons();
            } catch (error) {
                console.error('GIS ì´ˆê¸°í™” ì˜¤ë¥˜:', error);
            }
        }

        function maybeEnableButtons() {
            if (gapiInited && gisInited) {
                // ì´ì „ì— ì €ì¥ëœ í† í° í™•ì¸
                const savedToken = localStorage.getItem('google_access_token');
                if (savedToken) {
                    gapi.client.setToken({ access_token: savedToken });
                    validateToken(savedToken);
                }
            }
        }

        async function validateToken(token) {
            try {
                const response = await fetch(`https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=${token}`);
                if (response.ok) {
                    isGoogleLoggedIn = true;
                    updateGoogleAuthUI(true);
                    getUserInfo();
                } else {
                    localStorage.removeItem('google_access_token');
                }
            } catch (error) {
                console.error('í† í° ê²€ì¦ ì˜¤ë¥˜:', error);
                localStorage.removeItem('google_access_token');
            }
        }

        // Google ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ
        function handleGoogleAuth() {
            if (isGoogleLoggedIn) {
                // ë¡œê·¸ì•„ì›ƒ
                const token = gapi.client.getToken();
                if (token !== null) {
                    google.accounts.oauth2.revoke(token.access_token);
                    gapi.client.setToken('');
                    localStorage.removeItem('google_access_token');
                }
                isGoogleLoggedIn = false;
                updateGoogleAuthUI(false);
                updateSyncStatus('ë¡œì»¬ì— ì €ì¥ë¨', 'ğŸ’¾');
            } else {
                // ë¡œê·¸ì¸
                tokenClient.callback = async (resp) => {
                    if (resp.error !== undefined) {
                        console.error('ë¡œê·¸ì¸ ì˜¤ë¥˜:', resp);
                        return;
                    }
                    isGoogleLoggedIn = true;
                    localStorage.setItem('google_access_token', resp.access_token);
                    updateGoogleAuthUI(true);
                    getUserInfo();
                    updateSyncStatus('êµ¬ê¸€ ë“œë¼ì´ë¸Œ ì—°ê²°ë¨', 'â˜ï¸');
                };

                if (gapi.client.getToken() === null) {
                    tokenClient.requestAccessToken({ prompt: 'consent' });
                } else {
                    tokenClient.requestAccessToken({ prompt: '' });
                }
            }
        }

        async function getUserInfo() {
            try {
                const response = await fetch('https://www.googleapis.com/oauth2/v2/userinfo', {
                    headers: {
                        'Authorization': `Bearer ${gapi.client.getToken().access_token}`
                    }
                });
                const userInfo = await response.json();
                
                document.getElementById('googleUserAvatar').src = userInfo.picture || '';
                document.getElementById('googleUserName').textContent = userInfo.name || userInfo.email;
                document.getElementById('googleUserInfo').style.display = 'flex';
            } catch (error) {
                console.error('ì‚¬ìš©ì ì •ë³´ ì˜¤ë¥˜:', error);
            }
        }

        function updateGoogleAuthUI(loggedIn) {
            const btn = document.getElementById('googleAuthBtn');
            const userInfo = document.getElementById('googleUserInfo');
            
            if (loggedIn) {
                btn.textContent = 'ğŸ”“ ë¡œê·¸ì•„ì›ƒ';
                btn.style.background = '#f8f8f8';
            } else {
                btn.textContent = 'ğŸ” Google ë¡œê·¸ì¸';
                btn.style.background = '';
                userInfo.style.display = 'none';
            }
        }

        // êµ¬ê¸€ ë“œë¼ì´ë¸Œì— ì €ì¥
        async function saveToGoogleDrive() {
            if (!isGoogleLoggedIn) {
                // ë¡œê·¸ì¸ ì•ˆë¨ - ë¡œì»¬ ë‹¤ìš´ë¡œë“œë¡œ ëŒ€ì²´
                saveToLocalFile();
                return;
            }

            updateSyncStatus('ì €ì¥ ì¤‘...', 'â³');

            try {
                const data = {
                    lectures: lectures,
                    schedule: schedule,
                    speakers: speakers,
                    categories: categories,
                    categoryColors: categoryColors,
                    sessions: sessions,
                    savedAt: new Date().toISOString(),
                    version: '2.1'
                };

                const jsonStr = JSON.stringify(data, null, 2);
                const blob = new Blob([jsonStr], { type: 'application/json' });

                // ì•± ì „ìš© í´ë” ì°¾ê¸°/ìƒì„±
                let folderId = await getOrCreateAppFolder();

                // íŒŒì¼ëª… ìƒì„±
                const date = new Date();
                const filename = `conference_schedule_${date.getFullYear()}${(date.getMonth()+1).toString().padStart(2,'0')}${date.getDate().toString().padStart(2,'0')}_${date.getHours().toString().padStart(2,'0')}${date.getMinutes().toString().padStart(2,'0')}.json`;

                // íŒŒì¼ ì—…ë¡œë“œ
                const metadata = {
                    name: filename,
                    mimeType: 'application/json',
                    parents: [folderId]
                };

                const form = new FormData();
                form.append('metadata', new Blob([JSON.stringify(metadata)], { type: 'application/json' }));
                form.append('file', blob);

                const response = await fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', {
                    method: 'POST',
                    headers: new Headers({ 'Authorization': 'Bearer ' + gapi.client.getToken().access_token }),
                    body: form
                });

                const result = await response.json();
                
                if (result.id) {
                    currentDriveFileId = result.id;
                    hasUnsavedChanges = false;
                    const now = new Date().toLocaleTimeString('ko-KR');
                    updateSyncStatus(`ë“œë¼ì´ë¸Œì— ì €ì¥ë¨`, 'âœ…', `ë§ˆì§€ë§‰ ì €ì¥: ${now}`);
                    console.log('êµ¬ê¸€ ë“œë¼ì´ë¸Œ ì €ì¥ ì™„ë£Œ:', result.name);
                } else {
                    throw new Error('íŒŒì¼ ì €ì¥ ì‹¤íŒ¨');
                }
            } catch (error) {
                console.error('êµ¬ê¸€ ë“œë¼ì´ë¸Œ ì €ì¥ ì˜¤ë¥˜:', error);
                updateSyncStatus('ì €ì¥ ì‹¤íŒ¨', 'âŒ');
                alert('âŒ êµ¬ê¸€ ë“œë¼ì´ë¸Œ ì €ì¥ ì‹¤íŒ¨\n\n' + error.message);
            }
        }

        // ë¡œì»¬ íŒŒì¼ë¡œ ì €ì¥ (ë°±ì—…ìš©)
        function saveToLocalFile() {
            const data = {
                lectures: lectures,
                schedule: schedule,
                speakers: speakers,
                categories: categories,
                categoryColors: categoryColors,
                sessions: sessions,
                savedAt: new Date().toISOString(),
                version: '2.1'
            };

            const jsonStr = JSON.stringify(data, null, 2);
            const blob = new Blob([jsonStr], { type: 'application/json' });
            
            const date = new Date();
            const filename = `conference_schedule_${date.getFullYear()}${(date.getMonth()+1).toString().padStart(2,'0')}${date.getDate().toString().padStart(2,'0')}_${date.getHours().toString().padStart(2,'0')}${date.getMinutes().toString().padStart(2,'0')}.json`;
            
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            link.click();
            URL.revokeObjectURL(url);
            
            alert('âœ… íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!\n\nğŸ“ íŒŒì¼ëª…: ' + filename + '\n\nêµ¬ê¸€ ë“œë¼ì´ë¸Œ ì—°ë™ì„ ì›í•˜ì‹œë©´\n"ğŸ” Google ë¡œê·¸ì¸" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.');
        }

        // ì•± ì „ìš© í´ë” ì°¾ê¸°/ìƒì„±
        async function getOrCreateAppFolder() {
            try {
                // ê¸°ì¡´ í´ë” ì°¾ê¸°
                const response = await gapi.client.drive.files.list({
                    q: `name='${APP_FOLDER_NAME}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,
                    fields: 'files(id, name)'
                });

                if (response.result.files && response.result.files.length > 0) {
                    return response.result.files[0].id;
                }

                // í´ë” ìƒì„±
                const createResponse = await gapi.client.drive.files.create({
                    resource: {
                        name: APP_FOLDER_NAME,
                        mimeType: 'application/vnd.google-apps.folder'
                    },
                    fields: 'id'
                });

                return createResponse.result.id;
            } catch (error) {
                console.error('í´ë” ìƒì„± ì˜¤ë¥˜:', error);
                throw error;
            }
        }

        // êµ¬ê¸€ ë“œë¼ì´ë¸Œì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
        async function loadFromGoogleDrive() {
            if (!isGoogleLoggedIn) {
                alert('âŒ êµ¬ê¸€ ë“œë¼ì´ë¸Œ ì—°ë™ì´ í•„ìš”í•©ë‹ˆë‹¤.\n\n"ğŸ” Google ë¡œê·¸ì¸" ë²„íŠ¼ì„ í´ë¦­í•´ì£¼ì„¸ìš”.');
                return;
            }

            try {
                updateSyncStatus('íŒŒì¼ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...', 'â³');
                
                // ì•± í´ë” ì°¾ê¸°
                let folderId = await getOrCreateAppFolder();
                
                // íŒŒì¼ ëª©ë¡ ì¡°íšŒ
                const response = await gapi.client.drive.files.list({
                    q: `'${folderId}' in parents and mimeType='application/json' and trashed=false`,
                    fields: 'files(id, name, modifiedTime, size)',
                    orderBy: 'modifiedTime desc',
                    pageSize: 20
                });

                const files = response.result.files;
                
                if (!files || files.length === 0) {
                    updateSyncStatus('êµ¬ê¸€ ë“œë¼ì´ë¸Œ ì—°ê²°ë¨', 'â˜ï¸');
                    alert('ğŸ“‚ ì €ì¥ëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.\n\n"ğŸ’¾ ë“œë¼ì´ë¸Œì— ì €ì¥" ë²„íŠ¼ìœ¼ë¡œ ë¨¼ì € ì €ì¥í•´ì£¼ì„¸ìš”.');
                    return;
                }

                // íŒŒì¼ ëª©ë¡ ëª¨ë‹¬ í‘œì‹œ
                showDriveFilesModal(files);
                updateSyncStatus('êµ¬ê¸€ ë“œë¼ì´ë¸Œ ì—°ê²°ë¨', 'â˜ï¸');
                
            } catch (error) {
                console.error('íŒŒì¼ ëª©ë¡ ì¡°íšŒ ì˜¤ë¥˜:', error);
                updateSyncStatus('ì˜¤ë¥˜ ë°œìƒ', 'âŒ');
                alert('âŒ íŒŒì¼ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\n' + error.message);
            }
        }

        // íŒŒì¼ ëª©ë¡ ëª¨ë‹¬ í‘œì‹œ
        function showDriveFilesModal(files) {
            const container = document.getElementById('driveFilesList');
            
            container.innerHTML = files.map(file => {
                const modifiedDate = new Date(file.modifiedTime).toLocaleString('ko-KR');
                const fileSize = file.size ? (parseInt(file.size) / 1024).toFixed(1) + ' KB' : '';
                
                return `
                    <div class="speaker-item" style="cursor: pointer;" onclick="loadDriveFile('${file.id}', '${file.name}')">
                        <div class="speaker-info">
                            <strong>ğŸ“„ ${file.name}</strong>
                            <small>ğŸ“… ${modifiedDate} ${fileSize ? 'Â· ' + fileSize : ''}</small>
                        </div>
                        <div class="speaker-actions">
                            <button class="btn btn-primary btn-small" onclick="event.stopPropagation(); loadDriveFile('${file.id}', '${file.name}')">ë¶ˆëŸ¬ì˜¤ê¸°</button>
                            <button class="btn btn-secondary btn-small" onclick="event.stopPropagation(); deleteDriveFile('${file.id}', '${file.name}')">ì‚­ì œ</button>
                        </div>
                    </div>
                `;
            }).join('');

            document.getElementById('driveFilesModal').classList.add('active');
        }

        // ë“œë¼ì´ë¸Œ íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°
        async function loadDriveFile(fileId, fileName) {
            try {
                updateSyncStatus('íŒŒì¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...', 'â³');
                closeDriveFilesModal();

                const response = await gapi.client.drive.files.get({
                    fileId: fileId,
                    alt: 'media'
                });

                const data = JSON.parse(response.body);

                // ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬
                if (!data.lectures || !data.schedule || !data.speakers) {
                    throw new Error('ì˜¬ë°”ë¥¸ í˜•ì‹ì˜ íŒŒì¼ì´ ì•„ë‹™ë‹ˆë‹¤.');
                }

                // ë°ì´í„° ë¡œë“œ
                lectures = data.lectures;
                schedule = data.schedule;
                speakers = data.speakers;
                
                // ì¹´í…Œê³ ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸° (ìˆìœ¼ë©´)
                if (data.categories) {
                    categories = data.categories;
                }
                if (data.categoryColors) {
                    Object.assign(categoryColors, data.categoryColors);
                }
                // ì„¸ì…˜ ë¶ˆëŸ¬ì˜¤ê¸° (ìˆìœ¼ë©´)
                if (data.sessions) {
                    sessions = data.sessions;
                }
                currentDriveFileId = fileId;

                // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ë„ ì €ì¥
                saveToLocalStorage();

                // UI ì—…ë°ì´íŠ¸
                updateCategoryDropdowns();
                createCategoryFilters();
                updateLectureList();
                updateScheduleDisplay();
                renderSessionBars();

                hasUnsavedChanges = false;
                const now = new Date().toLocaleTimeString('ko-KR');
                updateSyncStatus('ë“œë¼ì´ë¸Œì—ì„œ ë¶ˆëŸ¬ì˜´', 'âœ…', `${now}`);
                
                alert(`âœ… "${fileName}" íŒŒì¼ì„ ì„±ê³µì ìœ¼ë¡œ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤!\n\nğŸ“š ê°•ì˜: ${lectures.length}ê°œ\nğŸ‘¥ ì—°ì: ${speakers.length}ëª…\nğŸ“Š ì‹œê°„í‘œ: ${Object.keys(schedule).length}ê°œ ë°°ì¹˜`);

            } catch (error) {
                console.error('íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:', error);
                updateSyncStatus('ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨', 'âŒ');
                alert('âŒ íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\n' + error.message);
            }
        }

        // ë“œë¼ì´ë¸Œ íŒŒì¼ ì‚­ì œ
        async function deleteDriveFile(fileId, fileName) {
            if (!confirm(`"${fileName}" íŒŒì¼ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)) {
                return;
            }

            try {
                await gapi.client.drive.files.delete({
                    fileId: fileId
                });

                alert(`âœ… "${fileName}" íŒŒì¼ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`);
                
                // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                loadFromGoogleDrive();
                
            } catch (error) {
                console.error('íŒŒì¼ ì‚­ì œ ì˜¤ë¥˜:', error);
                alert('âŒ íŒŒì¼ ì‚­ì œ ì‹¤íŒ¨\n\n' + error.message);
            }
        }

        function closeDriveFilesModal() {
            document.getElementById('driveFilesModal').classList.remove('active');
        }

        // ë™ê¸°í™” ìƒíƒœ í‘œì‹œ
        function updateSyncStatus(text, icon, time = '') {
            document.getElementById('syncText').textContent = text;
            document.getElementById('syncIcon').textContent = icon;
            document.getElementById('lastSyncTime').textContent = time;
        }

        // ìë™ ì €ì¥ (ë³€ê²½ ê°ì§€)
        function markAsChanged() {
            hasUnsavedChanges = true;
            saveToLocalStorage();
            
            if (isGoogleLoggedIn) {
                updateSyncStatus('ì €ì¥ë˜ì§€ ì•Šì€ ë³€ê²½ì‚¬í•­', 'âš ï¸');
                
                // 30ì´ˆ í›„ ìë™ ì €ì¥
                if (autoSaveTimer) clearTimeout(autoSaveTimer);
                autoSaveTimer = setTimeout(() => {
                    if (hasUnsavedChanges && isGoogleLoggedIn) {
                        saveToGoogleDrive();
                    }
                }, 30000);
            }
        }

        // API ì„¤ì • ëª¨ë‹¬
        function openApiSetupModal() {
            document.getElementById('apiClientId').value = GOOGLE_CLIENT_ID;
            document.getElementById('apiKey').value = GOOGLE_API_KEY;
            document.getElementById('apiSetupModal').classList.add('active');
        }

        function closeApiSetupModal() {
            document.getElementById('apiSetupModal').classList.remove('active');
        }

        function saveApiSettings() {
            const clientId = document.getElementById('apiClientId').value.trim();
            const apiKey = document.getElementById('apiKey').value.trim();

            if (!clientId || !apiKey) {
                alert('Client IDì™€ API Keyë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            localStorage.setItem('google_client_id', clientId);
            localStorage.setItem('google_api_key', apiKey);
            
            GOOGLE_CLIENT_ID = clientId;
            GOOGLE_API_KEY = apiKey;

            closeApiSetupModal();
            alert('âœ… API ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.\n\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•©ë‹ˆë‹¤.');
            location.reload();
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ Google API ì´ˆê¸°í™”
        window.onload = function() {
            if (typeof gapi !== 'undefined') {
                gapiLoaded();
            }
            if (typeof google !== 'undefined' && google.accounts) {
                gisLoaded();
            }
        };

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
        function loadFromLocalStorage() {
            try {
                const savedLectures = localStorage.getItem('conference_lectures');
                const savedSchedule = localStorage.getItem('conference_schedule');
                const savedSpeakers = localStorage.getItem('conference_speakers');
                const savedCategories = localStorage.getItem('conference_categories');
                const savedSessions = localStorage.getItem('conference_sessions');

                if (savedLectures) {
                    lectures = JSON.parse(savedLectures);
                    console.log('ê°•ì˜ ëª©ë¡ ë¶ˆëŸ¬ì˜´:', lectures.length + 'ê°œ');
                }

                if (savedSchedule) {
                    schedule = JSON.parse(savedSchedule);
                    console.log('ì‹œê°„í‘œ ë¶ˆëŸ¬ì˜´');
                }

                if (savedSpeakers) {
                    speakers = JSON.parse(savedSpeakers);
                    console.log('ì—°ì ëª©ë¡ ë¶ˆëŸ¬ì˜´:', speakers.length + 'ëª…');
                } else {
                    // ì²˜ìŒ ì‹¤í–‰ ì‹œ ê¸°ë³¸ ì—°ì ë°ì´í„° ì‚¬ìš©
                    speakers = [...SPEAKERS_DATA];
                    saveToLocalStorage(); // ê¸°ë³¸ ë°ì´í„° ì €ì¥
                }

                if (savedCategories) {
                    categories = JSON.parse(savedCategories);
                    console.log('ë¶„ë¥˜ ëª©ë¡ ë¶ˆëŸ¬ì˜´:', categories.length + 'ê°œ');
                }

                if (savedSessions) {
                    sessions = JSON.parse(savedSessions);
                    console.log('ì„¸ì…˜ ëª©ë¡ ë¶ˆëŸ¬ì˜´:', sessions.length + 'ê°œ');
                }
            } catch (error) {
                console.error('ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:', error);
                speakers = [...SPEAKERS_DATA];
            }
        }

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ë°ì´í„° ì €ì¥
        function saveToLocalStorage() {
            try {
                localStorage.setItem('conference_lectures', JSON.stringify(lectures));
                localStorage.setItem('conference_schedule', JSON.stringify(schedule));
                localStorage.setItem('conference_speakers', JSON.stringify(speakers));
                localStorage.setItem('conference_categories', JSON.stringify(categories));
                localStorage.setItem('conference_sessions', JSON.stringify(sessions));
                console.log('ë¡œì»¬ ì €ì¥ ì™„ë£Œ');
            } catch (error) {
                console.error('ë°ì´í„° ì €ì¥ ì˜¤ë¥˜:', error);
                alert('ë°ì´í„° ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // ë¡œì»¬ ì €ì¥ + í´ë¼ìš°ë“œ ë™ê¸°í™” íŠ¸ë¦¬ê±°
        function saveAndSync() {
            saveToLocalStorage();
            markAsChanged();
        }

        // ëª¨ë“  ë°ì´í„° ì´ˆê¸°í™”
        function resetAllData() {
            if (confirm('âš ï¸ ëª¨ë“  ë°ì´í„°(ê°•ì˜, ì‹œê°„í‘œ, ì„¸ì…˜, ì—°ì, ë£¸)ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                localStorage.removeItem('conference_lectures');
                localStorage.removeItem('conference_schedule');
                localStorage.removeItem('conference_speakers');
                localStorage.removeItem('conference_sessions');
                localStorage.removeItem('conference_rooms');
                
                lectures = [];
                schedule = {};
                sessions = [];
                speakers = [...SPEAKERS_DATA];
                rooms = ['ê¸°ì´ˆ', 'ì‹¬í™”ë ˆì´ì €', 'ì‹¬í™”ì˜ë ', 'ìˆ˜ìˆ ', 'ê°œì›', 'ë£¸A', 'ë£¸B', 'ë£¸C', 'ë©”ì¸í™€'];
                
                saveToLocalStorage();
                updateLectureList();
                createScheduleTable();
                
                alert('âœ… ëª¨ë“  ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
                location.reload();
            }
        }

        const categoryColors = {
            'Aesthetic Devices': '#3498DB',
            'AI & CRM': '#00BCD4',
            'Anatomy': '#9C27B0',
            'ASLS': '#03A9F4',
            'Bio-Stimulators': '#9B59B6',
            'Body Contouring': '#FF5722',
            'Consumables': '#607D8B',
            'Cosmeceuticals': '#F39C12',
            'Dermatology': '#E91E63',
            'Diagnostic Devices': '#1ABC9C',
            'Digital Solutions': '#00ACC1',
            'Hair': '#795548',
            'Injectables': '#FF9500',
            'International Faculty & Global Trends': '#673AB7',
            'Laser & EBDs': '#FF6B9D',
            'Lifting Devices': '#56CCF2',
            'Management & Marketing': '#8BC34A',
            'Medical Supplies': '#26A69A',
            'Other Solutions': '#8D6E63',
            'Others': '#78909C',
            'Regeneratives': '#2ECC71',
            'Safety Equipment': '#4CAF50',
            'Sedation & Analgesia Devices': '#FFC107',
            'Stem Cell & Functional': '#7E57C2',
            'Threads': '#E74C3C'
        };
        
        // ì¹´í…Œê³ ë¦¬ ëª©ë¡ (ìˆ˜ì • ê°€ëŠ¥)
        let categories = Object.keys(categoryColors).sort();

        // ì‹œê°„ ì„¤ì • (5ë¶„ ë‹¨ìœ„, 08:30~17:00)
        const START_HOUR = 8;
        const START_MIN = 30;
        const END_HOUR = 17;
        const END_MIN = 0;
        const TIME_UNIT = 5; // 5ë¶„ ë‹¨ìœ„
        
        // ê°•ì˜ ì‹œê°„ ì˜µì…˜ (ë¶„)
        let durationOptions = [10, 15, 20, 30, 40, 50, 60];

        for (let hour = START_HOUR; hour <= END_HOUR; hour++) {
            const startMin = (hour === START_HOUR) ? START_MIN : 0;
            const endMin = (hour === END_HOUR) ? END_MIN : 60;
            for (let min = startMin; min < endMin; min += TIME_UNIT) {
                const time = `${hour.toString().padStart(2, '0')}:${min.toString().padStart(2, '0')}`;
                timeSlots.push(time);
            }
        }

        function createCategoryFilters() {
            const container = document.getElementById('categoryFilters');
            container.innerHTML = '';

            const allBtn = document.createElement('button');
            allBtn.className = 'category-filter-btn active';
            allBtn.style.borderColor = '#2E1A47';
            allBtn.style.background = '#2E1A47';
            allBtn.style.color = '#FFFFFF';
            allBtn.textContent = 'ì „ì²´';
            allBtn.onclick = () => filterLectures('all');
            container.appendChild(allBtn);

            Object.keys(categoryColors).forEach(category => {
                const btn = document.createElement('button');
                btn.className = 'category-filter-btn';
                const color = categoryColors[category];
                btn.style.borderColor = color;
                btn.style.color = color;
                btn.textContent = category;
                btn.onclick = () => filterLectures(category);
                btn.dataset.category = category;
                container.appendChild(btn);
            });
        }

        function filterLectures(category) {
            activeFilter = category;
            
            document.querySelectorAll('.category-filter-btn').forEach(btn => {
                btn.classList.remove('active');
                
                if (category === 'all' && btn.textContent === 'ì „ì²´') {
                    btn.classList.add('active');
                    btn.style.background = '#2E1A47';
                    btn.style.color = '#FFFFFF';
                } else if (btn.dataset.category === category) {
                    btn.classList.add('active');
                    const color = categoryColors[category];
                    btn.style.background = color;
                    btn.style.color = '#FFFFFF';
                } else {
                    btn.style.background = '#FFFFFF';
                    const cat = btn.dataset.category;
                    if (cat && categoryColors[cat]) {
                        btn.style.color = categoryColors[cat];
                    } else if (btn.textContent === 'ì „ì²´') {
                        btn.style.color = '#2E1A47';
                    }
                }
            });

            updateLectureList();
        }

        const speakerInput = document.getElementById('speakerKo');
        const autocompleteList = document.getElementById('autocompleteList');
        let autocompleteIndex = -1;
        let currentMatches = [];
        
        function updateAutocomplete() {
            const value = speakerInput.value.trim();
            autocompleteIndex = -1;
            
            if (!value) {
                autocompleteList.classList.remove('active');
                autocompleteList.innerHTML = '';
                currentMatches = [];
                return;
            }

            currentMatches = speakers.filter(s => {
                const searchValue = value.toLowerCase();
                return s.name.toLowerCase().includes(searchValue) || 
                       s.affiliation.toLowerCase().includes(searchValue);
            });

            if (currentMatches.length > 0) {
                renderAutocompleteList();
                autocompleteList.classList.add('active');
            } else {
                autocompleteList.classList.remove('active');
                autocompleteList.innerHTML = '';
            }
        }

        function renderAutocompleteList() {
            autocompleteList.innerHTML = currentMatches.map((s, idx) => {
                const isSelected = idx === autocompleteIndex;
                return `<div class="autocomplete-item ${isSelected ? 'selected' : ''}" 
                            onclick="selectSpeaker(${speakers.indexOf(s)})"
                            data-index="${idx}">
                    <strong>${s.name}</strong>
                    <small>${s.affiliation}</small>
                </div>`;
            }).join('');
        }

        speakerInput.addEventListener('input', updateAutocomplete);
        speakerInput.addEventListener('compositionend', updateAutocomplete);

        // í‚¤ë³´ë“œ í™”ì‚´í‘œ ë° Enter ì§€ì›
        speakerInput.addEventListener('keydown', function(e) {
            if (!autocompleteList.classList.contains('active')) return;
            
            if (e.key === 'ArrowDown') {
                e.preventDefault();
                autocompleteIndex = Math.min(autocompleteIndex + 1, currentMatches.length - 1);
                renderAutocompleteList();
                scrollToSelected();
            } else if (e.key === 'ArrowUp') {
                e.preventDefault();
                autocompleteIndex = Math.max(autocompleteIndex - 1, 0);
                renderAutocompleteList();
                scrollToSelected();
            } else if (e.key === 'Enter') {
                e.preventDefault();
                if (autocompleteIndex >= 0 && autocompleteIndex < currentMatches.length) {
                    const selectedSpeaker = currentMatches[autocompleteIndex];
                    selectSpeaker(speakers.indexOf(selectedSpeaker));
                }
            } else if (e.key === 'Escape') {
                autocompleteList.classList.remove('active');
                autocompleteList.innerHTML = '';
                autocompleteIndex = -1;
            }
        });

        function scrollToSelected() {
            const selectedItem = autocompleteList.querySelector('.autocomplete-item.selected');
            if (selectedItem) {
                selectedItem.scrollIntoView({ block: 'nearest' });
            }
        }

        document.addEventListener('click', function(e) {
            if (!e.target.closest('.autocomplete-container')) {
                autocompleteList.classList.remove('active');
                autocompleteIndex = -1;
            }
        });

        function selectSpeaker(index) {
            const speaker = speakers[index];
            document.getElementById('speakerKo').value = speaker.name;
            document.getElementById('speakerEn').value = speaker.nameEn || '';
            document.getElementById('affiliation').value = speaker.affiliation;
            autocompleteList.classList.remove('active');
            autocompleteList.innerHTML = '';
            autocompleteIndex = -1;
            currentMatches = [];
        }

        function createScheduleTable() {
            const table = document.getElementById('scheduleTable');
            table.innerHTML = '';
            
            // ê·¸ë¦¬ë“œ ì»¬ëŸ¼ ì„¤ì • (55px ì‹œê°„ì—´ + ë£¸ë“¤)
            table.style.gridTemplateColumns = `55px repeat(${rooms.length}, minmax(140px, 1fr))`;

            // í—¤ë” í–‰
            const timeHeader = document.createElement('div');
            timeHeader.className = 'time-header';
            timeHeader.textContent = 'ì‹œê°„';
            table.appendChild(timeHeader);

            rooms.forEach((room, roomIndex) => {
                const roomHeader = document.createElement('div');
                roomHeader.className = 'room-header';
                
                // ìˆ˜ì • ê°€ëŠ¥í•œ input
                const roomInput = document.createElement('input');
                roomInput.type = 'text';
                roomInput.value = room;
                roomInput.title = 'í´ë¦­í•˜ì—¬ ë£¸ ì´ë¦„ ìˆ˜ì •';
                roomInput.dataset.roomIndex = roomIndex;
                
                roomInput.addEventListener('change', function() {
                    const oldName = rooms[roomIndex];
                    const newName = this.value.trim() || oldName;
                    
                    // ìŠ¤ì¼€ì¤„ê³¼ ì„¸ì…˜ì˜ ë£¸ ì´ë¦„ë„ ì—…ë°ì´íŠ¸
                    updateRoomNameInData(oldName, newName);
                    
                    rooms[roomIndex] = newName;
                    saveRoomsToStorage();
                });
                
                roomInput.addEventListener('blur', function() {
                    if (!this.value.trim()) {
                        this.value = rooms[roomIndex];
                    }
                });
                
                // ë£¸ ì‚­ì œ ë²„íŠ¼ (ë£¸ì´ 2ê°œ ì´ìƒì¼ ë•Œë§Œ)
                if (rooms.length > 1) {
                    const deleteBtn = document.createElement('button');
                    deleteBtn.innerHTML = 'Ã—';
                    deleteBtn.style.cssText = 'position: absolute; top: 2px; right: 2px; background: rgba(255,255,255,0.3); border: none; color: white; width: 18px; height: 18px; border-radius: 50%; cursor: pointer; font-size: 12px; line-height: 1;';
                    deleteBtn.title = 'ë£¸ ì‚­ì œ';
                    deleteBtn.onclick = (e) => {
                        e.stopPropagation();
                        if (confirm(`"${room}" ë£¸ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\ní•´ë‹¹ ë£¸ì˜ ëª¨ë“  ê°•ì˜ì™€ ì„¸ì…˜ì´ ì‚­ì œë©ë‹ˆë‹¤.`)) {
                            deleteRoom(roomIndex);
                        }
                    };
                    roomHeader.appendChild(deleteBtn);
                }
                
                roomHeader.appendChild(roomInput);
                roomHeader.style.position = 'relative';
                table.appendChild(roomHeader);
            });

            // ì‹œê°„ ìŠ¬ë¡¯ í–‰ë“¤
            timeSlots.forEach((time, timeIndex) => {
                const [hour, min] = time.split(':').map(Number);
                
                // ì‹œê°„ ì…€ í´ë˜ìŠ¤ ê²°ì •
                let timeCellClass = 'time-cell';
                let showTime = false;
                
                if (min === 0 || min === 30) {
                    timeCellClass += ' hour-mark';
                    showTime = true;
                } else if (min === 15 || min === 45) {
                    timeCellClass += ' quarter-mark';
                    showTime = true;
                } else {
                    timeCellClass += ' five-min';
                }
                
                const timeCell = document.createElement('div');
                timeCell.className = timeCellClass;
                timeCell.innerHTML = `<span class="time-label">${showTime ? time : ''}</span>`;
                table.appendChild(timeCell);

                // ê° ë£¸ ì…€
                rooms.forEach(room => {
                    const cell = document.createElement('div');
                    let cellClass = 'schedule-cell';
                    
                    if (min === 0 || min === 30) {
                        cellClass += ' hour-mark';
                    } else if (min === 15 || min === 45) {
                        cellClass += ' quarter-mark';
                    } else {
                        cellClass += ' five-min';
                    }
                    
                    cell.className = cellClass;
                    cell.dataset.time = time;
                    cell.dataset.room = room;
                    cell.dataset.timeIndex = timeIndex;
                    
                    // 30ë¶„ ë‹¨ìœ„ì—ë§Œ ì„¸ì…˜ ì¶”ê°€ ë²„íŠ¼
                    if (min === 0 || min === 30) {
                        const addSessionBtn = document.createElement('button');
                        addSessionBtn.className = 'add-session-btn';
                        addSessionBtn.textContent = '+ ì„¸ì…˜';
                        addSessionBtn.onclick = (e) => {
                            e.stopPropagation();
                            openCellSessionModal(time, room);
                        };
                        cell.appendChild(addSessionBtn);
                    }

                    cell.addEventListener('dragover', handleDragOver);
                    cell.addEventListener('dragleave', handleDragLeave);
                    cell.addEventListener('drop', handleDrop);

                    table.appendChild(cell);
                });
            });

            updateScheduleDisplay();
        }
        
        // ë£¸ ê´€ë¦¬ í•¨ìˆ˜ë“¤
        function addRoom() {
            const newRoomName = prompt('ìƒˆ ë£¸ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”:', `ë£¸${rooms.length + 1}`);
            if (newRoomName && newRoomName.trim()) {
                rooms.push(newRoomName.trim());
                saveRoomsToStorage();
                createScheduleTable();
            }
        }
        
        function deleteRoom(roomIndex) {
            const roomName = rooms[roomIndex];
            
            // í•´ë‹¹ ë£¸ì˜ ê°•ì˜ì™€ ì„¸ì…˜ ì‚­ì œ
            Object.keys(schedule).forEach(key => {
                if (key.includes(`-${roomName}`)) {
                    delete schedule[key];
                }
            });
            sessions = sessions.filter(s => s.room !== roomName);
            
            rooms.splice(roomIndex, 1);
            saveRoomsToStorage();
            saveAndSync();
            createScheduleTable();
        }
        
        function updateRoomNameInData(oldName, newName) {
            // ìŠ¤ì¼€ì¤„ ì—…ë°ì´íŠ¸
            const newSchedule = {};
            Object.entries(schedule).forEach(([key, value]) => {
                const newKey = key.replace(`-${oldName}`, `-${newName}`);
                newSchedule[newKey] = value;
            });
            schedule = newSchedule;
            
            // ì„¸ì…˜ ì—…ë°ì´íŠ¸
            sessions.forEach(s => {
                if (s.room === oldName) {
                    s.room = newName;
                }
            });
            
            saveAndSync();
        }
        
        function saveRoomsToStorage() {
            localStorage.setItem('conference_rooms', JSON.stringify(rooms));
        }
        
        function loadRoomsFromStorage() {
            const saved = localStorage.getItem('conference_rooms');
            if (saved) {
                const parsedRooms = JSON.parse(saved);
                if (parsedRooms && parsedRooms.length > 0) {
                    rooms = parsedRooms;
                }
            }
            // ì €ì¥ëœ ë£¸ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ìœ ì§€
        }
        
        // ê¸°ë³¸ ë£¸ ëª©ë¡
        const DEFAULT_ROOMS = ['ê¸°ì´ˆ', 'ì‹¬í™”ë ˆì´ì €', 'ì‹¬í™”ì˜ë ', 'ìˆ˜ìˆ ', 'ê°œì›', 'ë£¸A', 'ë£¸B', 'ë£¸C', 'ë©”ì¸í™€'];
        
        // ë“œë˜ê·¸ íˆ´íŒ ìƒì„±/ì—…ë°ì´íŠ¸
        let dragTooltip = null;
        
        function createDragTooltip() {
            if (!dragTooltip) {
                dragTooltip = document.createElement('div');
                dragTooltip.className = 'drag-tooltip';
                dragTooltip.style.display = 'none';
                document.body.appendChild(dragTooltip);
            }
            return dragTooltip;
        }
        
        function updateDragTooltip(e, startTime, duration) {
            const tooltip = createDragTooltip();
            const endTime = addMinutesToTime(startTime, duration);
            tooltip.innerHTML = `
                <div class="time-info">ğŸ“ ${startTime} ~ ${endTime}</div>
                <div>(${duration}ë¶„)</div>
            `;
            tooltip.style.display = 'block';
            tooltip.style.left = (e.clientX + 15) + 'px';
            tooltip.style.top = (e.clientY + 15) + 'px';
        }
        
        function hideDragTooltip() {
            if (dragTooltip) {
                dragTooltip.style.display = 'none';
            }
        }
        
        function addMinutesToTime(timeStr, minutes) {
            const [hour, min] = timeStr.split(':').map(Number);
            const totalMin = hour * 60 + min + minutes;
            const newHour = Math.floor(totalMin / 60);
            const newMin = totalMin % 60;
            return `${newHour.toString().padStart(2, '0')}:${newMin.toString().padStart(2, '0')}`;
        }

        document.getElementById('addLectureBtn').addEventListener('click', async function() {
            const form = document.getElementById('lectureForm');
            
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            const speakerKoValue = document.getElementById('speakerKo').value.trim();
            const speakerExists = speakers.find(s => s.name.toLowerCase() === speakerKoValue.toLowerCase());

            if (!speakerExists) {
                // ì—°ìê°€ ëª©ë¡ì— ì—†ì„ ë•Œ
                pendingSpeakerInfo = {
                    name: speakerKoValue,
                    nameEn: document.getElementById('speakerEn').value.trim() || '',
                    affiliation: document.getElementById('affiliation').value.trim() || '',
                    affiliationEn: ''
                };

                document.getElementById('confirmMessage').textContent = 
                    `"${speakerKoValue}" ì—°ìê°€ ëª©ë¡ì— ì—†ìŠµë‹ˆë‹¤. ì—°ì ëª©ë¡ì— ì¶”ê°€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`;
                document.getElementById('confirmAddSpeakerModal').classList.add('active');
                return;
            }

            addLectureToList();
        });

        function closeConfirmAddSpeaker() {
            document.getElementById('confirmAddSpeakerModal').classList.remove('active');
            // ì—°ì ëª©ë¡ì— ì¶”ê°€í•˜ì§€ ì•Šë”ë¼ë„ ê°•ì˜ëŠ” ì¶”ê°€
            if (pendingSpeakerInfo) {
                addLectureToList();
            }
            pendingSpeakerInfo = null;
        }

        function confirmAddNewSpeaker() {
            if (pendingSpeakerInfo) {
                speakers.push(pendingSpeakerInfo);
                saveAndSync(); // ì €ì¥ ë° ë™ê¸°í™”
                updateSpeakerList();
                
                document.getElementById('speakerEn').value = pendingSpeakerInfo.nameEn;
                document.getElementById('confirmAddSpeakerModal').classList.remove('active');
                pendingSpeakerInfo = null;
                
                addLectureToList();
            }
        }

        function addLectureToList() {
            const speakerKo = document.getElementById('speakerKo').value.trim();
            const speakerEn = document.getElementById('speakerEn').value.trim();
            const affiliation = document.getElementById('affiliation').value.trim();
            
            // ì—°ì ëª©ë¡ì—ì„œ í•´ë‹¹ ì—°ì ì°¾ê¸°
            const existingSpeaker = speakers.find(s => s.name === speakerKo);
            
            if (existingSpeaker) {
                // ì˜ë¬¸ëª…ì´ë‚˜ ì†Œì†ì´ ë³€ê²½ë˜ì—ˆëŠ”ì§€ í™•ì¸
                const isEnChanged = speakerEn && existingSpeaker.nameEn !== speakerEn;
                const isAffChanged = affiliation && existingSpeaker.affiliation !== affiliation;
                
                if (isEnChanged || isAffChanged) {
                    let changeDetails = [];
                    if (isEnChanged) changeDetails.push(`ì˜ë¬¸ëª…: ${existingSpeaker.nameEn || '(ì—†ìŒ)'} â†’ ${speakerEn}`);
                    if (isAffChanged) changeDetails.push(`ì†Œì†: ${existingSpeaker.affiliation || '(ì—†ìŒ)'} â†’ ${affiliation}`);
                    
                    const updateSpeaker = confirm(`ì—°ì ì •ë³´ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.\n\n${changeDetails.join('\n')}\n\nì—°ì ëª©ë¡ë„ ì—…ë°ì´íŠ¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`);
                    
                    if (updateSpeaker) {
                        if (isEnChanged) existingSpeaker.nameEn = speakerEn;
                        if (isAffChanged) existingSpeaker.affiliation = affiliation;
                        saveSpeakersToStorage();
                        console.log('ì—°ì ì •ë³´ê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    }
                }
            }
            
            const lecture = {
                id: Date.now(),
                category: document.getElementById('category').value,
                titleKo: document.getElementById('titleKo').value,
                titleEn: document.getElementById('titleEn').value,
                speakerKo: speakerKo,
                speakerEn: speakerEn,
                affiliation: affiliation,
                duration: parseInt(document.getElementById('lectureDuration').value) || 15
            };
            
            lectures.push(lecture);
            saveAndSync(); // ì €ì¥ ë° ë™ê¸°í™”
            updateLectureList();
            
            document.getElementById('category').value = '';
            document.getElementById('titleKo').value = '';
            document.getElementById('titleEn').value = '';
            document.getElementById('speakerKo').value = '';
            document.getElementById('speakerEn').value = '';
            document.getElementById('affiliation').value = '';
            document.getElementById('lectureDuration').value = '15';
            
            autocompleteList.classList.remove('active');
            autocompleteList.innerHTML = '';
            
            console.log('ê°•ì˜ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤. ë³€ê²½ì‚¬í•­ì´ ìë™ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        function updateLectureList() {
            const list = document.getElementById('lectureList');
            list.innerHTML = '';

            const filteredLectures = activeFilter === 'all' 
                ? lectures 
                : lectures.filter(l => l.category === activeFilter);

            if (filteredLectures.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: var(--text-light); padding: 2rem;">ê°•ì˜ê°€ ì—†ìŠµë‹ˆë‹¤</p>';
                return;
            }

            // ì‹œê°„í‘œì— ë°°ì¹˜ëœ ê°•ì˜ ID ëª©ë¡
            const scheduledLectureIds = Object.values(schedule).map(s => s.id);

            filteredLectures.forEach(lecture => {
                const color = categoryColors[lecture.category] || '#9B59B6';
                const isScheduled = scheduledLectureIds.includes(lecture.id);
                const item = document.createElement('div');
                item.className = 'lecture-item' + (isScheduled ? ' scheduled' : '');
                item.draggable = true;
                item.dataset.lectureId = lecture.id;
                item.style.borderLeft = `4px solid ${color}`;

                const duration = lecture.duration || 15;
                item.innerHTML = `
                    <div class="lecture-title">
                        <span class="category-color" style="background: ${color}"></span>
                        ${lecture.titleKo}
                    </div>
                    <div class="lecture-meta">
                        <span class="tag tag-speaker">${lecture.speakerKo}</span>
                        <span class="tag" style="background: #E3F2FD; color: #1976D2;">â±ï¸ ${duration}ë¶„</span>
                        ${isScheduled ? '<span class="tag" style="background: #E8F5E9; color: #4CAF50;">ë°°ì¹˜ë¨</span>' : ''}
                    </div>
                `;

                item.addEventListener('dragstart', handleDragStart);
                item.addEventListener('dragend', handleDragEnd);
                item.addEventListener('dblclick', () => openEditModal(lecture.id));

                list.appendChild(item);
            });
        }

        let draggedLecture = null;
        let draggedSession = null;
        let draggedScheduleKey = null;

        function handleDragStart(e) {
            draggedLecture = lectures.find(l => l.id == this.dataset.lectureId);
            this.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/plain', this.dataset.lectureId);
            
            // ë“œë˜ê·¸ ì‹œì‘ ì‹œ ì‹œê°„í‘œì— dragging í´ë˜ìŠ¤ ì¶”ê°€ (5ë¶„ ëˆˆê¸ˆ í‘œì‹œ)
            document.querySelector('.schedule-grid').classList.add('dragging');
            
            // íˆ´íŒ ì´ˆê¸°í™”
            const tooltip = document.getElementById('dragTooltip');
            if (tooltip && draggedLecture) {
                document.getElementById('tooltipTitle').textContent = draggedLecture.titleKo;
                document.getElementById('tooltipDuration').textContent = `â±ï¸ ${draggedLecture.duration || 15}ë¶„`;
            }
        }

        function handleDragEnd(e) {
            this.classList.remove('dragging');
            
            // ë“œë˜ê·¸ ì¢…ë£Œ ì‹œ dragging í´ë˜ìŠ¤ ì œê±°
            document.querySelector('.schedule-grid').classList.remove('dragging');
            
            // íˆ´íŒ ìˆ¨ê¸°ê¸°
            const tooltip = document.getElementById('dragTooltip');
            if (tooltip) {
                tooltip.classList.remove('active');
            }
            
            // ëª¨ë“  ì…€ì—ì„œ drag-target í´ë˜ìŠ¤ ì œê±°
            document.querySelectorAll('.schedule-cell').forEach(cell => {
                cell.classList.remove('drag-target');
                cell.classList.remove('drag-over');
            });
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            
            // í˜„ì¬ ì…€ í•˜ì´ë¼ì´íŠ¸
            document.querySelectorAll('.schedule-cell').forEach(cell => {
                cell.classList.remove('drag-target');
            });
            this.classList.add('drag-target');
            
            // ë“œë˜ê·¸ íˆ´íŒ ì—…ë°ì´íŠ¸
            if (draggedLecture) {
                const time = this.dataset.time;
                const duration = draggedLecture.duration || 15;
                const endTime = addMinutesToTime(time, duration);
                
                const tooltip = document.getElementById('dragTooltip');
                if (tooltip) {
                    document.getElementById('tooltipTime').textContent = `ğŸ“ ${time} â†’ ${endTime}`;
                    tooltip.classList.add('active');
                    tooltip.style.left = (e.clientX + 20) + 'px';
                    tooltip.style.top = (e.clientY + 20) + 'px';
                }
            }
        }

        function handleDragLeave(e) {
            this.classList.remove('drag-target');
        }

        // ì—°ì ì¤‘ë³µ ì²´í¬ í•¨ìˆ˜
        const ROOM_TRANSFER_TIME = 10; // ë£¸ ì´ë™ ì‹œê°„ (ë¶„)
        
        function timeToMinutes(timeStr) {
            const [hours, minutes] = timeStr.split(':').map(Number);
            return hours * 60 + minutes;
        }
        
        function checkSpeakerConflict(speakerKo, targetTime, targetRoom, targetDuration = 15, excludeKey = null) {
            const targetStart = timeToMinutes(targetTime);
            const targetEnd = targetStart + targetDuration;
            
            for (const [scheduleKey, lecture] of Object.entries(schedule)) {
                if (excludeKey && scheduleKey === excludeKey) continue;
                if (lecture.speakerKo !== speakerKo) continue;
                
                const parts = scheduleKey.split('-');
                const existingTime = parts[0] + ':' + parts[1];
                const existingRoom = parts.slice(2).join('-');
                
                if (existingRoom === targetRoom) continue;
                
                const lectureStart = timeToMinutes(existingTime);
                const lectureDuration = lecture.duration || 15;
                const lectureEnd = lectureStart + lectureDuration;
                
                // ì´ë™ ì‹œê°„ ê³ ë ¤ (10ë¶„)
                const safeEnd = lectureEnd + ROOM_TRANSFER_TIME;
                const safeStart = lectureStart - ROOM_TRANSFER_TIME;
                
                if (targetStart < safeEnd && targetEnd > safeStart) {
                    return {
                        conflictRoom: existingRoom,
                        conflictTime: existingTime
                    };
                }
            }
            return null;
        }

        function handleDrop(e) {
            e.preventDefault();
            this.classList.remove('drag-over');
            this.classList.remove('drag-target');
            
            // ë“œë˜ê·¸ í´ë˜ìŠ¤ ì œê±°
            document.querySelector('.schedule-grid').classList.remove('dragging');
            
            // íˆ´íŒ ìˆ¨ê¸°ê¸°
            const tooltip = document.getElementById('dragTooltip');
            if (tooltip) {
                tooltip.classList.remove('active');
            }
            
            // ëª¨ë“  ì…€ì—ì„œ í´ë˜ìŠ¤ ì œê±°
            document.querySelectorAll('.schedule-cell').forEach(cell => {
                cell.classList.remove('dragging-over');
                cell.classList.remove('drag-target');
            });

            console.log('ğŸ¯ Drop event - draggedLecture:', draggedLecture);
            
            if (draggedLecture) {
                const time = this.dataset.time;
                const room = this.dataset.room;
                const key = `${time}-${room}`;
                
                console.log('ğŸ“ Drop location:', { time, room, key });
                
                // ê°•ì˜ ëª©ë¡ì—ì„œ ë“œë˜ê·¸í•œ ê²½ìš° (ì‹œê°„í‘œ ë‚´ ì´ë™ì´ ì•„ë‹Œ ê²½ìš°)
                // ì´ë¯¸ ë°°ì¹˜ëœ ê°•ì˜ì¸ì§€ í™•ì¸
                if (!draggedScheduleKey) {
                    const existingPlacement = Object.entries(schedule).find(([k, v]) => v.id === draggedLecture.id);
                    if (existingPlacement) {
                        const [existingKey] = existingPlacement;
                        const parts = existingKey.split('-');
                        const existingTime = parts[0] + ':' + parts[1];
                        const existingRoom = parts.slice(2).join('-');
                        
                        showAlreadyPlacedDialog(existingKey, existingTime, existingRoom, key, time, room, draggedLecture);
                        return;
                    }
                }
                
                // ì´ë¯¸ ê°•ì˜ê°€ ìˆëŠ” ì…€ì¸ì§€ í™•ì¸
                if (schedule[key]) {
                    if (!draggedScheduleKey || draggedScheduleKey !== key) {
                        showSwapDialog(key, time, room, draggedLecture, draggedScheduleKey);
                        return;
                    }
                }
                
                // Undoë¥¼ ìœ„í•´ ìƒíƒœ ì €ì¥
                saveStateForUndo();
                
                // ì‹œê°„í‘œ ë‚´ ì´ë™ì¸ ê²½ìš° ê¸°ì¡´ ìœ„ì¹˜ì—ì„œ ì‚­ì œ
                if (draggedScheduleKey && draggedScheduleKey !== key) {
                    delete schedule[draggedScheduleKey];
                }

                // ê°•ì˜ ë³µì‚¬
                const newLecture = { ...draggedLecture };
                
                // í•´ë‹¹ ì…€ì— ì„¸ì…˜ì´ ìˆìœ¼ë©´ ìë™ìœ¼ë¡œ ì„¸ì…˜ ì†Œì† ì„¤ì •
                const sessionAtCell = sessions.find(s => s.time === time && s.room === room);
                if (sessionAtCell) {
                    newLecture.sessionId = sessionAtCell.id;
                } else {
                    // ê°™ì€ ë£¸ì˜ ìœ„ìª½ ì‹œê°„ëŒ€ì— ì„¸ì…˜ì´ ìˆëŠ”ì§€ í™•ì¸
                    const timeIndex = timeSlots.indexOf(time);
                    for (let i = timeIndex - 1; i >= 0; i--) {
                        const upperSession = sessions.find(s => s.time === timeSlots[i] && s.room === room);
                        if (upperSession) {
                            newLecture.sessionId = upperSession.id;
                            break;
                        }
                    }
                }

                schedule[key] = newLecture;
                saveAndSync();
                updateScheduleDisplay();
                
                draggedScheduleKey = null;
                draggedLecture = null;
            }
            
            // ì„¸ì…˜ ë“œë¡­ ì²˜ë¦¬
            if (draggedSession) {
                const time = this.dataset.time;
                const room = this.dataset.room;
                
                if (draggedSession.time === time && draggedSession.room === room) {
                    draggedSession = null;
                    return;
                }
                
                const existingSession = sessions.find(s => s.time === time && s.room === room);
                if (existingSession) {
                    alert('ì´ ìœ„ì¹˜ì— ì´ë¯¸ ì„¸ì…˜ì´ ìˆìŠµë‹ˆë‹¤.');
                    draggedSession = null;
                    return;
                }
                
                saveStateForUndo();
                draggedSession.time = time;
                draggedSession.room = room;
                
                saveAndSync();
                updateScheduleDisplay();
                draggedSession = null;
            }
        }
        
        // ì´ë¯¸ ë°°ì¹˜ëœ ê°•ì˜ í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸
        function showAlreadyPlacedDialog(existingKey, existingTime, existingRoom, newKey, newTime, newRoom, lecture) {
            const dialog = document.createElement('div');
            dialog.className = 'swap-dialog-overlay';
            dialog.innerHTML = `
                <div class="swap-dialog">
                    <h3>âš ï¸ ì´ë¯¸ ë°°ì¹˜ëœ ê°•ì˜ì…ë‹ˆë‹¤</h3>
                    <p style="margin-bottom: 0.5rem;"><strong>ê°•ì˜:</strong> ${lecture.titleKo}</p>
                    <p style="margin-bottom: 1rem; color: var(--accent);"><strong>í˜„ì¬ ìœ„ì¹˜:</strong> ${existingRoom} ${existingTime}</p>
                    <div class="swap-options">
                        <button class="swap-option" data-action="move" autofocus>
                            <span class="option-key">1</span> ê¸°ì¡´ ë°°ì¹˜ ì‚­ì œ í›„ ìƒˆ ìœ„ì¹˜ì— ë°°ì¹˜
                        </button>
                        <button class="swap-option cancel" data-action="cancel">
                            <span class="option-key">ESC</span> ì·¨ì†Œ
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(dialog);
            
            const handleAction = (action) => {
                dialog.remove();
                document.removeEventListener('keydown', handleKeydown);
                
                if (action === 'cancel') {
                    draggedScheduleKey = null;
                    draggedLecture = null;
                    return;
                }
                
                if (action === 'move') {
                    saveStateForUndo();
                    
                    // ê¸°ì¡´ ìœ„ì¹˜ì—ì„œ ì‚­ì œ
                    delete schedule[existingKey];
                    
                    // ìƒˆ ìœ„ì¹˜ì— ê°•ì˜ê°€ ìˆìœ¼ë©´ ì²˜ë¦¬
                    if (schedule[newKey]) {
                        // ìƒˆ ìœ„ì¹˜ì— ì´ë¯¸ ê°•ì˜ê°€ ìˆìœ¼ë©´ í™•ì¸
                        const targetLecture = schedule[newKey];
                        if (confirm(`ìƒˆ ìœ„ì¹˜(${newRoom} ${newTime})ì— ì´ë¯¸ "${targetLecture.titleKo}" ê°•ì˜ê°€ ìˆìŠµë‹ˆë‹¤.\nëŒ€ì²´í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                            schedule[newKey] = { ...lecture };
                        }
                    } else {
                        // ìƒˆ ìœ„ì¹˜ì— ë°°ì¹˜
                        const newLecture = { ...lecture };
                        
                        // ì„¸ì…˜ ìë™ í• ë‹¹
                        const sessionAtCell = sessions.find(s => s.time === newTime && s.room === newRoom);
                        if (sessionAtCell) {
                            newLecture.sessionId = sessionAtCell.id;
                        }
                        
                        schedule[newKey] = newLecture;
                    }
                    
                    saveAndSync();
                    updateScheduleDisplay();
                }
                
                draggedScheduleKey = null;
                draggedLecture = null;
            };
            
            dialog.querySelectorAll('.swap-option').forEach(btn => {
                btn.onclick = () => handleAction(btn.dataset.action);
            });
            
            const handleKeydown = (e) => {
                if (e.key === '1') handleAction('move');
                else if (e.key === 'Escape') handleAction('cancel');
                else if (e.key === 'Enter') {
                    const focused = dialog.querySelector('.swap-option:focus');
                    if (focused) handleAction(focused.dataset.action);
                }
            };
            document.addEventListener('keydown', handleKeydown);
            
            dialog.querySelector('.swap-option[autofocus]').focus();
        }

        // ë§ë°”ê¾¸ê¸° ë‹¤ì´ì–¼ë¡œê·¸
        function showSwapDialog(targetKey, time, room, newLecture, sourceKey) {
            const existingLecture = schedule[targetKey];
            
            const dialog = document.createElement('div');
            dialog.className = 'swap-dialog-overlay';
            dialog.innerHTML = `
                <div class="swap-dialog">
                    <h3>âš ï¸ ê°•ì˜ê°€ ì´ë¯¸ ìˆìŠµë‹ˆë‹¤</h3>
                    <p><strong>ê¸°ì¡´:</strong> ${existingLecture.titleKo} (${existingLecture.speakerKo})</p>
                    <p><strong>ìƒˆë¡œìš´:</strong> ${newLecture.titleKo} (${newLecture.speakerKo})</p>
                    <div class="swap-options">
                        <button class="swap-option" data-action="replace" autofocus>
                            <span class="option-key">1</span> ëŒ€ì²´ (ê¸°ì¡´ ê°•ì˜ ì‚­ì œ)
                        </button>
                        <button class="swap-option" data-action="swap">
                            <span class="option-key">2</span> ë§ë°”ê¾¸ê¸° (ìœ„ì¹˜ êµí™˜)
                        </button>
                        <button class="swap-option cancel" data-action="cancel">
                            <span class="option-key">ESC</span> ì·¨ì†Œ
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(dialog);
            
            const handleAction = (action) => {
                dialog.remove();
                document.removeEventListener('keydown', handleKeydown);
                
                if (action === 'cancel') {
                    draggedScheduleKey = null;
                    draggedLecture = null;
                    return;
                }
                
                saveStateForUndo();
                
                if (action === 'replace') {
                    if (sourceKey) {
                        delete schedule[sourceKey];
                    }
                    schedule[targetKey] = { ...newLecture };
                } else if (action === 'swap') {
                    if (sourceKey) {
                        schedule[sourceKey] = { ...existingLecture };
                        schedule[targetKey] = { ...newLecture };
                    } else {
                        // ì™¼ìª½ ëª©ë¡ì—ì„œ ë“œë˜ê·¸í•œ ê²½ìš° - êµí™˜ ë¶ˆê°€, ëŒ€ì²´ë§Œ ê°€ëŠ¥
                        schedule[targetKey] = { ...newLecture };
                    }
                }
                
                saveAndSync();
                updateScheduleDisplay();
                draggedScheduleKey = null;
                draggedLecture = null;
            };
            
            dialog.querySelectorAll('.swap-option').forEach(btn => {
                btn.onclick = () => handleAction(btn.dataset.action);
            });
            
            const handleKeydown = (e) => {
                if (e.key === '1') handleAction('replace');
                else if (e.key === '2') handleAction('swap');
                else if (e.key === 'Escape') handleAction('cancel');
                else if (e.key === 'Enter') {
                    const focused = dialog.querySelector('.swap-option:focus');
                    if (focused) handleAction(focused.dataset.action);
                }
            };
            document.addEventListener('keydown', handleKeydown);
            
            dialog.querySelector('.swap-option[autofocus]').focus();
        }

        function updateScheduleDisplay() {
            // ê¸°ì¡´ ê°•ì˜ ë¸”ë¡ë“¤ ì œê±°
            document.querySelectorAll('.scheduled-lecture').forEach(el => el.remove());
            document.querySelectorAll('.session-header-cell').forEach(el => el.remove());
            
            // ê° ì…€ì˜ ì„¸ì…˜ ì¶”ê°€ ë²„íŠ¼ ì¬ì„¤ì •
            document.querySelectorAll('.schedule-cell').forEach(cell => {
                const time = cell.dataset.time;
                const room = cell.dataset.room;
                const [hour, min] = time.split(':').map(Number);
                
                // ì„¸ì…˜ ì¶”ê°€ ë²„íŠ¼ ì²˜ë¦¬ (30ë¶„ ë‹¨ìœ„ì—ë§Œ)
                let addSessionBtn = cell.querySelector('.add-session-btn');
                if (!addSessionBtn && (min === 0 || min === 30)) {
                    addSessionBtn = document.createElement('button');
                    addSessionBtn.className = 'add-session-btn';
                    addSessionBtn.textContent = '+ ì„¸ì…˜';
                    addSessionBtn.onclick = (e) => {
                        e.stopPropagation();
                        openCellSessionModal(time, room);
                    };
                    cell.appendChild(addSessionBtn);
                }
                
                // ì„¸ì…˜ì´ ìˆìœ¼ë©´ ì„¸ì…˜ í—¤ë” í‘œì‹œ
                const session = sessions.find(s => s.time === time && s.room === room);
                if (session) {
                    cell.classList.add('has-session');
                    if (addSessionBtn) addSessionBtn.style.display = 'none';
                    
                    const sessionName = currentLanguage === 'en' && session.nameEn ? session.nameEn : session.name;
                    const moderatorLabel = currentLanguage === 'en' ? 'Chair: ' : 'ì¢Œì¥: ';
                    const moderatorName = currentLanguage === 'en' && session.moderatorEn ? session.moderatorEn : session.moderator;
                    
                    const sessionHeader = document.createElement('div');
                    sessionHeader.className = 'session-header-cell';
                    sessionHeader.draggable = true;
                    sessionHeader.dataset.sessionId = session.id;
                    sessionHeader.style.background = `linear-gradient(135deg, ${session.color} 0%, ${adjustColor(session.color, -20)} 100%)`;
                    sessionHeader.innerHTML = `
                        <span class="session-name" title="${sessionName}">${sessionName}</span>
                        ${moderatorName ? `<span class="session-moderator">${moderatorLabel}${moderatorName}</span>` : ''}
                        <button class="session-remove" onclick="event.stopPropagation(); removeSession('${time}', '${room}')">Ã—</button>
                    `;
                    sessionHeader.onclick = (e) => {
                        if (!e.target.classList.contains('session-remove')) {
                            editCellSession(time, room);
                        }
                    };
                    
                    sessionHeader.addEventListener('dragstart', (e) => {
                        e.stopPropagation();
                        draggedSession = session;
                        sessionHeader.style.opacity = '0.5';
                        e.dataTransfer.effectAllowed = 'move';
                    });
                    sessionHeader.addEventListener('dragend', () => {
                        sessionHeader.style.opacity = '1';
                        draggedSession = null;
                    });
                    
                    cell.appendChild(sessionHeader);
                } else {
                    cell.classList.remove('has-session');
                    if (addSessionBtn) addSessionBtn.style.display = '';
                }
            });

            // ê°•ì˜ë“¤ì„ ì‹œê°„ ë¹„ë¡€ ë†’ì´ë¡œ í‘œì‹œ
            Object.entries(schedule).forEach(([key, lecture]) => {
                const parts = key.split('-');
                const startTime = parts[0] + ':' + parts[1];
                const room = parts.slice(2).join('-');
                
                const startIndex = timeSlots.indexOf(startTime);
                if (startIndex === -1) return;
                
                const duration = lecture.duration || 15;
                const slotsSpan = Math.ceil(duration / TIME_UNIT); // 5ë¶„ ë‹¨ìœ„ë¡œ ëª‡ ìŠ¬ë¡¯ ì°¨ì§€í•˜ëŠ”ì§€
                
                // ì‹œì‘ ì…€ ì°¾ê¸°
                const startCell = document.querySelector(`.schedule-cell[data-time="${startTime}"][data-room="${room}"]`);
                if (!startCell) return;
                
                const color = categoryColors[lecture.category] || '#9B59B6';
                const lightColor = adjustColor(color, 40);
                const lectureDiv = document.createElement('div');
                
                const session = sessions.find(s => s.time === startTime && s.room === room);
                const isInSession = lecture.sessionId || session;
                lectureDiv.className = 'scheduled-lecture' + (isInSession ? ' in-session' : '');
                lectureDiv.draggable = true;
                lectureDiv.dataset.scheduleKey = key;
                lectureDiv.tabIndex = 0;
                lectureDiv.style.background = `linear-gradient(135deg, ${lightColor} 0%, ${color} 100%)`;
                
                // ë†’ì´ ê³„ì‚° (5ë¶„ë‹¹ 20px)
                const cellHeight = 20; // ê¸°ë³¸ ì…€ ë†’ì´
                const totalHeight = slotsSpan * cellHeight - 4; // ì•½ê°„ì˜ ì—¬ë°±
                lectureDiv.style.height = `${totalHeight}px`;
                lectureDiv.style.top = '2px';
                
                const title = currentLanguage === 'en' && lecture.titleEn ? lecture.titleEn : lecture.titleKo;
                const speaker = currentLanguage === 'en' && lecture.speakerEn ? lecture.speakerEn : lecture.speakerKo;
                
                lectureDiv.innerHTML = `
                    <button class="remove-btn" onclick="event.stopPropagation(); removeLecture('${key}')">Ã—</button>
                    <div class="lecture-title-display">${title}</div>
                    <div class="lecture-meta-display">
                        <span class="speaker-name">${speaker}</span>
                        <span class="duration-badge">â±ï¸ ${duration}ë¶„</span>
                    </div>
                `;
                
                lectureDiv.addEventListener('dragstart', handleScheduleDragStart);
                lectureDiv.addEventListener('dragend', handleScheduleDragEnd);
                
                // ë”ë¸”í´ë¦­ìœ¼ë¡œ ê°•ì˜ ìˆ˜ì •
                lectureDiv.addEventListener('dblclick', (e) => {
                    e.stopPropagation();
                    openEditModal(lecture.id);
                });
                
                lectureDiv.addEventListener('keydown', (e) => {
                    if (e.key === 'Tab') {
                        e.preventDefault();
                        toggleSessionMembership(key, startTime, room);
                    }
                });
                
                startCell.appendChild(lectureDiv);
            });
        }
        
        // ì„¸ì…˜ ì†Œì† í† ê¸€ í•¨ìˆ˜
        function toggleSessionMembership(key, time, room) {
            const lecture = schedule[key];
            if (!lecture) return;
            
            // í•´ë‹¹ ë£¸ì—ì„œ ì„¸ì…˜ ì°¾ê¸° (í˜„ì¬ ì‹œê°„ ë˜ëŠ” ê·¸ ìœ„ ì‹œê°„ëŒ€)
            const timeIndex = timeSlots.indexOf(time);
            let foundSession = null;
            
            for (let i = timeIndex; i >= 0; i--) {
                const sessionAtTime = sessions.find(s => s.time === timeSlots[i] && s.room === room);
                if (sessionAtTime) {
                    foundSession = sessionAtTime;
                    break;
                }
            }
            
            if (lecture.sessionId) {
                // ì„¸ì…˜ ì†Œì† í•´ì œ
                delete lecture.sessionId;
            } else if (foundSession) {
                // ì„¸ì…˜ ì†Œì† ì„¤ì •
                lecture.sessionId = foundSession.id;
            } else {
                alert('ì´ ë£¸ì— ì„¸ì…˜ì´ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ì„¸ì…˜ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            saveAndSync();
            updateScheduleDisplay();
        }
        
        // ì‹œê°„í‘œ ë‚´ ë“œë˜ê·¸ í•¨ìˆ˜
        function handleScheduleDragStart(e) {
            draggedScheduleKey = this.dataset.scheduleKey;
            draggedLecture = schedule[draggedScheduleKey];
            this.style.opacity = '0.5';
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/plain', draggedScheduleKey);
            
            // ë“œë˜ê·¸ ì‹œì‘ ì‹œ ì‹œê°„í‘œì— dragging í´ë˜ìŠ¤ ì¶”ê°€
            document.querySelector('.schedule-grid').classList.add('dragging');
            
            // íˆ´íŒ ì´ˆê¸°í™”
            const tooltip = document.getElementById('dragTooltip');
            if (tooltip && draggedLecture) {
                document.getElementById('tooltipTitle').textContent = draggedLecture.titleKo;
                document.getElementById('tooltipDuration').textContent = `â±ï¸ ${draggedLecture.duration || 15}ë¶„`;
            }
        }
        
        function handleScheduleDragEnd(e) {
            this.style.opacity = '1';
            draggedScheduleKey = null;
            
            // ë“œë˜ê·¸ ì¢…ë£Œ ì‹œ dragging í´ë˜ìŠ¤ ì œê±°
            document.querySelector('.schedule-grid').classList.remove('dragging');
            
            // íˆ´íŒ ìˆ¨ê¸°ê¸°
            const tooltip = document.getElementById('dragTooltip');
            if (tooltip) {
                tooltip.classList.remove('active');
            }
            
            // ëª¨ë“  ì…€ì—ì„œ drag-target í´ë˜ìŠ¤ ì œê±°
            document.querySelectorAll('.schedule-cell').forEach(cell => {
                cell.classList.remove('drag-target');
            });
        }

        function adjustColor(color, percent) {
            const num = parseInt(color.replace("#",""), 16);
            const amt = Math.round(2.55 * percent);
            const R = (num >> 16) + amt;
            const G = (num >> 8 & 0x00FF) + amt;
            const B = (num & 0x0000FF) + amt;
            return "#" + (0x1000000 + (R<255?R<1?0:R:255)*0x10000 + 
                    (G<255?G<1?0:G:255)*0x100 + (B<255?B<1?0:B:255))
                    .toString(16).slice(1);
        }

        function removeLecture(key) {
            saveStateForUndo();
            delete schedule[key];
            saveAndSync(); // ì €ì¥ ë° ë™ê¸°í™”
            updateScheduleDisplay();
            updateLectureList(); // ë°°ì¹˜ë¨ í‘œì‹œ ì—…ë°ì´íŠ¸
        }

        function openEditModal(lectureId) {
            const lecture = lectures.find(l => l.id === lectureId);
            if (!lecture) return;

            document.getElementById('editLectureId').value = lecture.id;
            document.getElementById('editCategory').value = lecture.category;
            document.getElementById('editTitleKo').value = lecture.titleKo;
            document.getElementById('editTitleEn').value = lecture.titleEn || '';
            document.getElementById('editSpeakerKo').value = lecture.speakerKo;
            document.getElementById('editSpeakerEn').value = lecture.speakerEn || '';
            document.getElementById('editAffiliation').value = lecture.affiliation || '';
            document.getElementById('editDuration').value = lecture.duration || 15;

            document.getElementById('editModal').classList.add('active');
        }

        function closeEditModal() {
            document.getElementById('editModal').classList.remove('active');
        }
        
        function deleteLectureFromModal() {
            const lectureId = parseInt(document.getElementById('editLectureId').value);
            const lecture = lectures.find(l => l.id === lectureId);
            
            if (!lecture) return;
            
            if (confirm(`"${lecture.titleKo}" ê°•ì˜ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì‹œê°„í‘œì—ì„œë„ ì‚­ì œë©ë‹ˆë‹¤.`)) {
                // ê°•ì˜ ëª©ë¡ì—ì„œ ì‚­ì œ
                lectures = lectures.filter(l => l.id !== lectureId);
                
                // ì‹œê°„í‘œì—ì„œë„ ì‚­ì œ
                Object.keys(schedule).forEach(key => {
                    if (schedule[key].id === lectureId) {
                        delete schedule[key];
                    }
                });
                
                saveAndSync();
                updateLectureList();
                updateScheduleDisplay();
                closeEditModal();
            }
        }

        document.getElementById('saveEditBtn').addEventListener('click', function() {
            const lectureId = parseInt(document.getElementById('editLectureId').value);
            const lectureIndex = lectures.findIndex(l => l.id === lectureId);

            if (lectureIndex !== -1) {
                const updatedLecture = {
                    id: lectureId,
                    category: document.getElementById('editCategory').value,
                    titleKo: document.getElementById('editTitleKo').value,
                    titleEn: document.getElementById('editTitleEn').value,
                    speakerKo: document.getElementById('editSpeakerKo').value,
                    speakerEn: document.getElementById('editSpeakerEn').value,
                    affiliation: document.getElementById('editAffiliation').value,
                    duration: parseInt(document.getElementById('editDuration').value) || 15
                };
                
                lectures[lectureIndex] = updatedLecture;

                // ì‹œê°„í‘œì˜ ê°•ì˜ë„ ì—…ë°ì´íŠ¸
                Object.keys(schedule).forEach(key => {
                    if (schedule[key].id === lectureId) {
                        schedule[key] = { ...updatedLecture };
                    }
                });

                saveAndSync();
                updateLectureList();
                updateScheduleDisplay();
                closeEditModal();
            }
        });

        function openSpeakerModal() {
            updateSpeakerList();
            document.getElementById('speakerModal').classList.add('active');
        }

        function closeSpeakerModal() {
            document.getElementById('speakerModal').classList.remove('active');
            document.getElementById('speakerSearch').value = '';
        }

        function searchSpeakers() {
            updateSpeakerList();
        }

        function getSortedAndFilteredSpeakers() {
            const searchTerm = document.getElementById('speakerSearch').value.toLowerCase().trim();
            const sortType = document.getElementById('speakerSort').value;

            // ê²€ìƒ‰ í•„í„°ë§
            let filtered = speakers.filter(speaker => {
                if (!searchTerm) return true;
                
                const nameMatch = speaker.name.toLowerCase().includes(searchTerm);
                const nameEnMatch = (speaker.nameEn || '').toLowerCase().includes(searchTerm);
                const affiliationMatch = speaker.affiliation.toLowerCase().includes(searchTerm);
                const affiliationEnMatch = (speaker.affiliationEn || '').toLowerCase().includes(searchTerm);
                
                return nameMatch || nameEnMatch || affiliationMatch || affiliationEnMatch;
            });

            // ì •ë ¬
            const sorted = [...filtered];
            
            switch(sortType) {
                case 'name-ko':
                    sorted.sort((a, b) => a.name.localeCompare(b.name, 'ko'));
                    break;
                case 'name-en':
                    sorted.sort((a, b) => {
                        const aName = (a.nameEn || a.name).toLowerCase();
                        const bName = (b.nameEn || b.name).toLowerCase();
                        return aName.localeCompare(bName, 'en');
                    });
                    break;
                case 'affiliation':
                    sorted.sort((a, b) => a.affiliation.localeCompare(b.affiliation, 'ko'));
                    break;
                case 'recent':
                    // ë°°ì—´ ìˆœì„œ ê·¸ëŒ€ë¡œ (ìµœê·¼ ì¶”ê°€ê°€ ë’¤ì—)
                    sorted.reverse();
                    break;
            }

            return sorted;
        }

        function updateSpeakerList() {
            const list = document.getElementById('speakerList');
            const displaySpeakers = getSortedAndFilteredSpeakers();
            
            if (displaySpeakers.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: var(--text-light); padding: 2rem;">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</p>';
                return;
            }

            list.innerHTML = displaySpeakers.map(speaker => {
                const originalIndex = speakers.indexOf(speaker);
                return `
                    <div class="speaker-item">
                        <div class="speaker-info">
                            <strong>${speaker.name}${speaker.nameEn ? ' / ' + speaker.nameEn : ''}</strong>
                            <small>${speaker.affiliation}${speaker.affiliationEn ? ' / ' + speaker.affiliationEn : ''}</small>
                        </div>
                        <div class="speaker-actions">
                            <button class="btn btn-secondary btn-small" onclick="editSpeaker(event, ${originalIndex})">ìˆ˜ì •</button>
                            <button class="btn btn-secondary btn-small" onclick="deleteSpeaker(event, ${originalIndex})">ì‚­ì œ</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function addSpeaker() {
            const name = document.getElementById('newSpeakerName').value.trim();
            const nameEn = document.getElementById('newSpeakerNameEn').value.trim();
            const affiliation = document.getElementById('newSpeakerAffiliation').value.trim();
            const affiliationEn = document.getElementById('newSpeakerAffiliationEn').value.trim();

            if (name && affiliation) {
                speakers.push({ name, nameEn, affiliation, affiliationEn });
                document.getElementById('newSpeakerName').value = '';
                document.getElementById('newSpeakerNameEn').value = '';
                document.getElementById('newSpeakerAffiliation').value = '';
                document.getElementById('newSpeakerAffiliationEn').value = '';
                saveAndSync(); // ì €ì¥ ë° ë™ê¸°í™”
                updateSpeakerList();
            } else {
                alert('ì—°ìëª…(í•œê¸€)ê³¼ ì†Œì†(í•œê¸€)ì€ í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.');
            }
        }

        function deleteSpeaker(event, index) {
            event.stopPropagation();
            if (confirm('ì´ ì—°ìë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                speakers.splice(index, 1);
                saveAndSync(); // ì €ì¥ ë° ë™ê¸°í™”
                updateSpeakerList();
            }
        }
        
        function editSpeaker(event, index) {
            event.stopPropagation();
            const speaker = speakers[index];
            
            document.getElementById('editSpeakerIndex').value = index;
            document.getElementById('editSpeakerNameField').value = speaker.name;
            document.getElementById('editSpeakerNameEnField').value = speaker.nameEn || '';
            document.getElementById('editSpeakerAffiliationField').value = speaker.affiliation;
            document.getElementById('editSpeakerAffiliationEnField').value = speaker.affiliationEn || '';
            
            document.getElementById('editSpeakerModal').classList.add('active');
        }
        
        function closeEditSpeakerModal() {
            document.getElementById('editSpeakerModal').classList.remove('active');
        }
        
        function openHelpModal() {
            document.getElementById('helpModal').classList.add('active');
        }
        
        function closeHelpModal() {
            document.getElementById('helpModal').classList.remove('active');
        }
        
        function saveEditedSpeaker() {
            const index = parseInt(document.getElementById('editSpeakerIndex').value);
            
            speakers[index] = {
                name: document.getElementById('editSpeakerNameField').value.trim(),
                nameEn: document.getElementById('editSpeakerNameEnField').value.trim(),
                affiliation: document.getElementById('editSpeakerAffiliationField').value.trim(),
                affiliationEn: document.getElementById('editSpeakerAffiliationEnField').value.trim()
            };
            
            saveAndSync(); // ì €ì¥ ë° ë™ê¸°í™”
            updateSpeakerList();
            closeEditSpeakerModal();
        }

        function loadFromFile(event) {
            const file = event.target.files[0];
            if (!file) return;

            // JSON íŒŒì¼ì¸ì§€ í™•ì¸
            if (!file.name.endsWith('.json')) {
                alert('âŒ JSON íŒŒì¼ë§Œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }

            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    // ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬
                    if (!data.lectures || !data.schedule || !data.speakers) {
                        throw new Error('ì˜¬ë°”ë¥¸ í˜•ì‹ì˜ íŒŒì¼ì´ ì•„ë‹™ë‹ˆë‹¤.');
                    }

                    // í™•ì¸ ë©”ì‹œì§€
                    const savedDate = data.savedAt ? new Date(data.savedAt).toLocaleString('ko-KR') : 'ì•Œ ìˆ˜ ì—†ìŒ';
                    const message = `ğŸ“‚ íŒŒì¼ ì •ë³´:\n\n` +
                                  `ğŸ“… ì €ì¥ ì‹œê°: ${savedDate}\n` +
                                  `ğŸ“š ê°•ì˜ ìˆ˜: ${data.lectures.length}ê°œ\n` +
                                  `ğŸ‘¥ ì—°ì ìˆ˜: ${data.speakers.length}ëª…\n` +
                                  `ğŸ“Š ì‹œê°„í‘œ: ${Object.keys(data.schedule).length}ê°œ ë°°ì¹˜\n\n` +
                                  `í˜„ì¬ ë°ì´í„°ë¥¼ ë®ì–´ì“°ì‹œê² ìŠµë‹ˆê¹Œ?\n` +
                                  `(í˜„ì¬ ë°ì´í„°ëŠ” ì‚¬ë¼ì§‘ë‹ˆë‹¤)`;

                    if (confirm(message)) {
                        // ë°ì´í„° ë®ì–´ì“°ê¸°
                        lectures = data.lectures;
                        schedule = data.schedule;
                        speakers = data.speakers;

                        // ì¹´í…Œê³ ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸° (ìˆìœ¼ë©´)
                        if (data.categories) {
                            categories = data.categories;
                        }
                        if (data.categoryColors) {
                            Object.assign(categoryColors, data.categoryColors);
                        }
                        // ì„¸ì…˜ ë¶ˆëŸ¬ì˜¤ê¸° (ìˆìœ¼ë©´)
                        if (data.sessions) {
                            sessions = data.sessions;
                        }

                        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
                        saveToLocalStorage();

                        // UI ì—…ë°ì´íŠ¸
                        updateCategoryDropdowns();
                        createCategoryFilters();
                        updateLectureList();
                        updateScheduleDisplay();
                        renderSessionBars();

                        alert('âœ… íŒŒì¼ì„ ì„±ê³µì ìœ¼ë¡œ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤!\n\nëª¨ë“  ë°ì´í„°ê°€ ë³µì›ë˜ì—ˆìŠµë‹ˆë‹¤.');
                        
                        // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
                        event.target.value = '';
                    } else {
                        // ì·¨ì†Œ ì‹œ ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
                        event.target.value = '';
                    }
                    
                } catch (error) {
                    console.error('íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:', error);
                    alert('âŒ íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n\n' + error.message);
                    event.target.value = '';
                }
            };

            reader.onerror = function() {
                alert('âŒ íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                event.target.value = '';
            };

            reader.readAsText(file);
        }

        function exportToExcel() {
            let csv = 'ì‹œê°„,ë£¸A,ë£¸B,ë£¸C,ë£¸D,ë©”ì¸í™€\n';

            timeSlots.forEach(time => {
                let row = [time];
                rooms.forEach(room => {
                    const key = `${time}-${room}`;
                    const lecture = schedule[key];
                    row.push(lecture ? `${lecture.titleKo} (${lecture.speakerKo})` : '');
                });
                csv += row.join(',') + '\n';
            });

            const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'schedule.csv';
            link.click();
        }

        function printSchedule() {
            window.print();
        }

        // ë¶„ë¥˜ ê´€ë¦¬ í•¨ìˆ˜ë“¤
        function openCategoryModal() {
            updateCategoryList();
            document.getElementById('categoryModal').classList.add('active');
        }

        function closeCategoryModal() {
            document.getElementById('categoryModal').classList.remove('active');
        }

        function updateCategoryList() {
            const list = document.getElementById('categoryList');
            const sortedCategories = [...categories].sort();
            
            list.innerHTML = sortedCategories.map(cat => {
                const color = categoryColors[cat] || '#9B59B6';
                return `
                    <div class="speaker-item">
                        <div class="speaker-info" style="display: flex; align-items: center; gap: 0.75rem;">
                            <div style="width: 24px; height: 24px; border-radius: 50%; background: ${color};"></div>
                            <strong>${cat}</strong>
                        </div>
                        <div class="speaker-actions">
                            <input type="color" value="${color}" onchange="updateCategoryColor('${cat}', this.value)" style="width: 40px; height: 32px; border: none; cursor: pointer;">
                            <button class="btn btn-secondary btn-small" onclick="deleteCategory('${cat}')">ì‚­ì œ</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function addCategory() {
            const name = document.getElementById('newCategoryName').value.trim();
            const color = document.getElementById('newCategoryColor').value;

            if (!name) {
                alert('ë¶„ë¥˜ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (categories.includes(name)) {
                alert('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ë¶„ë¥˜ì…ë‹ˆë‹¤.');
                return;
            }

            categories.push(name);
            categories.sort();
            categoryColors[name] = color;
            
            document.getElementById('newCategoryName').value = '';
            
            updateCategoryDropdowns();
            updateCategoryList();
            createCategoryFilters();
            saveAndSync();
        }

        function updateCategoryColor(cat, color) {
            categoryColors[cat] = color;
            updateCategoryList();
            createCategoryFilters();
            updateLectureList();
            updateScheduleDisplay();
            saveAndSync();
        }

        function deleteCategory(cat) {
            if (cat === 'Others') {
                alert('"Others" ë¶„ë¥˜ëŠ” ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            if (!confirm(`"${cat}" ë¶„ë¥˜ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\ní•´ë‹¹ ë¶„ë¥˜ì˜ ê°•ì˜ëŠ” "Others"ë¡œ ë³€ê²½ë©ë‹ˆë‹¤.`)) {
                return;
            }

            // í•´ë‹¹ ë¶„ë¥˜ì˜ ê°•ì˜ë“¤ì„ Othersë¡œ ë³€ê²½
            lectures.forEach(lecture => {
                if (lecture.category === cat) {
                    lecture.category = 'Others';
                }
            });

            Object.keys(schedule).forEach(key => {
                if (schedule[key].category === cat) {
                    schedule[key].category = 'Others';
                }
            });

            // ë¶„ë¥˜ ì‚­ì œ
            categories = categories.filter(c => c !== cat);
            delete categoryColors[cat];

            updateCategoryDropdowns();
            updateCategoryList();
            createCategoryFilters();
            updateLectureList();
            updateScheduleDisplay();
            saveAndSync();
        }

        function updateCategoryDropdowns() {
            const sortedCategories = [...categories].sort();
            
            // ê°•ì˜ ì¶”ê°€ í¼ì˜ ë“œë¡­ë‹¤ìš´
            const categorySelect = document.getElementById('category');
            const currentValue = categorySelect.value;
            categorySelect.innerHTML = '<option value="">ì„ íƒí•˜ì„¸ìš”</option>' + 
                sortedCategories.map(cat => `<option value="${cat}">${cat}</option>`).join('');
            if (currentValue && sortedCategories.includes(currentValue)) {
                categorySelect.value = currentValue;
            }

            // ê°•ì˜ ìˆ˜ì • ëª¨ë‹¬ì˜ ë“œë¡­ë‹¤ìš´
            const editCategorySelect = document.getElementById('editCategory');
            if (editCategorySelect) {
                const editCurrentValue = editCategorySelect.value;
                editCategorySelect.innerHTML = sortedCategories.map(cat => `<option value="${cat}">${cat}</option>`).join('');
                if (editCurrentValue && sortedCategories.includes(editCurrentValue)) {
                    editCategorySelect.value = editCurrentValue;
                }
            }
        }

        // ============================================
        // ì„¸ì…˜ ê´€ë¦¬ í•¨ìˆ˜ë“¤ (ì…€ ê¸°ë°˜ ë°©ì‹)
        // ============================================

        function openSessionModal() {
            updateSessionListInModal();
            document.getElementById('sessionModal').classList.add('active');
        }

        function closeSessionModal() {
            document.getElementById('sessionModal').classList.remove('active');
        }
        
        // ì…€ í´ë¦­ì‹œ ì„¸ì…˜ ì¶”ê°€ ëª¨ë‹¬
        function openCellSessionModal(time, room) {
            const existingSession = sessions.find(s => s.time === time && s.room === room);
            
            // ëª¨ë‹¬ ì œëª© ì„¤ì •
            document.getElementById('cellSessionModalTitle').textContent = existingSession ? 'ğŸ“‹ ì„¸ì…˜ ìˆ˜ì •' : 'ğŸ“‹ ì„¸ì…˜ ì¶”ê°€';
            
            // í•„ë“œ ì´ˆê¸°í™”/ì±„ìš°ê¸°
            document.getElementById('cellSessionTime').value = time;
            document.getElementById('cellSessionRoom').value = room;
            document.getElementById('cellSessionId').value = existingSession ? existingSession.id : '';
            document.getElementById('cellSessionName').value = existingSession ? existingSession.name : '';
            document.getElementById('cellSessionNameEn').value = existingSession ? existingSession.nameEn : '';
            document.getElementById('cellSessionModerator').value = existingSession ? existingSession.moderator : '';
            document.getElementById('cellSessionModeratorEn').value = existingSession ? existingSession.moderatorEn : '';
            
            // ìƒ‰ìƒ ì„ íƒ
            const colors = ['#3498DB', '#E74C3C', '#2ECC71', '#9B59B6', '#F39C12', '#1ABC9C', '#E91E63', '#00BCD4'];
            const defaultColor = existingSession ? existingSession.color : colors[sessions.length % colors.length];
            document.getElementById('cellSessionColor').value = defaultColor;
            
            // ìƒ‰ìƒ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
            document.querySelectorAll('#sessionColorPicker .color-btn').forEach(btn => {
                btn.classList.toggle('selected', btn.dataset.color === defaultColor);
            });
            
            // ì¢Œì¥ ì¶”ì²œ ëª©ë¡ ì±„ìš°ê¸° (ì—°ì ëª©ë¡ ê¸°ë°˜)
            const datalist = document.getElementById('moderatorSuggestions');
            datalist.innerHTML = speakers.map(s => `<option value="${s.name}">`).join('');
            
            // ëª¨ë‹¬ ì—´ê¸°
            document.getElementById('cellSessionModal').classList.add('active');
            document.getElementById('cellSessionName').focus();
        }
        
        function closeCellSessionModal() {
            document.getElementById('cellSessionModal').classList.remove('active');
        }
        
        function saveCellSession() {
            const time = document.getElementById('cellSessionTime').value;
            const room = document.getElementById('cellSessionRoom').value;
            const sessionId = document.getElementById('cellSessionId').value;
            const name = document.getElementById('cellSessionName').value.trim();
            const nameEn = document.getElementById('cellSessionNameEn').value.trim();
            const moderator = document.getElementById('cellSessionModerator').value.trim();
            const moderatorEn = document.getElementById('cellSessionModeratorEn').value.trim();
            const color = document.getElementById('cellSessionColor').value;
            
            if (!name) {
                alert('ì„¸ì…˜ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                document.getElementById('cellSessionName').focus();
                return;
            }
            
            // ì¢Œì¥ì´ ì…ë ¥ëœ ê²½ìš° ì—°ì ëª©ë¡ì—ì„œ ì˜ë¬¸ëª… ì°¾ê¸°
            let finalModeratorEn = moderatorEn;
            if (moderator && !moderatorEn) {
                const foundSpeaker = speakers.find(s => s.name === moderator);
                if (foundSpeaker && foundSpeaker.nameEn) {
                    finalModeratorEn = foundSpeaker.nameEn;
                }
            }
            
            saveStateForUndo();
            
            const existingSession = sessionId ? sessions.find(s => s.id == sessionId) : null;
            
            if (existingSession) {
                // ê¸°ì¡´ ì„¸ì…˜ ìˆ˜ì •
                existingSession.name = name;
                existingSession.nameEn = nameEn;
                existingSession.moderator = moderator;
                existingSession.moderatorEn = finalModeratorEn;
                existingSession.color = color;
            } else {
                // ìƒˆ ì„¸ì…˜ ì¶”ê°€
                const newSession = {
                    id: Date.now(),
                    name: name,
                    nameEn: nameEn,
                    moderator: moderator,
                    moderatorEn: finalModeratorEn,
                    time: time,
                    room: room,
                    color: color
                };
                sessions.push(newSession);
            }
            
            saveAndSync();
            updateScheduleDisplay();
            closeCellSessionModal();
        }
        
        // ìƒ‰ìƒ ì„ íƒ ì´ë²¤íŠ¸
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('#sessionColorPicker .color-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('#sessionColorPicker .color-btn').forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                    document.getElementById('cellSessionColor').value = this.dataset.color;
                });
            });
            
            // ì¢Œì¥ ì…ë ¥ ì‹œ ì—°ì ëª©ë¡ì—ì„œ ì˜ë¬¸ëª… ìë™ ì±„ìš°ê¸°
            document.getElementById('cellSessionModerator').addEventListener('change', function() {
                const moderator = this.value.trim();
                const foundSpeaker = speakers.find(s => s.name === moderator);
                if (foundSpeaker && foundSpeaker.nameEn) {
                    document.getElementById('cellSessionModeratorEn').value = foundSpeaker.nameEn;
                }
            });
        });
        
        function editCellSession(time, room) {
            // ì„¸ì…˜ ìˆ˜ì •ì€ ê°™ì€ ëª¨ë‹¬ ì‚¬ìš©
            openCellSessionModal(time, room);
        }
        
        function removeSession(time, room) {
            if (!confirm('ì´ ì„¸ì…˜ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            
            saveStateForUndo();
            sessions = sessions.filter(s => !(s.time === time && s.room === room));
            saveAndSync();
            updateScheduleDisplay();
        }

        function updateSessionListInModal() {
            const list = document.getElementById('sessionList');
            
            if (sessions.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: var(--text-light); padding: 2rem;">ì„¸ì…˜ì´ ì—†ìŠµë‹ˆë‹¤. ì‹œê°„í‘œì—ì„œ "+ ì„¸ì…˜" ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì¶”ê°€í•˜ì„¸ìš”.</p>';
                return;
            }

            // ë£¸ë³„ë¡œ ê·¸ë£¹í™”
            const sessionsByRoom = {};
            rooms.forEach(room => {
                sessionsByRoom[room] = sessions.filter(s => s.room === room);
            });

            let html = '';
            rooms.forEach(room => {
                const roomSessions = sessionsByRoom[room];
                if (roomSessions.length > 0) {
                    html += `<div style="margin-bottom: 1rem;">
                        <h4 style="color: var(--primary); margin-bottom: 0.5rem; padding-bottom: 0.25rem; border-bottom: 2px solid var(--border);">ğŸ“ ${room}</h4>`;
                    
                    roomSessions.forEach(session => {
                        html += `
                            <div class="speaker-item" style="border-left: 4px solid ${session.color}; margin-bottom: 0.5rem;">
                                <div class="speaker-info">
                                    <strong>${session.name}</strong>
                                    <small>ğŸ‘¤ ì¢Œì¥: ${session.moderator || 'ë¯¸ì •'} | ğŸ• ${session.time}</small>
                                </div>
                                <div class="speaker-actions">
                                    <button class="btn btn-secondary btn-small" onclick="editCellSession('${session.time}', '${session.room}'); updateSessionListInModal();">ìˆ˜ì •</button>
                                    <button class="btn btn-secondary btn-small" onclick="removeSession('${session.time}', '${session.room}'); updateSessionListInModal();">ì‚­ì œ</button>
                                </div>
                            </div>
                        `;
                    });
                    
                    html += '</div>';
                }
            });

            list.innerHTML = html;
        }

        // ============================================
        // ì–¸ì–´ ì „í™˜ í•¨ìˆ˜
        // ============================================
        
        function setLanguage(lang) {
            currentLanguage = lang;
            
            // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
            const koBtn = document.getElementById('langKoBtn');
            const enBtn = document.getElementById('langEnBtn');
            
            if (lang === 'ko') {
                koBtn.style.background = 'var(--accent)';
                koBtn.style.color = 'white';
                enBtn.style.background = 'rgba(255,255,255,0.2)';
                enBtn.style.color = 'white';
            } else {
                enBtn.style.background = 'var(--accent)';
                enBtn.style.color = 'white';
                koBtn.style.background = 'rgba(255,255,255,0.2)';
                koBtn.style.color = 'white';
            }
            
            // ì‹œê°„í‘œ ì—…ë°ì´íŠ¸
            updateScheduleDisplay();
            
            console.log(`ì–¸ì–´ ë³€ê²½: ${lang === 'ko' ? 'í•œê¸€' : 'English'}`);
        }
        
        // ============================================
        // ì¹´ë“œ ì ‘ê¸°/í¼ì¹˜ê¸°
        // ============================================
        
        function toggleCard(cardId) {
            const card = document.getElementById(cardId);
            if (card) {
                card.classList.toggle('collapsed');
                // ìƒíƒœ ì €ì¥
                const collapsed = card.classList.contains('collapsed');
                localStorage.setItem(`card_${cardId}_collapsed`, collapsed);
            }
        }
        
        function loadCardStates() {
            ['addLectureCard', 'lectureListCard'].forEach(cardId => {
                const collapsed = localStorage.getItem(`card_${cardId}_collapsed`) === 'true';
                const card = document.getElementById(cardId);
                if (card && collapsed) {
                    card.classList.add('collapsed');
                }
            });
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ë° ì´ˆê¸°í™”
        loadFromLocalStorage();
        loadRoomsFromStorage();
        loadCardStates();
        updateCategoryDropdowns();
        createCategoryFilters();
        createScheduleTable();
        updateLectureList();
        console.log('ì´ˆê¸°í™” ì™„ë£Œ - ë°ì´í„° ë¶ˆëŸ¬ì˜´');

        window.onclick = function(event) {
            if (event.target.className === 'modal active') {
                event.target.classList.remove('active');
            }
        }
    </script>
</body>
</html>
